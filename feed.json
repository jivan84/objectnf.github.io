{"version":"https://jsonfeed.org/version/1","name":"ObjectNotFound 博客 | 主站","home_page_url":"https://www.zhouweitong.site","feed_url":"https://www.zhouweitong.site/feed.json","author":{"name":"ObjectNotFound"},"items":[{"id":"https://www.zhouweitong.site/post/007-linux-windows-tricks-03/","url":"https://www.zhouweitong.site/post/007-linux-windows-tricks-03/","title":"Linux & Windows 小技巧（3）","content_html":"<link rel=\"stylesheet\" type=\"text&#x2F;css\" href=\"https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.5.1/katex.min.css\"><link rel=\"stylesheet\" type=\"text&#x2F;css\" href=\"https://cdn.jsdelivr.net/npm/hexo-tag-hint@0.3.1/dist/hexo-tag-hint.min.css\"><p>图源：Miv4t - 《MACHiNERY》，Pid：<a href=\"https://www.pixiv.net/artworks/77186528\">77186528</a></p>\n<h2 id=\"Windows- 下的 -cat- 和 -grep\"><a href=\"#Windows- 下的 -cat- 和 -grep\" class=\"headerlink\" title=\"Windows 下的 cat 和 grep\"></a>Windows 下的 cat 和 grep</h2><p><code>ls</code>、<code>cat</code>、<code>grep</code>这三个命令，往往是 Linux 初学者最先了解的、日常使用 Linux 时不可或缺的。对于 Windows 系统而言，同样有三个命令可以完成上述工作：<code>dir</code>、<code>type</code>与<code>findstr</code>。</p>\n<p>例如，用 <code>type</code> 显示文件内容：</p>\n<p><img src=\"/post/007-linux-windows-tricks-03/image-20210413151134589.png\" alt=\"image-20210413151134589\"></p>\n<p>或者用 <code>findstr</code> 结合管道匹配先前程序输出内容中的字符串：</p>\n<p><img src=\"/post/007-linux-windows-tricks-03/image-20210413151152079.png\" alt=\"image-20210413151152079\"></p>\n<p>也可以结合正则表达式：</p>\n<p><img src=\"/post/007-linux-windows-tricks-03/image-20210413151207393.png\" alt=\"image-20210413151207393\"></p>\n<p>如果你不满足于系统命令的显示效果，你也可以尝试下面两款开源于 Github 的工具：</p>\n<h3 id=\"peco\"><a href=\"#peco\" class=\"headerlink\" title=\"peco\"></a>peco</h3><p>项目链接：<a href=\"https://github.com/peco/peco\">https://github.com/peco/peco</a></p>\n<p><code>peco</code>可以实现对管道输入的文本进行快速搜索、排序、多行选择等功能，使用 Golang 编写。目前仍不支持中文编码（GBK），且不支持默认的 Windows PowerShell 终端（你需要使用传统的命令提示符，或者更先进的终端程序，比如 Hyper 或者 Windows Terminal）。该项目仍在活跃开发中，合理的使用可以提升效率。</p>\n<p><img src=\"/post/007-linux-windows-tricks-03/image-20210413151244160.png\" alt=\"image-20210413151244160\"></p>\n<span id=\"more\"></span>\n\n<h3 id=\"bat\"><a href=\"#bat\" class=\"headerlink\" title=\"bat\"></a>bat</h3><p>项目链接：<a href=\"https://github.com/sharkdp/bat\">https://github.com/sharkdp/bat</a></p>\n<p><code>bat</code>是一款替代 <code>cat</code>/<code>type</code> 的工具，使用 Golang 编写。加入了代码高亮、Git 增删标识、不可打印字符显示等功能。</p>\n<p><img src=\"/post/007-linux-windows-tricks-03/image-20210413151302358.png\" alt=\"image-20210413151302358\"></p>\n<p>使用参数 <code>-A</code> 可以显示所有不可打印字符：</p>\n<p><img src=\"/post/007-linux-windows-tricks-03/image-20210413151355738.png\" alt=\"image-20210413151355738\"></p>\n<h2 id=\"软链接、硬链接\"><a href=\"# 软链接、硬链接\" class=\"headerlink\" title=\"软链接、硬链接\"></a>软链接、硬链接 </h2><h3 id=\"使用命令行\"><a href=\"# 使用命令行\" class=\"headerlink\" title=\"使用命令行\"></a> 使用命令行 </h3><p> 在 Linux 下，软链接（即符号链接）和硬链接的使用是非常普遍的。我们经常需要使用 <code>ln</code> 命令来创建它们。</p>\n<p>创建硬链接的命令是：</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ln [Target] [Link name]</span><br></pre></td></tr></table></figure>\n\n<p>创建软链接，只需要再加上参数 <code>-s</code> 即可。既然是“链接”，那么说明对链接指向的文件进行修改实际上就是对源文件本身进行修改。</p>\n<p>硬链接与源文件必须处于同一文件系统内，且源文件必须真实存在。且硬链接的源文件必须是单一文件，不能是目录，因为这样会造成硬链接包含地狱（Hard Link Inclusion Hell）。软链接的源文件则可以是文件，也可以是目录，且无需实际存在。源文件不存在的软链接成为死链接。软链接具有自己的权限与文件属性。软链接可以跨文件系统链接。删除硬链接和软链接均不会对源文件产生影响。</p>\n<p>Windows 下使用率最高的 NTFS 文件系统中也有类似的概念，且 Windows 中也提供了对应的创建链接的命令。</p>\n<p>创建软链接的命令是：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">mklink [Link] [Target]</span><br></pre></td></tr></table></figure>\n\n<p>这个命令 Windows PowerShell 中是没有的，因此依然需要使用传统的命令提示符。同时注意，Link 和 Target 的顺序与 *nix 下的 <code>ln</code> 是相反的（这也导致我总是记错）。如果创建硬链接，加参数 <code>/H</code> 即可。</p>\n<p>同时要注意，对于目录的软链接与符号链接有稍许不同。目录符号连接与 Linux 下的目录软链接基本等同，具有独立的文件属性，在移动时仍保持相对或绝对路径的链接关系，在复制时创建源文件的副本（同 Linux 下使用 <code>cp</code> 直接复制软链接。Linux 下的 <code>cp -d</code> 可以将软链接复制为软链接，而不是将软链接复制为文件）。而 Win 下的目录软链接在移动时，会在目标位置创建同名文件夹，并把源目录内的所有文件移动至新的目录。</p>\n<p>创建目录符号链接的命令：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">mklink /D [Link] [Target Dir]</span><br></pre></td></tr></table></figure>\n\n<p>创建目录软链接的命令：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">mklink /J [Link] [Target Dir]</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"使用 -LinkShellExtension\"><a href=\"# 使用 -LinkShellExtension\" class=\"headerlink\" title=\"使用 LinkShellExtension\"></a>使用 LinkShellExtension</h3><p>当然，如果不习惯使用命令行操作，也可以使用第三方工具创建各种类型的软链接和硬链接。</p>\n<p>到官网（ <a href=\"https://schinagl.priv.at/nt/hardlinkshellext/linkshellextension.html\">https://schinagl.priv.at/nt/hardlinkshellext/linkshellextension.html</a> ）下载 Link Shell Extension 并安装（注：需要 Visual C++ 2015 Redistributable 运行库，可以到这里（ <a href=\"https://aka.ms/vs/15/release/vc_redist.x64.exe\">https://aka.ms/vs/15/release/vc_redist.x64.exe</a> ）安装。</p>\n<p>随后选择需要创建链接的文件 / 文件夹，右键，单击“选择源连接点”。</p>\n<p><img src=\"/post/007-linux-windows-tricks-03/Snipaste_2021-08-09_15-43-19.png\"></p>\n<p>再到目标文件夹右键，从右键菜单中选择需要创建的链接类型就可以了。</p>\n<p><img src=\"/post/007-linux-windows-tricks-03/Snipaste_2021-08-09_15-50-08.png\"></p>\n<h2 id=\"rm- 删除除指定文件外的其他文件\"><a href=\"#rm- 删除除指定文件外的其他文件\" class=\"headerlink\" title=\"rm 删除除指定文件外的其他文件\"></a>rm 删除除指定文件外的其他文件</h2><p>Linux 下，删除一个文件 / 文件夹，或删除该文件夹下所有文件等操作都很简单。但如果想保留文件夹下某一个或某几个文件，同时删除其他文件，该如何操作？</p>\n<p>可以结合 <code>ls</code>、<code>grep</code> 和<code>xargs</code>：</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ls | grep -vE &lt;FileName&gt; | xargs rm -rf</span><br></pre></td></tr></table></figure>\n\n<p>这是最传统的方式。你也可以使用一种 bash 功能，无需借助 xargs 即可完成这一目的。</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 开启需要的 shell option</span></span><br><span class=\"line\"><span class=\"built_in\">shopt</span> -s extglob</span><br><span class=\"line\"><span class=\"comment\"># 然后运行！</span></span><br><span class=\"line\">rm -rf !(&lt;FileName&gt;)</span><br></pre></td></tr></table></figure>\n\n<p><code>shopt</code>是 bash 的内置命令，控制 bash 的多种可选功能的开启和关闭。bash 版本不同，其可选功能也可能不同。</p>\n<p>最常用的命令就是：</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 显示所有支持的可选功能及其状态</span></span><br><span class=\"line\"><span class=\"built_in\">shopt</span></span><br><span class=\"line\"><span class=\"comment\"># 开启某个功能</span></span><br><span class=\"line\"><span class=\"built_in\">shopt</span> -s &lt;<span class=\"keyword\">function</span>&gt;</span><br><span class=\"line\"><span class=\"comment\"># 关闭某个功能</span></span><br><span class=\"line\"><span class=\"built_in\">shopt</span> -u &lt;<span class=\"keyword\">function</span>&gt;</span><br></pre></td></tr></table></figure>\n\n<p>至于每个功能的具体作用，可参见 <a href=\"https://www.gnu.org/software/bash/manual/html_node/The-Shopt-Builtin.html\">The Shopt Builtin (Bash Reference Manual)</a> 或<a href=\"https://www.computerhope.com/unix/bash/shopt.htm\">Bash shopt builtin command help and examples</a>。</p>\n<p>以下给出几个较为实用的例子：</p>\n<h3 id=\"autocd\"><a href=\"#autocd\" class=\"headerlink\" title=\"autocd\"></a>autocd</h3><p>启用时，bash 中直接输入文件夹名的效果等同于执行“cd 文件夹名”。</p>\n<p><img src=\"/post/007-linux-windows-tricks-03/image-20220112165044481.png\" alt=\"image-20220112165044481\"></p>\n<h3 id=\"hostcomplete\"><a href=\"#hostcomplete\" class=\"headerlink\" title=\"hostcomplete\"></a>hostcomplete</h3><p>启用时，在 bash 中输入“@”后，按 Tab 键可补全已知的主机名。</p>\n<p><img src=\"/post/007-linux-windows-tricks-03/image-20220112171033252.png\" alt=\"image-20220112171033252\"></p>\n<h3 id=\"cdspell\"><a href=\"#cdspell\" class=\"headerlink\" title=\"cdspell\"></a>cdspell</h3><p>启用时，在 bash 中使用 cd 命令，目录名称内字符的错位、字符的缺失（限 1 个字符）和字符的误加可被自动修正。</p>\n<p><img src=\"/post/007-linux-windows-tricks-03/image-20220112175912347.png\" alt=\"image-20220112175912347\"></p>\n<h3 id=\"restricted-shell\"><a href=\"#restricted-shell\" class=\"headerlink\" title=\"restricted_shell\"></a>restricted_shell</h3><p>进入 bash 的限制模式。限制模式下无法使用 cd 命令切换目录、无法修改 PATH 等变量等。具体的限制可参阅<a href=\"https://www.gnu.org/software/bash/manual/html_node/The-Restricted-Shell.html\">The Restricted Shell (Bash Reference Manual)</a>。</p>\n<p>这种模式不推荐使用 shopt 进入。推荐的进入方式是直接运行：</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">rbash</span><br></pre></td></tr></table></figure>\n\n<p><img src=\"/post/007-linux-windows-tricks-03/image-20220112202106796.png\" alt=\"image-20220112202106796\"></p>\n<h2 id=\"Windows- 展台模式\"><a href=\"#Windows- 展台模式\" class=\"headerlink\" title=\"Windows 展台模式\"></a>Windows 展台模式</h2><p>Windows 10 与 Windows 11 的“展台模式”旨在解决公用电脑存在的痛点。举几个场景的例子：</p>\n<ul>\n<li>运营一个城市 / 学校的图书馆。图书馆需要一些公用电脑，供入馆人员查阅图书位置、查询借还情况、显示图书馆的近期公告等。</li>\n<li>运营 Windows 系统电脑体验店 / 专柜。需要在展台上放置屏幕，循环播放设备和品牌的介绍视频 / 交互式 APP 等。</li>\n<li>设置中央大屏。例如工地的考勤状态大屏、信息中心的告警状态大屏、学校的风采展示大屏等等。</li>\n</ul>\n<p>这些情况下，Windows 展台模式可以很好的兼顾安全性和维护的便捷性。</p>\n<p>Windows 展台模式具有以下特性：</p>\n<ul>\n<li><strong>专有用户</strong>，可以设置为开机自动登录。</li>\n<li>无 Explorer 环境，<strong>自动运行且只能运行 </strong> 设定好的“展台程序”。</li>\n<li><strong>会话超时机制</strong>，一段时间无动作即会恢复初始状态。</li>\n<li><strong>严格的权限管理</strong>，结合展台应用的应用内限制和读写过滤器，可有效禁止文件修改、第三方程序执行、系统信息获取等可能造成安全风险的行为。</li>\n</ul>\n<p>但也要注意，展台应用只能是 <strong>UWP 应用</strong> 或<strong>Microsoft Edge 浏览器</strong>。</p>\n<p>下面简单描述 Windows 展台模式的设置方式。系统版本：Windows 10 Enterprise LTSC 2021, Build 19044.1415。</p>\n<blockquote>\n<p>注意：最好使用全新安装的、只带有基本驱动程序（例如：安装 Intel 核心显卡驱动但不安装 Intel 核心显卡控制面板）和非系统级应用（例如：不安装杀毒软件、虚拟化软件等）的 Windows 系统。</p>\n</blockquote>\n<h3 id=\"（编外：如何给 LTSC 安装 Microsoft-Store？）\"><a href=\"#（编外：如何给 LTSC 安装 Microsoft-Store？）\" class=\"headerlink\" title=\"（编外：如何给 LTSC 安装 Microsoft Store？）\"></a>（编外：如何给 LTSC 安装 Microsoft Store？）</h3><p>到 <a href=\"https://github.com/kkkgo/LTSC-Add-MicrosoftStore/releases\">Releases · kkkgo/LTSC-Add-MicrosoftStore</a> 下载所需的文件，解压。</p>\n<p>右键以管理员权限运行其中的 <code>Add-Store.cmd</code>。如果之前已经安装过更新版本的<code>Microsoft.VCLibs</code> 包，则可能会出现错误提示，忽略即可。</p>\n<p><img src=\"/post/007-linux-windows-tricks-03/image-20220108190907038.png\" alt=\"image-20220108190907038\"></p>\n<p>随后即可在开始菜单中看到 Microsoft Store：</p>\n<p><img src=\"/post/007-linux-windows-tricks-03/image-20220108195546502.png\" alt=\"image-20220108195546502\"></p>\n<p>打开 Microsoft Store 获取更新，即可更新至新版 Microsoft Store。</p>\n<p><img src=\"/post/007-linux-windows-tricks-03/image-20220108201938868.png\" alt=\"image-20220108201938868\"></p>\n<p><img src=\"/post/007-linux-windows-tricks-03/image-20220108201951140.png\" alt=\"image-20220108201951140\"></p>\n<h3 id=\"设置本地用户\"><a href=\"# 设置本地用户\" class=\"headerlink\" title=\"设置本地用户\"></a>设置本地用户 </h3><p> 系统设置 App -&gt; 账户 -&gt; 家庭和其他用户 -&gt; “将其他人添加到这台电脑”</p>\n<p><img src=\"/post/007-linux-windows-tricks-03/image-20220108202208558.png\" alt=\"image-20220108202208558\"></p>\n<p>“我没有这个人的登录信息” -&gt; “添加一个没有 Microsoft 账户的用户” -&gt; 输入用户名，可以不设置密码。用户名此处以“Kiosk”为例。 -&gt; “下一步”</p>\n<p><img src=\"/post/007-linux-windows-tricks-03/image-20220108203205623.png\" alt=\"image-20220108203205623\"></p>\n<h3 id=\"登录本地用户\"><a href=\"# 登录本地用户\" class=\"headerlink\" title=\"登录本地用户\"></a>登录本地用户 </h3><p> 添加完本地用户后，<strong>需要登录一次 </strong> 以进行用户文件的初始化。</p>\n<p><img src=\"/post/007-linux-windows-tricks-03/image-20220108205432209.png\" alt=\"image-20220108205432209\"></p>\n<p>此时确认展台应用（UWP 应用或者 Microsoft Edge）是否出现在了开始菜单中。若应用有初始化过程，则至少启动应用一次。</p>\n<p>之后打开系统设置 App -&gt; 账户 -&gt; 登录选项，取消勾选“更新或重启后，使用我的登录信息自动完成设备设置”。</p>\n<p><img src=\"/post/007-linux-windows-tricks-03/image-20220108205809282.png\" alt=\"image-20220108205809282\"></p>\n<p>设置完毕后，<strong>注销 </strong> 这个本地用户，回到之前的管理员用户继续设置。</p>\n<h3 id=\"设置展台应用\"><a href=\"# 设置展台应用\" class=\"headerlink\" title=\"设置展台应用\"></a>设置展台应用 </h3><p> 系统设置 App -&gt; 账户 -&gt; 家庭和其他用户 -&gt; 分配的访问权限 -&gt; “开始”。</p>\n<p><img src=\"/post/007-linux-windows-tricks-03/image-20220108210453537.png\" alt=\"image-20220108210453537\"></p>\n<p>随后点击“选择现有账户” -&gt; Kiosk -&gt; “下一页”。</p>\n<p><img src=\"/post/007-linux-windows-tricks-03/image-20220108211344880.png\" alt=\"image-20220108211344880\"></p>\n<p>选择展台应用。此处以“Microsoft Edge”为例。</p>\n<p><img src=\"/post/007-linux-windows-tricks-03/image-20220108211540726.png\" alt=\"image-20220108211540726\"></p>\n<p>针对不同的 App 会显示不同的设置选项。此处以针对浏览器的选项“作为公共浏览器”为例。</p>\n<p><img src=\"/post/007-linux-windows-tricks-03/image-20220108211749713.png\" alt=\"image-20220108211749713\"></p>\n<p>设置 Microsoft Edge 的默认主页和会话超时时间。会话超时后会强制重启 Microsoft Edge，同时删除一切浏览数据。</p>\n<p><img src=\"/post/007-linux-windows-tricks-03/image-20220108211949641.png\" alt=\"image-20220108211949641\"></p>\n<p>至此，展台模式已设置完毕。在系统设置 App 中可查看和修改详情。建议取消勾选“当设备崩溃时，不显示错误，并自动重启”选项，避免循环重启。</p>\n<p><img src=\"/post/007-linux-windows-tricks-03/image-20220108212224068.png\" alt=\"image-20220108212224068\"></p>\n<p>重新启动 Windows，登录时选择 Kiosk 用户即可进入展台模式。</p>\n<h3 id=\"补充\"><a href=\"# 补充\" class=\"headerlink\" title=\"补充\"></a>补充</h3><ul>\n<li>可以使用 <code>netplwiz</code> 等将展台模式用户设置为自动登录。</li>\n<li>默认状态下，展台模式的 Microsoft Edge 右键菜单是受限的。网页内是无法使用右键菜单的，但标签栏可以。Ctrl+C/V 的复制快捷键也是不可用的。但部分网页可以触发折叠菜单，此时可以正常复制。</li>\n</ul>\n<p><img src=\"/post/007-linux-windows-tricks-03/image-20220108214127897.png\" alt=\"image-20220108214127897\"></p>\n<ul>\n<li>默认状态下，展台模式的 Microsoft Edge 功能是受限的，收藏夹、浏览器设置、开发者工具等都是无法访问的。</li>\n</ul>\n<p><img src=\"/post/007-linux-windows-tricks-03/image-20220108214516651.png\" alt=\"image-20220108214516651\"></p>\n<ul>\n<li>默认状态下，展台模式的 Microsoft Edge 的下载功能和打印功能是可用的，但文件只允许保存至展台用户的 Downloads 文件夹下。</li>\n</ul>\n<p><img src=\"/post/007-linux-windows-tricks-03/image-20220108215333563.png\" alt=\"image-20220108215333563\"></p>\n<ul>\n<li>默认状态下，展台模式的 Microsoft Edge 的 <code>file://</code> 协议未被禁止。通过它可以获得完整的文件目录，及读取低权限用户可以读取的部分文件，但无法下载及做出任何修改。</li>\n</ul>\n<p><img src=\"/post/007-linux-windows-tricks-03/image-20220108215541835.png\" alt=\"image-20220108215541835\"></p>\n<ul>\n<li>点击右上角的“结束会话”，可立即重启 Microsoft Edge 并删除浏览数据。Downloads 文件夹下的文件也会一并删除。</li>\n</ul>\n<p><img src=\"/post/007-linux-windows-tricks-03/image-20220108220022974.png\" alt=\"image-20220108220022974\"></p>\n<ul>\n<li>默认状态下，展台模式的 Microsoft Edge 只有一个窗口。</li>\n<li>更新展台应用时，必须先注销展台用户。注销方法：Ctrl + Alt + Delete 唤起用户切换界面 - 登录管理员用户 - 启动任务管理器 - 用户选项卡 - 注销</li>\n</ul>\n<p><img src=\"/post/007-linux-windows-tricks-03/image-20220108220959607.png\" alt=\"image-20220108220959607\"></p>\n<h3 id=\"（编外：启用写入筛选）\"><a href=\"#（编外：启用写入筛选）\" class=\"headerlink\" title=\"（编外：启用写入筛选）\"></a>（编外：启用写入筛选）</h3><p>写入筛选功能类似数十年前比较流行的“还原卡”的功能：截获驱动器 (应用安装、设置更改、保存的数据) 的写入操作并重定向到虚拟覆盖区。虚拟覆盖区在重新启动等时刻清除，达到“不可对驱动器的文件进行修改”的目的。如果对展台模式的安全性仍有疑虑，可以一并启用写入筛选器提升安全性。</p>\n<h4 id=\"启用功能\"><a href=\"# 启用功能\" class=\"headerlink\" title=\"启用功能\"></a>启用功能 </h4><p> 写入筛选器功能仅在 Windows Enterprise 系列系统（企业版、IoT 企业版、企业版 LTSC 等）中提供。</p>\n<p>控制面板 - 程序 - 启用或关闭 Windows 功能 - 勾选“设备锁定 - 统一写入筛选器”。</p>\n<p><img src=\"/post/007-linux-windows-tricks-03/image-20220108223855192.png\" alt=\"image-20220108223855192\"></p>\n<h4 id=\"运行和设置\"><a href=\"# 运行和设置\" class=\"headerlink\" title=\"运行和设置\"></a>运行和设置 </h4><p> 统一写入筛选器是 CLI 程序，命令为：</p>\n<figure class=\"highlight powershell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">uwfmgr</span><br></pre></td></tr></table></figure>\n\n<p>常用命令举例<sup id=\"fnref:1\"><a href=\"#fn:1\" rel=\"footnote\">1</a></sup>：</p>\n<figure class=\"highlight powershell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 显示当前系统配置</span></span><br><span class=\"line\">uwfmgr <span class=\"built_in\">get-config</span></span><br><span class=\"line\"><span class=\"comment\"># 启用写入筛选，重新启动后生效</span></span><br><span class=\"line\">uwfmgr <span class=\"keyword\">filter</span> enable</span><br><span class=\"line\"><span class=\"comment\"># 设置用于虚拟覆盖区的 RAM 大小，单位为 MB</span></span><br><span class=\"line\">uwfmgr overlay <span class=\"built_in\">set-size</span> <span class=\"number\">1024</span></span><br><span class=\"line\"><span class=\"comment\"># 小内存机器可以利用磁盘空闲空间作为虚拟覆盖区</span></span><br><span class=\"line\">uwfmgr overlay <span class=\"built_in\">set-passthrough</span> on</span><br><span class=\"line\"><span class=\"comment\"># 设置启用保护的分区</span></span><br><span class=\"line\">uwfmgr volume protect C:</span><br><span class=\"line\"><span class=\"comment\"># 设置排除的目录，全盘保护则不设置</span></span><br><span class=\"line\"><span class=\"comment\"># 同时建议禁用回收站</span></span><br><span class=\"line\">uwfmgr file <span class=\"built_in\">add-exclusion</span> C:\\Users</span><br><span class=\"line\"><span class=\"comment\"># 服务模式，允许安装系统更新，可选项</span></span><br><span class=\"line\">uwfmgr servicing <span class=\"built_in\">update-Windows</span></span><br></pre></td></tr></table></figure>\n\n<p>设置完成后重新启动系统即可看到效果。</p>\n<p><img src=\"/post/007-linux-windows-tricks-03/image-20220108234803766.png\" alt=\"image-20220108234803766\"></p>\n<p>关闭统一写入筛选器，使用如下命令即可：</p>\n<figure class=\"highlight powershell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">uwfmgr <span class=\"keyword\">filter</span> disable</span><br><span class=\"line\">uwfmgr volume unprotect C:</span><br></pre></td></tr></table></figure>\n\n<p><img src=\"/post/007-linux-windows-tricks-03/image-20220108235041382.png\" alt=\"image-20220108235041382\"></p>\n<div id=\"footnotes\"><hr><div id=\"footnotelist\"><ol style=\"list-style:none; padding-left: 0;\"><li id=\"fn:1\"><span style=\"display: inline-block; vertical-align: top; padding-right: 10px;\">1.</span><span style=\"display: inline-block; vertical-align: top;\">参阅官方文档<a href=\"https://docs.microsoft.com/en-us/windows-hardware/customize/enterprise/unified-write-filter\">Unified Write Filter (UWF) feature (unified-write-filter) | Microsoft Docs</a></span><a href=\"#fnref:1\" rev=\"footnote\"> ↩</a></li></ol></div></div>","content_text":"图源：Miv4t - 《MACHiNERY》，Pid：77186528 Windows 下的 cat 和 grepls、cat、grep这三个命令，往往是 Linux 初学者最先了解的、日常使用 Linux 时不可或缺的。对于 Windows 系统而言，同样有三个命令可以完成上述工作：dir、type与findstr。 例如，用 type 显示文件内容： 或者用 findstr 结合管道匹配先前程序输出内容中的字符串： 也可以结合正则表达式： 如果你不满足于系统命令的显示效果，你也可以尝试下面两款开源于 Github 的工具： peco项目链接：https://github.com/peco/peco peco可以实现对管道输入的文本进行快速搜索、排序、多行选择等功能，使用 Golang 编写。目前仍不支持中文编码（GBK），且不支持默认的 Windows PowerShell 终端（你需要使用传统的命令提示符，或者更先进的终端程序，比如 Hyper 或者 Windows Terminal）。该项目仍在活跃开发中，合理的使用可以提升效率。 bat项目链接：https://github.com/sharkdp/bat bat是一款替代 cat/type 的工具，使用 Golang 编写。加入了代码高亮、Git 增删标识、不可打印字符显示等功能。 使用参数 -A 可以显示所有不可打印字符： 软链接、硬链接 使用命令行 在 Linux 下，软链接（即符号链接）和硬链接的使用是非常普遍的。我们经常需要使用 ln 命令来创建它们。 创建硬链接的命令是： 1ln [Target] [Link name] 创建软链接，只需要再加上参数 -s 即可。既然是“链接”，那么说明对链接指向的文件进行修改实际上就是对源文件本身进行修改。 硬链接与源文件必须处于同一文件系统内，且源文件必须真实存在。且硬链接的源文件必须是单一文件，不能是目录，因为这样会造成硬链接包含地狱（Hard Link Inclusion Hell）。软链接的源文件则可以是文件，也可以是目录，且无需实际存在。源文件不存在的软链接成为死链接。软链接具有自己的权限与文件属性。软链接可以跨文件系统链接。删除硬链接和软链接均不会对源文件产生影响。 Windows 下使用率最高的 NTFS 文件系统中也有类似的概念，且 Windows 中也提供了对应的创建链接的命令。 创建软链接的命令是： 1mklink [Link] [Target] 这个命令 Windows PowerShell 中是没有的，因此依然需要使用传统的命令提示符。同时注意，Link 和 Target 的顺序与 *nix 下的 ln 是相反的（这也导致我总是记错）。如果创建硬链接，加参数 /H 即可。 同时要注意，对于目录的软链接与符号链接有稍许不同。目录符号连接与 Linux 下的目录软链接基本等同，具有独立的文件属性，在移动时仍保持相对或绝对路径的链接关系，在复制时创建源文件的副本（同 Linux 下使用 cp 直接复制软链接。Linux 下的 cp -d 可以将软链接复制为软链接，而不是将软链接复制为文件）。而 Win 下的目录软链接在移动时，会在目标位置创建同名文件夹，并把源目录内的所有文件移动至新的目录。 创建目录符号链接的命令： 1mklink /D [Link] [Target Dir] 创建目录软链接的命令： 1mklink /J [Link] [Target Dir] 使用 LinkShellExtension当然，如果不习惯使用命令行操作，也可以使用第三方工具创建各种类型的软链接和硬链接。 到官网（ https://schinagl.priv.at/nt/hardlinkshellext/linkshellextension.html ）下载 Link Shell Extension 并安装（注：需要 Visual C++ 2015 Redistributable 运行库，可以到这里（ https://aka.ms/vs/15/release/vc_redist.x64.exe ）安装。 随后选择需要创建链接的文件 / 文件夹，右键，单击“选择源连接点”。 再到目标文件夹右键，从右键菜单中选择需要创建的链接类型就可以了。 rm 删除除指定文件外的其他文件Linux 下，删除一个文件 / 文件夹，或删除该文件夹下所有文件等操作都很简单。但如果想保留文件夹下某一个或某几个文件，同时删除其他文件，该如何操作？ 可以结合 ls、grep 和xargs： 1ls | grep -vE &lt;FileName&gt; | xargs rm -rf 这是最传统的方式。你也可以使用一种 bash 功能，无需借助 xargs 即可完成这一目的。 1234# 开启需要的 shell optionshopt -s extglob# 然后运行！rm -rf !(&lt;FileName&gt;) shopt是 bash 的内置命令，控制 bash 的多种可选功能的开启和关闭。bash 版本不同，其可选功能也可能不同。 最常用的命令就是： 123456# 显示所有支持的可选功能及其状态shopt# 开启某个功能shopt -s &lt;function&gt;# 关闭某个功能shopt -u &lt;function&gt; 至于每个功能的具体作用，可参见 The Shopt Builtin (Bash Reference Manual) 或Bash shopt builtin command help and examples。 以下给出几个较为实用的例子： autocd启用时，bash 中直接输入文件夹名的效果等同于执行“cd 文件夹名”。 hostcomplete启用时，在 bash 中输入“@”后，按 Tab 键可补全已知的主机名。 cdspell启用时，在 bash 中使用 cd 命令，目录名称内字符的错位、字符的缺失（限 1 个字符）和字符的误加可被自动修正。 restricted_shell进入 bash 的限制模式。限制模式下无法使用 cd 命令切换目录、无法修改 PATH 等变量等。具体的限制可参阅The Restricted Shell (Bash Reference Manual)。 这种模式不推荐使用 shopt 进入。推荐的进入方式是直接运行： 1rbash Windows 展台模式Windows 10 与 Windows 11 的“展台模式”旨在解决公用电脑存在的痛点。举几个场景的例子： 运营一个城市 / 学校的图书馆。图书馆需要一些公用电脑，供入馆人员查阅图书位置、查询借还情况、显示图书馆的近期公告等。 运营 Windows 系统电脑体验店 / 专柜。需要在展台上放置屏幕，循环播放设备和品牌的介绍视频 / 交互式 APP 等。 设置中央大屏。例如工地的考勤状态大屏、信息中心的告警状态大屏、学校的风采展示大屏等等。 这些情况下，Windows 展台模式可以很好的兼顾安全性和维护的便捷性。 Windows 展台模式具有以下特性： 专有用户，可以设置为开机自动登录。 无 Explorer 环境，自动运行且只能运行 设定好的“展台程序”。 会话超时机制，一段时间无动作即会恢复初始状态。 严格的权限管理，结合展台应用的应用内限制和读写过滤器，可有效禁止文件修改、第三方程序执行、系统信息获取等可能造成安全风险的行为。 但也要注意，展台应用只能是 UWP 应用 或Microsoft Edge 浏览器。 下面简单描述 Windows 展台模式的设置方式。系统版本：Windows 10 Enterprise LTSC 2021, Build 19044.1415。 注意：最好使用全新安装的、只带有基本驱动程序（例如：安装 Intel 核心显卡驱动但不安装 Intel 核心显卡控制面板）和非系统级应用（例如：不安装杀毒软件、虚拟化软件等）的 Windows 系统。 （编外：如何给 LTSC 安装 Microsoft Store？）到 Releases · kkkgo/LTSC-Add-MicrosoftStore 下载所需的文件，解压。 右键以管理员权限运行其中的 Add-Store.cmd。如果之前已经安装过更新版本的Microsoft.VCLibs 包，则可能会出现错误提示，忽略即可。 随后即可在开始菜单中看到 Microsoft Store： 打开 Microsoft Store 获取更新，即可更新至新版 Microsoft Store。 设置本地用户 系统设置 App -&gt; 账户 -&gt; 家庭和其他用户 -&gt; “将其他人添加到这台电脑” “我没有这个人的登录信息” -&gt; “添加一个没有 Microsoft 账户的用户” -&gt; 输入用户名，可以不设置密码。用户名此处以“Kiosk”为例。 -&gt; “下一步” 登录本地用户 添加完本地用户后，需要登录一次 以进行用户文件的初始化。 此时确认展台应用（UWP 应用或者 Microsoft Edge）是否出现在了开始菜单中。若应用有初始化过程，则至少启动应用一次。 之后打开系统设置 App -&gt; 账户 -&gt; 登录选项，取消勾选“更新或重启后，使用我的登录信息自动完成设备设置”。 设置完毕后，注销 这个本地用户，回到之前的管理员用户继续设置。 设置展台应用 系统设置 App -&gt; 账户 -&gt; 家庭和其他用户 -&gt; 分配的访问权限 -&gt; “开始”。 随后点击“选择现有账户” -&gt; Kiosk -&gt; “下一页”。 选择展台应用。此处以“Microsoft Edge”为例。 针对不同的 App 会显示不同的设置选项。此处以针对浏览器的选项“作为公共浏览器”为例。 设置 Microsoft Edge 的默认主页和会话超时时间。会话超时后会强制重启 Microsoft Edge，同时删除一切浏览数据。 至此，展台模式已设置完毕。在系统设置 App 中可查看和修改详情。建议取消勾选“当设备崩溃时，不显示错误，并自动重启”选项，避免循环重启。 重新启动 Windows，登录时选择 Kiosk 用户即可进入展台模式。 补充 可以使用 netplwiz 等将展台模式用户设置为自动登录。 默认状态下，展台模式的 Microsoft Edge 右键菜单是受限的。网页内是无法使用右键菜单的，但标签栏可以。Ctrl+C/V 的复制快捷键也是不可用的。但部分网页可以触发折叠菜单，此时可以正常复制。 默认状态下，展台模式的 Microsoft Edge 功能是受限的，收藏夹、浏览器设置、开发者工具等都是无法访问的。 默认状态下，展台模式的 Microsoft Edge 的下载功能和打印功能是可用的，但文件只允许保存至展台用户的 Downloads 文件夹下。 默认状态下，展台模式的 Microsoft Edge 的 file:// 协议未被禁止。通过它可以获得完整的文件目录，及读取低权限用户可以读取的部分文件，但无法下载及做出任何修改。 点击右上角的“结束会话”，可立即重启 Microsoft Edge 并删除浏览数据。Downloads 文件夹下的文件也会一并删除。 默认状态下，展台模式的 Microsoft Edge 只有一个窗口。 更新展台应用时，必须先注销展台用户。注销方法：Ctrl + Alt + Delete 唤起用户切换界面 - 登录管理员用户 - 启动任务管理器 - 用户选项卡 - 注销 （编外：启用写入筛选）写入筛选功能类似数十年前比较流行的“还原卡”的功能：截获驱动器 (应用安装、设置更改、保存的数据) 的写入操作并重定向到虚拟覆盖区。虚拟覆盖区在重新启动等时刻清除，达到“不可对驱动器的文件进行修改”的目的。如果对展台模式的安全性仍有疑虑，可以一并启用写入筛选器提升安全性。 启用功能 写入筛选器功能仅在 Windows Enterprise 系列系统（企业版、IoT 企业版、企业版 LTSC 等）中提供。 控制面板 - 程序 - 启用或关闭 Windows 功能 - 勾选“设备锁定 - 统一写入筛选器”。 运行和设置 统一写入筛选器是 CLI 程序，命令为： 1uwfmgr 常用命令举例1： 123456789101112131415# 显示当前系统配置uwfmgr get-config# 启用写入筛选，重新启动后生效uwfmgr filter enable# 设置用于虚拟覆盖区的 RAM 大小，单位为 MBuwfmgr overlay set-size 1024# 小内存机器可以利用磁盘空闲空间作为虚拟覆盖区uwfmgr overlay set-passthrough on# 设置启用保护的分区uwfmgr volume protect C:# 设置排除的目录，全盘保护则不设置# 同时建议禁用回收站uwfmgr file add-exclusion C:\\Users# 服务模式，允许安装系统更新，可选项uwfmgr servicing update-Windows 设置完成后重新启动系统即可看到效果。 关闭统一写入筛选器，使用如下命令即可： 12uwfmgr filter disableuwfmgr volume unprotect C: 1.参阅官方文档Unified Write Filter (UWF) feature (unified-write-filter) | Microsoft Docs ↩","summary":"图源：Miv4t - 《MACHiNERY》，Pid：77186528 Windows 下的 cat 和 grepls、cat、grep这三个命令，往往是Linux初学者最先了解的、日常使用Linux时不可或缺的。对于Windows系统而言，同样有三个命令可以完成上述工作：dir、type与findstr。 例如，用type显示文件内容： 或者用findstr结合管道匹配先前程序输出内容中的字符串： 也可以结合正则表达式： 如果你不满足于系统命令的显示效果，你也可以尝试下面两款开源于Github的工具： peco项目链接：https://github.com/peco/peco peco可以实现对管道输入的文本进行快速搜索、排序、多行选择等功能，使用Golang编写。目前仍不支持中文编码（GBK），且不支持默认的Windows PowerShell终端（你需要使用传统的命令提示符，或者更先进的终端程序，比如Hyper或者Windows Terminal）。该项目仍在活跃开发中，合理的使用可以提升效率。","date_published":"2022-01-12T12:10:00.000Z","tags":["自由探索","完成编写","笔记","小tricks"]},{"id":"https://www.zhouweitong.site/post/021-synthv-plugin-intro/","url":"https://www.zhouweitong.site/post/021-synthv-plugin-intro/","title":"【WIP】Synthesizer V 插件开发入门","content_html":"<link rel=\"stylesheet\" type=\"text&#x2F;css\" href=\"https://cdn.jsdelivr.net/npm/hexo-tag-hint@0.3.1/dist/hexo-tag-hint.min.css\"><link rel=\"stylesheet\" type=\"text&#x2F;css\" href=\"https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.5.1/katex.min.css\">","content_text":"","summary":"","date_published":"2022-01-08T16:00:00.000Z","tags":["开发与代码","笔记","WIP","VOCALOID","SynthV"]},{"id":"https://www.zhouweitong.site/post/010-snort-1-intro/","url":"https://www.zhouweitong.site/post/010-snort-1-intro/","title":"认识 Snort3 （1）：编译、安装与简单使用","content_html":"<link rel=\"stylesheet\" type=\"text&#x2F;css\" href=\"https://cdn.jsdelivr.net/npm/hexo-tag-hint@0.3.1/dist/hexo-tag-hint.min.css\"><link rel=\"stylesheet\" type=\"text&#x2F;css\" href=\"https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.5.1/katex.min.css\"><p>图源：SAyuki - 《Gray》，Pid：<a href=\"https://www.pixiv.net/artworks/79912976\">79912976</a></p>\n<h2 id=\"Snort- 简介\"><a href=\"#Snort- 简介\" class=\"headerlink\" title=\"Snort 简介\"></a>Snort 简介</h2><p><a href=\"https://www.snort.org/\">Snort</a>，是一款开源的 IDS/IPS 软件，由思科公司（Cisco）主导开发，使用广泛。Snort 有三种模式——包嗅探模式（Packet Sniffer）、包记录模式（Packet Logging）、IPS 模式（Intrusion Prevention System）。搭配自定义的规则、不同的插件与其他软件，Snort 能在不同的系统中发挥不同的作用。</p>\n<p>本篇文章简单记录 Snort3 的编译、安装和简单使用流程。</p>\n<h2 id=\"编译安装 -Snort3\"><a href=\"# 编译安装 -Snort3\" class=\"headerlink\" title=\"编译安装 Snort3\"></a>编译安装 Snort3</h2><p>例子中使用的操作系统是 Ubuntu Server 20.04.3 LTS。当然你也可以使用 Ubuntu 18.04.5 LTS，或者其他 Linux 发行版。某些发行版由于内核配置原因无法编译 libdaq 的部分插件（例如 NFQ），这时 Snort 虽然无法提供防护功能，但仍然可以作为入侵检测系统（IDS）来使用。</p>\n<h3 id=\"快速导入 -Ubuntu-Server- 虚拟机\"><a href=\"# 快速导入 -Ubuntu-Server- 虚拟机\" class=\"headerlink\" title=\"快速导入 Ubuntu Server 虚拟机\"></a>快速导入 Ubuntu Server 虚拟机 </h3><p>Ubuntu Server 虚拟机其实不必下载 ISO 镜像后再用 VMWare 等虚拟化软件从头进行安装。Ubuntu 官方已经提供了预安装的虚拟磁盘的下载（如 <a href=\"https://www.offensive-security.com/kali-linux-vm-vmware-virtualbox-image-download/\">Kali Linux 官方</a> 所做的那样），即 <a href=\"https://cloud-images.ubuntu.com/\">Ubuntu Cloud Images</a>。</p>\n<p><img src=\"/post/010-snort-1-intro/image-20210411151459857.png\" alt=\"image-20210411151459857\"></p>\n<p>以 20.04 LTS daily build 为例，找到对应的 OVA 文件：</p>\n<p><img src=\"/post/010-snort-1-intro/image-20210411151519613.png\" alt=\"image-20210411151519613\"></p>\n<p>以 VMWare Workstation 为例，双击下载的 OVA 文件，唤起 VMWare Workstation 的导入向导；或先打开 VMWare Workstation 主程序，左上角“文件”菜单中点击“打开”，然后选择 OVA 文件。</p>\n<span id=\"more\"></span>\n\n<p><img src=\"/post/010-snort-1-intro/image-20211229202052029.png\" alt=\"image-20211229202052029\"></p>\n<p><img src=\"/post/010-snort-1-intro/image-20211229202746152.png\" alt=\"image-20211229202746152\"></p>\n<p>随后进行 OVA 导入时的初始化设置。</p>\n<p>首先填入虚拟机名称和存储位置。</p>\n<p><img src=\"/post/010-snort-1-intro/image-20211229202952945.png\" alt=\"image-20211229202952945\"></p>\n<p>随后设置系统详情。</p>\n<p><img src=\"/post/010-snort-1-intro/image-20211229203113004.png\" alt=\"image-20211229203113004\"></p>\n<p>由上至下依次解释不同字段的含义：</p>\n<ul>\n<li>“该实例的唯一 ID”：云服务管理器中可见的 ID（第一个输入框，默认值为<code>id-ovf</code>，在 VMWare Workstation 中导入时保持默认值）和主机名。</li>\n<li>“获取种子数据的 URL”：从特定位置获取用户设置数据进行无应答安装，脱离管理器使用时可以忽略。</li>\n<li>“SSH 公钥”：如果需要通过公钥登录 SSH，则将公钥复制粘贴进该输入框。</li>\n<li>“编码的用户数据”：Base64 编码的用户设置数据，用于无应答安装，不使用的情况下留空。</li>\n<li>“默认用户的密码”：是系统中默认的普通权限用户 <strong>ubuntu</strong> 的首次登陆密码，即系统的首次登陆密码。可以设置为一个临时密码，登陆后强制要求修改。</li>\n</ul>\n<p>关于 user-data 和 meta-data 的更多信息，可参阅<a href=\"https://cloudinit.readthedocs.io/en/latest/index.html\">cloud-init 文档</a>。</p>\n<h3 id=\"虚拟机导入后的设置\"><a href=\"# 虚拟机导入后的设置\" class=\"headerlink\" title=\"虚拟机导入后的设置\"></a>虚拟机导入后的设置 </h3><h4 id=\"修改虚拟机设置\"><a href=\"# 修改虚拟机设置\" class=\"headerlink\" title=\"修改虚拟机设置\"></a> 修改虚拟机设置 </h4><p> 在虚拟机设置中，按需修改 CPU、内存的分配值，同时可以移除（我猜应该没人需要）软盘驱动器选项。扩展磁盘容量（例如我在这里扩展到了 30.0GB）。同时将网络适配器的设置进行修改，例如改为 NAT 模式。</p>\n<p><img src=\"/post/010-snort-1-intro/image-20220103133026813.png\" alt=\"image-20220103133026813\"></p>\n<blockquote>\n<p>注意：按下面文档的操作，编译时虚拟机至少需要 2GB 运行内存。</p>\n</blockquote>\n<h4 id=\"如何登陆\"><a href=\"# 如何登陆\" class=\"headerlink\" title=\"如何登陆\"></a>如何登陆 </h4><p> 开机，待登陆界面出现后，使用 <strong>ubuntu 作为登陆用户名、在向导中设置的用户密码作为登陆密码</strong> 登陆系统。</p>\n<p><img src=\"/post/010-snort-1-intro/image-20220103134803948.png\" alt=\"image-20220103134803948\"></p>\n<p>随向导更改密码：</p>\n<p><img src=\"/post/010-snort-1-intro/image-20220103134850381.png\" alt=\"image-20220103134850381\"></p>\n<p>即可成功登陆。</p>\n<h4 id=\"禁用云服务组件\"><a href=\"# 禁用云服务组件\" class=\"headerlink\" title=\"禁用云服务组件\"></a>禁用云服务组件 </h4><p> 关闭并禁止 cloud-config 服务启动。</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo service cloud-config stop</span><br><span class=\"line\">sudo systemctl <span class=\"built_in\">disable</span> cloud-config.service</span><br><span class=\"line\">sudo service cloud-init stop</span><br><span class=\"line\">sudo systemctl <span class=\"built_in\">disable</span> cloud-init.service</span><br></pre></td></tr></table></figure>\n\n<p>可以卸载相关软件包：</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo apt-get remove -y cloud-init</span><br></pre></td></tr></table></figure>\n\n<p>同时 rsync、snapd 等程序也可以按照需要进行卸载。</p>\n<h4 id=\"DNS 解析\"><a href=\"#DNS 解析\" class=\"headerlink\" title=\"DNS 解析\"></a>DNS 解析 </h4><p> 修改 DNS 解析可以结合以下命令：</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ip addr <span class=\"comment\"># 获取网卡接口名称</span></span><br><span class=\"line\">sudo resolvectl dns &lt; 网卡名称 &gt; &lt;DNS 服务器 IP&gt; </span><br></pre></td></tr></table></figure>\n\n<h4 id=\"修改 APT 源\"><a href=\"# 修改 APT 源\" class=\"headerlink\" title=\"修改 APT 源\"></a>修改 APT 源 </h4><p> 编辑<code>/etc/apt/sources.list</code>，更换 apt 源至国内源。教程很多，此处不做详细说明。</p>\n<h4 id=\"修改控制台的分辨率\"><a href=\"# 修改控制台的分辨率\" class=\"headerlink\" title=\"修改控制台的分辨率\"></a>修改控制台的分辨率 </h4><p> 处于控制台模式下时，发现默认分辨率为 700x400px。这时除了设置 OpenSSH Server 通过远程连接虚拟机外，还可以通过修改 Grub 配置来改变控制台分辨率。</p>\n<p>以修改为 1600x1200px 为例，在 <code>/etc/default/grub</code> 中加入以下两行：</p>\n<figure class=\"highlight apache\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attribute\">GRUB_GFXMODE</span>=<span class=\"number\">1600</span>x<span class=\"number\">1200</span></span><br><span class=\"line\"><span class=\"attribute\">GRUB_GTXPAYLOAD_LINUX</span>=<span class=\"number\">1600</span>x<span class=\"number\">1200</span></span><br></pre></td></tr></table></figure>\n\n<p><img src=\"/post/010-snort-1-intro/image-20220103143444728.png\" alt=\"image-20220103143444728\"></p>\n<p>保存后运行：</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo update-grub</span><br></pre></td></tr></table></figure>\n\n<p>重启即可看到效果。<sup id=\"fnref:1\"><a href=\"#fn:1\" rel=\"footnote\">1</a></sup></p>\n<h4 id=\"使 SSH 服务允许使用密码登陆\"><a href=\"# 使 SSH 服务允许使用密码登陆\" class=\"headerlink\" title=\"使 SSH 服务允许使用密码登陆\"></a>使 SSH 服务允许使用密码登陆 </h4><p> 默认已安装和启用 SSH 服务。若需要 ubuntu 用户通过密码连接至虚拟机，编辑<code>/etc/ssh/sshd_config</code>，查找如下行：</p>\n<figure class=\"highlight nginx\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attribute\">PasswordAuthentication</span> <span class=\"literal\">no</span></span><br></pre></td></tr></table></figure>\n\n<p>改为<code>yes</code>，并重新启动 SSH 服务即可。</p>\n<h4 id=\"分区扩容\"><a href=\"# 分区扩容\" class=\"headerlink\" title=\"分区扩容\"></a>分区扩容 </h4><p> 使用 <code>parted</code> 进行分区扩容。</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo parted /dev/sda</span><br><span class=\"line\">p</span><br><span class=\"line\">resizepart 1</span><br><span class=\"line\">yes</span><br><span class=\"line\">-1</span><br><span class=\"line\">p</span><br><span class=\"line\">q</span><br></pre></td></tr></table></figure>\n\n\n\n<p><img src=\"/post/010-snort-1-intro/image-20220103160140977.png\" alt=\"image-20220103160140977\"></p>\n<p><img src=\"/post/010-snort-1-intro/image-20220103160237440.png\" alt=\"image-20220103160237440\"></p>\n<p>随后使用 <code>resize2fs</code> 进行文件系统扩容。</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo resize2fs /dev/sda1</span><br></pre></td></tr></table></figure>\n\n<p><img src=\"/post/010-snort-1-intro/image-20220103160629925.png\" alt=\"image-20220103160629925\"></p>\n<p>至此已成功扩容。</p>\n<p><img src=\"/post/010-snort-1-intro/image-20220103160718568.png\" alt=\"image-20220103160718568\"></p>\n<h4 id=\"安装基本开发环境\"><a href=\"# 安装基本开发环境\" class=\"headerlink\" title=\"安装基本开发环境\"></a>安装基本开发环境</h4><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo apt-get install -y build-essential cmake autoconf</span><br></pre></td></tr></table></figure>\n\n<p>其他安装过程中需要的依赖，在详细步骤中进行说明。</p>\n<h3 id=\"安装新版 -libpcap\"><a href=\"# 安装新版 -libpcap\" class=\"headerlink\" title=\"安装新版 libpcap\"></a>安装新版 libpcap</h3><p>安装依赖：</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo apt-get install -y flex bison</span><br></pre></td></tr></table></figure>\n\n<p>下载源代码，可以选择下载 tar 包解压：</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 可能已有更新版本，可以去官网查看最新版本下载地址</span></span><br><span class=\"line\"><span class=\"comment\"># https://www.tcpdump.org/</span></span><br><span class=\"line\">wget https://www.tcpdump.org/release/libpcap-1.10.1.tar.gz</span><br><span class=\"line\">tar -xzf libpcap-1.9.1.tar.gz</span><br></pre></td></tr></table></figure>\n<p>或者官方 Github Mirror：</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 可能已有更新版本，可以去 Github 查看最新版本 Tag</span></span><br><span class=\"line\">git <span class=\"built_in\">clone</span> https://github.com/the-tcpdump-group/libpcap.git --branch libpcap-1.10.1 --depth 1 libpcap-1.10.1</span><br></pre></td></tr></table></figure>\n\n<p>随后进行配置和安装，以 <code>/usr/lib</code> 作为安装目录：</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">cd</span> libpcap-1.10.1/</span><br><span class=\"line\">./configure --prefix=/usr</span><br><span class=\"line\">make -j2</span><br><span class=\"line\">sudo make install</span><br></pre></td></tr></table></figure>\n\n<blockquote>\n<p>FAQ：我直接安装官方源中的 <code>libpcap-dev</code> 不行吗？</p>\n</blockquote>\n<p>可以尝试，但可能遇到 libpcap 版本过低、Snort3 无法使用的情况。因此还是建议官网编译安装最新版本的 libpcap。</p>\n<h3 id=\"安装 -netmap（可选步骤）\"><a href=\"# 安装 -netmap（可选步骤）\" class=\"headerlink\" title=\"安装 netmap（可选步骤）\"></a>安装 netmap（可选步骤）</h3><p>下载源代码：</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 可能已有更新版本，可以去 Github 查看最新版本 Tag</span></span><br><span class=\"line\">git <span class=\"built_in\">clone</span> https://github.com/luigirizzo/netmap.git --branch v13.0 --depth 1</span><br></pre></td></tr></table></figure>\n\n<p>编译安装<sup id=\"fnref:2\"><a href=\"#fn:2\" rel=\"footnote\">2</a></sup>：</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">cd</span> netmap/</span><br><span class=\"line\">./configure --prefix=/usr</span><br><span class=\"line\">make -j2</span><br><span class=\"line\">sudo make install</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"安装 -libdaq\"><a href=\"# 安装 -libdaq\" class=\"headerlink\" title=\"安装 libdaq\"></a>安装 libdaq</h3><p>安装依赖：</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo apt-get install -y pkg-config libtool libmnl-dev nftables</span><br></pre></td></tr></table></figure>\n\n<p>下载源代码：</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 可能已有更新版本，可以去 Github 查看最新版本 Tag</span></span><br><span class=\"line\">git <span class=\"built_in\">clone</span> https://github.com/snort3/libdaq.git --branch v3.0.5 --depth 1</span><br></pre></td></tr></table></figure>\n\n<p>编译安装：</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">cd</span> libdaq/</span><br><span class=\"line\">./bootstrap</span><br><span class=\"line\">./configure --prefix=/usr</span><br><span class=\"line\">make -j2</span><br><span class=\"line\">sudo make install</span><br></pre></td></tr></table></figure>\n\n<p>注意：</p>\n<ul>\n<li>若需要在“检测”的同时启用“过滤”功能，必须保证 NFQ DAQ module 处于开启状态。</li>\n<li>Divert module 是 BSD 独有的模块。</li>\n<li>netmap module 需要手动安装，且是可选项。</li>\n</ul>\n<h3 id=\"安装 -libdnet\"><a href=\"# 安装 -libdnet\" class=\"headerlink\" title=\"安装 libdnet\"></a>安装 libdnet</h3><p>下载源代码：</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 长时间没有发布新的版本，直接使用主分支</span></span><br><span class=\"line\">git <span class=\"built_in\">clone</span> --depth 1 https://github.com/ofalk/libdnet.git</span><br></pre></td></tr></table></figure>\n\n<p>编译安装：</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">cd</span> libdnet/</span><br><span class=\"line\">./configure --prefix=/usr</span><br><span class=\"line\">make -j2</span><br><span class=\"line\">sudo make install</span><br></pre></td></tr></table></figure>\n\n<blockquote>\n<p>FAQ：我直接安装官方源中的 <code>libdnet-dev</code> 不行吗？</p>\n</blockquote>\n<p>是 <strong> 不行 </strong> 的。<code>libdnet-dev</code>包不是 Snort3 需要的 libdnet 库，而是 Debian 系列系统下的 DECnet 库。Snort3 需要的 libdnet 库在 Ubuntu 的官方源中是 <code>libdumbnet-dev</code> 包。</p>\n<blockquote>\n<p>FAQ：那我安装 <code>libdumbnet-dev</code> 包不行吗？</p>\n</blockquote>\n<p>理论上可以，但 <strong> 非常麻烦 </strong>，因为需要修改 Snort3 的编译命令，将<code>-ldnet</code> 全部修改为<code>-ldumbnet</code>。</p>\n<h3 id=\"安装 Snort\"><a href=\"# 安装 Snort\" class=\"headerlink\" title=\"安装 Snort\"></a>安装 Snort</h3><p>安装依赖：</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo apt-get install -y libhwloc-dev luajit libluajit-5.1-dev libssl-dev libpcre3-dev zlib1g-dev liblzma-dev libunwind-dev uuid-dev libhyperscan-dev libflatbuffers-dev libsafec-dev libjemalloc-dev</span><br></pre></td></tr></table></figure>\n\n<p>下载源代码：</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 可能已有更新版本，可以去 Github 查看最新版本 Tag</span></span><br><span class=\"line\">git <span class=\"built_in\">clone</span> https://github.com/snort3/snort3.git --branch 3.1.19.0 --depth 1</span><br><span class=\"line\"><span class=\"comment\"># 创建安装目录</span></span><br><span class=\"line\">sudo mkdir /opt/snort</span><br><span class=\"line\">./configure_cmake.sh --prefix=/opt/snort --enable-jemalloc</span><br><span class=\"line\"><span class=\"built_in\">cd</span> build/</span><br><span class=\"line\">make -j2</span><br><span class=\"line\">sudo make install</span><br></pre></td></tr></table></figure>\n\n<p>随后可以运行：</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">/opt/snort/bin/snort -V</span><br></pre></td></tr></table></figure>\n\n<p>查看 Snort3 的版本。</p>\n<p><img src=\"/post/010-snort-1-intro/image-20220104174723325.png\" alt=\"image-20220104174723325\"></p>\n<p>这就结束了整个编译和安装过程。</p>\n<h2 id=\"简单使用 Snort\"><a href=\"# 简单使用 Snort\" class=\"headerlink\" title=\"简单使用 Snort\"></a>简单使用 Snort</h2><p>使用简单的明文 Telnet 测试 Snort3 是否可以正常使用。</p>\n<h3 id=\"虚拟网络环境设置\"><a href=\"# 虚拟网络环境设置\" class=\"headerlink\" title=\"虚拟网络环境设置\"></a>虚拟网络环境设置 </h3><p> 共有三台虚拟机同时运行：</p>\n<ul>\n<li>Telnet 服务器，只有一块 NAT 网卡（VMNet8），IP 地址：192.168.232.130</li>\n<li>Telnet 客户端，只有一块 Host-Only 网卡（VMNet2），IP 地址：192.168.153.128</li>\n<li>Snort3 机器，有 NAT 网卡（VMNet8）和 Host-Only 网卡（VMNet2）。IP 地址分别为：192.168.232.134，192.168.153.129</li>\n</ul>\n<p>对 Snort3 机器的网络进行设置：</p>\n<p>首先，使用</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ip addr</span><br></pre></td></tr></table></figure>\n\n<p>查看第二块网卡的设备名和 MAC 地址。</p>\n<p><img src=\"/post/010-snort-1-intro/image-20220104233537043.png\" alt=\"image-20220104233537043\"></p>\n<p>编辑 netplan 配置文件：</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo nano /etc/netplan/50-cloud-init.yaml</span><br></pre></td></tr></table></figure>\n\n<p>仿照第一个网卡的设置，设置第二个网卡的静态 IP<sup id=\"fnref:4\"><a href=\"#fn:4\" rel=\"footnote\">4</a></sup>。</p>\n<p><img src=\"/post/010-snort-1-intro/image-20220104235902424.png\" alt=\"image-20220104235902424\"></p>\n<figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">ens32:</span></span><br><span class=\"line\">    <span class=\"attr\">addresses:</span></span><br><span class=\"line\">        <span class=\"bullet\">-</span> <span class=\"number\">192.168</span><span class=\"number\">.153</span><span class=\"number\">.129</span><span class=\"string\">/24</span></span><br><span class=\"line\">    <span class=\"attr\">match:</span></span><br><span class=\"line\">        <span class=\"attr\">macaddress:</span> <span class=\"number\">00</span><span class=\"string\">:0c:29:ff:b8:87</span></span><br><span class=\"line\">    <span class=\"attr\">set-name:</span> <span class=\"string\">ens32</span></span><br></pre></td></tr></table></figure>\n\n<p>随后重启，或者直接应用 netplan 设置：</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo netplan apply</span><br></pre></td></tr></table></figure>\n\n<p>再开启网卡：</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo ip link <span class=\"built_in\">set</span> ens32 up</span><br></pre></td></tr></table></figure>\n\n<p>即可看到两个网卡的 IP 地址。</p>\n<p><img src=\"/post/010-snort-1-intro/image-20220104234847218.png\" alt=\"image-20220104234847218\"></p>\n<h3 id=\"Telnet 服务器设置\"><a href=\"#Telnet 服务器设置\" class=\"headerlink\" title=\"Telnet 服务器设置\"></a>Telnet 服务器设置 </h3><p> 系统版本：Ubuntu 20.04.3 LTS Desktop amd64</p>\n<p>安装 Telnet 服务器：</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo apt-get install -y xinetd telnetd</span><br></pre></td></tr></table></figure>\n\n<p>创建 Telnet Server 配置文件：</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo nano /etc/xinetd.d/telnet</span><br></pre></td></tr></table></figure>\n\n<p>配置文件中按需修改和保存以下内容<sup id=\"fnref:3\"><a href=\"#fn:3\" rel=\"footnote\">3</a></sup>：</p>\n<figure class=\"highlight properties\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># default: on</span></span><br><span class=\"line\"><span class=\"comment\"># description: The telnet server serves telnet sessions; it uses</span></span><br><span class=\"line\"><span class=\"comment\"># unencrypted username/password pairs for authentication.</span></span><br><span class=\"line\"><span class=\"attr\">service</span> <span class=\"string\">telnet</span></span><br><span class=\"line\"><span class=\"attr\">&#123;</span></span><br><span class=\"line\">        <span class=\"attr\">disable</span> = <span class=\"string\">no</span></span><br><span class=\"line\">        <span class=\"attr\">flags</span> = <span class=\"string\">REUSE</span></span><br><span class=\"line\">        <span class=\"attr\">socket_type</span> = <span class=\"string\">stream</span></span><br><span class=\"line\">        <span class=\"attr\">wait</span> = <span class=\"string\">no</span></span><br><span class=\"line\">        <span class=\"attr\">user</span> = <span class=\"string\">root</span></span><br><span class=\"line\">        <span class=\"attr\">server</span> = <span class=\"string\">/usr/sbin/in.telnetd</span></span><br><span class=\"line\">        <span class=\"attr\">log_on_failure</span> <span class=\"string\">+= USERID</span></span><br><span class=\"line\"><span class=\"attr\">&#125;</span></span><br></pre></td></tr></table></figure>\n\n<p>重启 xinetd 服务：</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo service xinetd restart</span><br></pre></td></tr></table></figure>\n\n<p>即可接受客户端的 Telnet 连接。</p>\n<h3 id=\"Telnet 客户端设置\"><a href=\"#Telnet 客户端设置\" class=\"headerlink\" title=\"Telnet 客户端设置\"></a>Telnet 客户端设置 </h3><p> 系统版本：Windows 10 LTSC 2021 amd64，Build 19044.1415</p>\n<p>安装 Telnet 客户端：</p>\n<p>控制面板 -&gt; 程序 -&gt; 程序和功能 -&gt; 启用和关闭 Windows 功能，勾选“Telnet 客户端” -&gt; 确定。</p>\n<p><img src=\"/post/010-snort-1-intro/image-20220104220457632.png\" alt=\"image-20220104220457632\"></p>\n<p>随后打开 Windows PowerShell，用以下命令即可启动 Telnet 连接：</p>\n<figure class=\"highlight powershell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">telnet &lt;IP 地址 &gt; &lt; 端口号 &gt;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"设置网关\"><a href=\"# 设置网关\" class=\"headerlink\" title=\"设置网关\"></a>设置网关</h3><p>Windows 上打开网络与共享中心，修改以太网的网关为 192.168.153.129，并填写公网 DNS 服务器：</p>\n<p><img src=\"/post/010-snort-1-intro/image-20220104235243926.png\" alt=\"image-20220104235243926\"></p>\n<p>此时 Windows 可访问 Snort3 机器，不可访问 Telnet Server 机器。</p>\n<p>在 Snort3 机器上打开 IPv4 包转发功能：</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo su</span><br><span class=\"line\"><span class=\"built_in\">echo</span> 1 &gt; /proc/sys/net/ipv4/ip_forward</span><br></pre></td></tr></table></figure>\n\n<p>同时修改<code>/etc/sysctl.conf</code>，使 IPv4 包转发持续开启。</p>\n<p><img src=\"/post/010-snort-1-intro/image-20220105001054546.png\" alt=\"image-20220105001054546\"></p>\n<p>修改 iptables 规则，设置转发和混杂模式：</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo iptables -A FORWARD -i ens32 -o ens192 -j ACCEPT</span><br><span class=\"line\">sudo iptables -t nat -A POSTROUTING -o ens192 -j MASQUERADE</span><br><span class=\"line\"><span class=\"comment\"># 保存配置</span></span><br><span class=\"line\">sudo iptables-save &gt; iptables.conf</span><br></pre></td></tr></table></figure>\n\n<p>此时，Telnet 客户端机器已可以连接 Telnet 服务器。</p>\n<p><img src=\"/post/010-snort-1-intro/image-20220105001938991.png\" alt=\"image-20220105001938991\"></p>\n<p><img src=\"/post/010-snort-1-intro/image-20220105002026116.png\" alt=\"image-20220105002026116\"></p>\n<h3 id=\"Snort 的记录模式\"><a href=\"#Snort 的记录模式\" class=\"headerlink\" title=\"Snort 的记录模式\"></a>Snort 的记录模式 </h3><p> 示例命令：</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo /opt/snort/bin/snort -i ens32 -L dump -d</span><br></pre></td></tr></table></figure>\n\n<p>包输出举例：</p>\n<p><img src=\"/post/010-snort-1-intro/image-20220105002754719.png\" alt=\"image-20220105002754719\"></p>\n<p>包统计举例：</p>\n<p><img src=\"/post/010-snort-1-intro/image-20220105002821577.png\" alt=\"image-20220105002821577\"></p>\n<p>也可以作为抓包工具使用。示例命令：</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo mkdir /opt/snort/pcap <span class=\"comment\"># 用于存放生成的 pcap 文件的文件夹</span></span><br><span class=\"line\">sudo /opt/snort/bin/snort -i ens32 -L pcap -l /opt/snort/pcap -d -e</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"简单上手 Snort 的检测模式\"><a href=\"# 简单上手 Snort 的检测模式\" class=\"headerlink\" title=\"简单上手 Snort 的检测模式\"></a>简单上手 Snort 的检测模式 </h3><p> 检测 / 过滤模式需要结合 Snort 的“配置文件”和“规则文件”进行使用。</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">mkdir snort_rules <span class=\"comment\"># 存放配置文件和规则文件</span></span><br><span class=\"line\"><span class=\"built_in\">cd</span> snort_rules/</span><br><span class=\"line\">touch config.lua <span class=\"comment\"># Snort 的配置文件</span></span><br><span class=\"line\">touch telnet.rule <span class=\"comment\"># 针对 Telnet 的报警规则</span></span><br></pre></td></tr></table></figure>\n\n<p>参照 <code>/opt/snort/etc</code> 内的内容，编写<code>config.lua</code>：</p>\n<figure class=\"highlight lua\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">-- 导入通用流式协议解析规则、IP 协议解析规则和 TCP 流解析规则</span></span><br><span class=\"line\"><span class=\"comment\">-- 可通过 --help-module $mod 查看详情</span></span><br><span class=\"line\">stream = &#123;&#125;</span><br><span class=\"line\">stream_ip = &#123;&#125;</span><br><span class=\"line\">stream_tcp = &#123;&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">-- 设置检测规则</span></span><br><span class=\"line\">ips = </span><br><span class=\"line\">&#123;</span><br><span class=\"line\">\t<span class=\"comment\">-- 包含外部文件内的规则</span></span><br><span class=\"line\">\tinclude = <span class=\"string\">&#x27;telnet.rule&#x27;</span>,</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"comment\">-- 传递变量</span></span><br><span class=\"line\">\tvariables =</span><br><span class=\"line\">\t&#123;</span><br><span class=\"line\">\t\tnets = </span><br><span class=\"line\">\t\t&#123;</span><br><span class=\"line\">\t\t\t<span class=\"comment\">-- “外部网络”IP</span></span><br><span class=\"line\">\t\t\tEXTERNAL_NET = <span class=\"string\">&#x27;any&#x27;</span>,</span><br><span class=\"line\">\t\t\t<span class=\"comment\">-- &quot; 需要被保护的“IP</span></span><br><span class=\"line\">\t\t\tHOME_NET = <span class=\"string\">&#x27;192.168.232.130&#x27;</span></span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>以及编写规则<sup id=\"fnref:5\"><a href=\"#fn:5\" rel=\"footnote\">5</a></sup>。以“检测用户通过 Telnet 输入了 sudo”为例：</p>\n<figure class=\"highlight properties\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 声明协议类型、IP 地址、数据流向等</span></span><br><span class=\"line\"><span class=\"attr\">alert</span> <span class=\"string\">tcp $EXTERNAL_NET any -&gt; $HOME_NET 23 (</span></span><br><span class=\"line\"><span class=\"comment\">     # 自定义提示消息</span></span><br><span class=\"line\">\t<span class=\"attr\">msg</span>: <span class=\"string\">&quot;\\&quot;sudo\\&quot; appeared in telnet.&quot;;</span></span><br><span class=\"line\">\t<span class=\"attr\">flow</span>: <span class=\"string\">to_server, established;</span></span><br><span class=\"line\"><span class=\"comment\">\t# 不区分大小写</span></span><br><span class=\"line\">\t<span class=\"attr\">content</span>: <span class=\"string\">&quot;sudo&quot;, nocase;</span></span><br><span class=\"line\"><span class=\"attr\">)</span></span><br></pre></td></tr></table></figure>\n\n<p>启动 Snort3。示例命令：</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo /opt/snort/bin/snort -c config.lua -i ens32 -A fast -d</span><br></pre></td></tr></table></figure>\n\n<p>进行测试，成功产生警告：</p>\n<p><img src=\"/post/010-snort-1-intro/image-20220105013941072.png\" alt=\"image-20220105013941072\"></p>\n<p><img src=\"/post/010-snort-1-intro/image-20220105014142124.png\" alt=\"image-20220105014142124\"></p>\n<div id=\"footnotes\"><hr><div id=\"footnotelist\"><ol style=\"list-style:none; padding-left: 0;\"><li id=\"fn:1\"><span style=\"display: inline-block; vertical-align: top; padding-right: 10px;\">1.</span><span style=\"display: inline-block; vertical-align: top;\">参阅 <a href=\"https://askubuntu.com/questions/18444/how-do-i-increase-console-mode-resolution\">tty - How do I increase console-mode resolution? - Ask Ubuntu</a>，可能遇到方法失效的情况。</span><a href=\"#fnref:1\" rev=\"footnote\"> ↩</a></li><li id=\"fn:2\"><span style=\"display: inline-block; vertical-align: top; padding-right: 10px;\">2.</span><span style=\"display: inline-block; vertical-align: top;\"> 参阅 <a href=\"https://github.com/luigirizzo/netmap#linux\">luigirizzo/netmap: Automatically exported from code.google.com/p/netmap</a>，可能需要完整内核源码，且只对特定型号的网卡有效。</span><a href=\"#fnref:2\" rev=\"footnote\"> ↩</a></li><li id=\"fn:3\"><span style=\"display: inline-block; vertical-align: top; padding-right: 10px;\">3.</span><span style=\"display: inline-block; vertical-align: top;\"> 参阅 <a href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/4/html/reference_guide/s2-tcpwrappers-xinetd-config-files\">17.4.2. The /etc/xinetd.d/ Directory Red Hat Enterprise Linux 4 | Red Hat Customer Portal</a>。</span><a href=\"#fnref:3\" rev=\"footnote\"> ↩</a></li><li id=\"fn:4\"><span style=\"display: inline-block; vertical-align: top; padding-right: 10px;\">4.</span><span style=\"display: inline-block; vertical-align: top;\"> 参阅 <a href=\"https://netplan.io/examples/\">Netplan | Backend-agnostic network configuration in YAML</a>。</span><a href=\"#fnref:4\" rev=\"footnote\"> ↩</a></li><li id=\"fn:5\"><span style=\"display: inline-block; vertical-align: top; padding-right: 10px;\">5.</span><span style=\"display: inline-block; vertical-align: top;\"><a href=\"https://www.snort.org/downloads/community/snort3-community-rules.tar.gz\">snort3-community-rules</a> 是不错的参考资料。</span><a href=\"#fnref:5\" rev=\"footnote\"> ↩</a></li></ol></div></div>","content_text":"图源：SAyuki - 《Gray》，Pid：79912976 Snort 简介Snort，是一款开源的 IDS/IPS 软件，由思科公司（Cisco）主导开发，使用广泛。Snort 有三种模式——包嗅探模式（Packet Sniffer）、包记录模式（Packet Logging）、IPS 模式（Intrusion Prevention System）。搭配自定义的规则、不同的插件与其他软件，Snort 能在不同的系统中发挥不同的作用。 本篇文章简单记录 Snort3 的编译、安装和简单使用流程。 编译安装 Snort3例子中使用的操作系统是 Ubuntu Server 20.04.3 LTS。当然你也可以使用 Ubuntu 18.04.5 LTS，或者其他 Linux 发行版。某些发行版由于内核配置原因无法编译 libdaq 的部分插件（例如 NFQ），这时 Snort 虽然无法提供防护功能，但仍然可以作为入侵检测系统（IDS）来使用。 快速导入 Ubuntu Server 虚拟机 Ubuntu Server 虚拟机其实不必下载 ISO 镜像后再用 VMWare 等虚拟化软件从头进行安装。Ubuntu 官方已经提供了预安装的虚拟磁盘的下载（如 Kali Linux 官方 所做的那样），即 Ubuntu Cloud Images。 以 20.04 LTS daily build 为例，找到对应的 OVA 文件： 以 VMWare Workstation 为例，双击下载的 OVA 文件，唤起 VMWare Workstation 的导入向导；或先打开 VMWare Workstation 主程序，左上角“文件”菜单中点击“打开”，然后选择 OVA 文件。 随后进行 OVA 导入时的初始化设置。 首先填入虚拟机名称和存储位置。 随后设置系统详情。 由上至下依次解释不同字段的含义： “该实例的唯一 ID”：云服务管理器中可见的 ID（第一个输入框，默认值为id-ovf，在 VMWare Workstation 中导入时保持默认值）和主机名。 “获取种子数据的 URL”：从特定位置获取用户设置数据进行无应答安装，脱离管理器使用时可以忽略。 “SSH 公钥”：如果需要通过公钥登录 SSH，则将公钥复制粘贴进该输入框。 “编码的用户数据”：Base64 编码的用户设置数据，用于无应答安装，不使用的情况下留空。 “默认用户的密码”：是系统中默认的普通权限用户 ubuntu 的首次登陆密码，即系统的首次登陆密码。可以设置为一个临时密码，登陆后强制要求修改。 关于 user-data 和 meta-data 的更多信息，可参阅cloud-init 文档。 虚拟机导入后的设置 修改虚拟机设置 在虚拟机设置中，按需修改 CPU、内存的分配值，同时可以移除（我猜应该没人需要）软盘驱动器选项。扩展磁盘容量（例如我在这里扩展到了 30.0GB）。同时将网络适配器的设置进行修改，例如改为 NAT 模式。 注意：按下面文档的操作，编译时虚拟机至少需要 2GB 运行内存。 如何登陆 开机，待登陆界面出现后，使用 ubuntu 作为登陆用户名、在向导中设置的用户密码作为登陆密码 登陆系统。 随向导更改密码： 即可成功登陆。 禁用云服务组件 关闭并禁止 cloud-config 服务启动。 1234sudo service cloud-config stopsudo systemctl disable cloud-config.servicesudo service cloud-init stopsudo systemctl disable cloud-init.service 可以卸载相关软件包： 1sudo apt-get remove -y cloud-init 同时 rsync、snapd 等程序也可以按照需要进行卸载。 DNS 解析 修改 DNS 解析可以结合以下命令： 12ip addr # 获取网卡接口名称sudo resolvectl dns &lt; 网卡名称 &gt; &lt;DNS 服务器 IP&gt; 修改 APT 源 编辑/etc/apt/sources.list，更换 apt 源至国内源。教程很多，此处不做详细说明。 修改控制台的分辨率 处于控制台模式下时，发现默认分辨率为 700x400px。这时除了设置 OpenSSH Server 通过远程连接虚拟机外，还可以通过修改 Grub 配置来改变控制台分辨率。 以修改为 1600x1200px 为例，在 /etc/default/grub 中加入以下两行： 12GRUB_GFXMODE=1600x1200GRUB_GTXPAYLOAD_LINUX=1600x1200 保存后运行： 1sudo update-grub 重启即可看到效果。1 使 SSH 服务允许使用密码登陆 默认已安装和启用 SSH 服务。若需要 ubuntu 用户通过密码连接至虚拟机，编辑/etc/ssh/sshd_config，查找如下行： 1PasswordAuthentication no 改为yes，并重新启动 SSH 服务即可。 分区扩容 使用 parted 进行分区扩容。 1234567sudo parted /dev/sdapresizepart 1yes-1pq 随后使用 resize2fs 进行文件系统扩容。 1sudo resize2fs /dev/sda1 至此已成功扩容。 安装基本开发环境1sudo apt-get install -y build-essential cmake autoconf 其他安装过程中需要的依赖，在详细步骤中进行说明。 安装新版 libpcap安装依赖： 1sudo apt-get install -y flex bison 下载源代码，可以选择下载 tar 包解压： 1234# 可能已有更新版本，可以去官网查看最新版本下载地址# https://www.tcpdump.org/wget https://www.tcpdump.org/release/libpcap-1.10.1.tar.gztar -xzf libpcap-1.9.1.tar.gz 或者官方 Github Mirror： 12# 可能已有更新版本，可以去 Github 查看最新版本 Taggit clone https://github.com/the-tcpdump-group/libpcap.git --branch libpcap-1.10.1 --depth 1 libpcap-1.10.1 随后进行配置和安装，以 /usr/lib 作为安装目录： 1234cd libpcap-1.10.1/./configure --prefix=/usrmake -j2sudo make install FAQ：我直接安装官方源中的 libpcap-dev 不行吗？ 可以尝试，但可能遇到 libpcap 版本过低、Snort3 无法使用的情况。因此还是建议官网编译安装最新版本的 libpcap。 安装 netmap（可选步骤）下载源代码： 12# 可能已有更新版本，可以去 Github 查看最新版本 Taggit clone https://github.com/luigirizzo/netmap.git --branch v13.0 --depth 1 编译安装2： 1234cd netmap/./configure --prefix=/usrmake -j2sudo make install 安装 libdaq安装依赖： 1sudo apt-get install -y pkg-config libtool libmnl-dev nftables 下载源代码： 12# 可能已有更新版本，可以去 Github 查看最新版本 Taggit clone https://github.com/snort3/libdaq.git --branch v3.0.5 --depth 1 编译安装： 12345cd libdaq/./bootstrap./configure --prefix=/usrmake -j2sudo make install 注意： 若需要在“检测”的同时启用“过滤”功能，必须保证 NFQ DAQ module 处于开启状态。 Divert module 是 BSD 独有的模块。 netmap module 需要手动安装，且是可选项。 安装 libdnet下载源代码： 12# 长时间没有发布新的版本，直接使用主分支git clone --depth 1 https://github.com/ofalk/libdnet.git 编译安装： 1234cd libdnet/./configure --prefix=/usrmake -j2sudo make install FAQ：我直接安装官方源中的 libdnet-dev 不行吗？ 是 不行 的。libdnet-dev包不是 Snort3 需要的 libdnet 库，而是 Debian 系列系统下的 DECnet 库。Snort3 需要的 libdnet 库在 Ubuntu 的官方源中是 libdumbnet-dev 包。 FAQ：那我安装 libdumbnet-dev 包不行吗？ 理论上可以，但 非常麻烦 ，因为需要修改 Snort3 的编译命令，将-ldnet 全部修改为-ldumbnet。 安装 Snort安装依赖： 1sudo apt-get install -y libhwloc-dev luajit libluajit-5.1-dev libssl-dev libpcre3-dev zlib1g-dev liblzma-dev libunwind-dev uuid-dev libhyperscan-dev libflatbuffers-dev libsafec-dev libjemalloc-dev 下载源代码： 12345678# 可能已有更新版本，可以去 Github 查看最新版本 Taggit clone https://github.com/snort3/snort3.git --branch 3.1.19.0 --depth 1# 创建安装目录sudo mkdir /opt/snort./configure_cmake.sh --prefix=/opt/snort --enable-jemalloccd build/make -j2sudo make install 随后可以运行： 1/opt/snort/bin/snort -V 查看 Snort3 的版本。 这就结束了整个编译和安装过程。 简单使用 Snort使用简单的明文 Telnet 测试 Snort3 是否可以正常使用。 虚拟网络环境设置 共有三台虚拟机同时运行： Telnet 服务器，只有一块 NAT 网卡（VMNet8），IP 地址：192.168.232.130 Telnet 客户端，只有一块 Host-Only 网卡（VMNet2），IP 地址：192.168.153.128 Snort3 机器，有 NAT 网卡（VMNet8）和 Host-Only 网卡（VMNet2）。IP 地址分别为：192.168.232.134，192.168.153.129 对 Snort3 机器的网络进行设置： 首先，使用 1ip addr 查看第二块网卡的设备名和 MAC 地址。 编辑 netplan 配置文件： 1sudo nano /etc/netplan/50-cloud-init.yaml 仿照第一个网卡的设置，设置第二个网卡的静态 IP4。 123456ens32: addresses: - 192.168.153.129/24 match: macaddress: 00:0c:29:ff:b8:87 set-name: ens32 随后重启，或者直接应用 netplan 设置： 1sudo netplan apply 再开启网卡： 1sudo ip link set ens32 up 即可看到两个网卡的 IP 地址。 Telnet 服务器设置 系统版本：Ubuntu 20.04.3 LTS Desktop amd64 安装 Telnet 服务器： 1sudo apt-get install -y xinetd telnetd 创建 Telnet Server 配置文件： 1sudo nano /etc/xinetd.d/telnet 配置文件中按需修改和保存以下内容3： 12345678910111213# default: on# description: The telnet server serves telnet sessions; it uses# unencrypted username/password pairs for authentication.service telnet&#123; disable = no flags = REUSE socket_type = stream wait = no user = root server = /usr/sbin/in.telnetd log_on_failure += USERID&#125; 重启 xinetd 服务： 1sudo service xinetd restart 即可接受客户端的 Telnet 连接。 Telnet 客户端设置 系统版本：Windows 10 LTSC 2021 amd64，Build 19044.1415 安装 Telnet 客户端： 控制面板 -&gt; 程序 -&gt; 程序和功能 -&gt; 启用和关闭 Windows 功能，勾选“Telnet 客户端” -&gt; 确定。 随后打开 Windows PowerShell，用以下命令即可启动 Telnet 连接： 1telnet &lt;IP 地址 &gt; &lt; 端口号 &gt; 设置网关Windows 上打开网络与共享中心，修改以太网的网关为 192.168.153.129，并填写公网 DNS 服务器： 此时 Windows 可访问 Snort3 机器，不可访问 Telnet Server 机器。 在 Snort3 机器上打开 IPv4 包转发功能： 12sudo suecho 1 &gt; /proc/sys/net/ipv4/ip_forward 同时修改/etc/sysctl.conf，使 IPv4 包转发持续开启。 修改 iptables 规则，设置转发和混杂模式： 1234sudo iptables -A FORWARD -i ens32 -o ens192 -j ACCEPTsudo iptables -t nat -A POSTROUTING -o ens192 -j MASQUERADE# 保存配置sudo iptables-save &gt; iptables.conf 此时，Telnet 客户端机器已可以连接 Telnet 服务器。 Snort 的记录模式 示例命令： 1sudo /opt/snort/bin/snort -i ens32 -L dump -d 包输出举例： 包统计举例： 也可以作为抓包工具使用。示例命令： 12sudo mkdir /opt/snort/pcap # 用于存放生成的 pcap 文件的文件夹sudo /opt/snort/bin/snort -i ens32 -L pcap -l /opt/snort/pcap -d -e 简单上手 Snort 的检测模式 检测 / 过滤模式需要结合 Snort 的“配置文件”和“规则文件”进行使用。 1234mkdir snort_rules # 存放配置文件和规则文件cd snort_rules/touch config.lua # Snort 的配置文件touch telnet.rule # 针对 Telnet 的报警规则 参照 /opt/snort/etc 内的内容，编写config.lua： 123456789101112131415161718192021222324-- 导入通用流式协议解析规则、IP 协议解析规则和 TCP 流解析规则-- 可通过 --help-module $mod 查看详情stream = &#123;&#125;stream_ip = &#123;&#125;stream_tcp = &#123;&#125;-- 设置检测规则ips = &#123; -- 包含外部文件内的规则 include = &#x27;telnet.rule&#x27;, -- 传递变量 variables = &#123; nets = &#123; -- “外部网络”IP EXTERNAL_NET = &#x27;any&#x27;, -- &quot; 需要被保护的“IP HOME_NET = &#x27;192.168.232.130&#x27; &#125; &#125;&#125; 以及编写规则5。以“检测用户通过 Telnet 输入了 sudo”为例： 12345678# 声明协议类型、IP 地址、数据流向等alert tcp $EXTERNAL_NET any -&gt; $HOME_NET 23 ( # 自定义提示消息 msg: &quot;\\&quot;sudo\\&quot; appeared in telnet.&quot;; flow: to_server, established; # 不区分大小写 content: &quot;sudo&quot;, nocase;) 启动 Snort3。示例命令： 1sudo /opt/snort/bin/snort -c config.lua -i ens32 -A fast -d 进行测试，成功产生警告： 1.参阅 tty - How do I increase console-mode resolution? - Ask Ubuntu，可能遇到方法失效的情况。 ↩2. 参阅 luigirizzo/netmap: Automatically exported from code.google.com/p/netmap，可能需要完整内核源码，且只对特定型号的网卡有效。 ↩3. 参阅 17.4.2. The /etc/xinetd.d/ Directory Red Hat Enterprise Linux 4 | Red Hat Customer Portal。 ↩4. 参阅 Netplan | Backend-agnostic network configuration in YAML。 ↩5.snort3-community-rules 是不错的参考资料。 ↩","summary":"图源：SAyuki - 《Gray》，Pid：79912976 Snort 简介Snort，是一款开源的 IDS/IPS 软件，由思科公司（Cisco）主导开发，使用广泛。Snort 有三种模式——包嗅探模式（Packet Sniffer）、包记录模式（Packet Logging）、IPS模式（Intrusion Prevention System）。搭配自定义的规则、不同的插件与其他软件，Snort 能在不同的系统中发挥不同的作用。 本篇文章简单记录 Snort3 的编译、安装和简单使用流程。 编译安装 Snort3例子中使用的操作系统是 Ubuntu Server 20.04.3 LTS。当然你也可以使用 Ubuntu 18.04.5 LTS，或者其他 Linux 发行版。某些发行版由于内核配置原因无法编译 libdaq 的部分插件（例如 NFQ），这时 Snort 虽然无法提供防护功能，但仍然可以作为入侵检测系统（IDS）来使用。 快速导入 Ubuntu Server 虚拟机Ubuntu Server 虚拟机其实不必下载 ISO 镜像后再用 VMWare 等虚拟化软件从头进行安装。Ubuntu 官方已经提供了预安装的虚拟磁盘的下载（如 Kali Linux 官方所做的那样），即 Ubuntu Cloud Images。 以 20.04 LTS daily build 为例，找到对应的 OVA 文件： 以VMWare Workstation为例，双击下载的OVA文件，唤起VMWare Workstation的导入向导；或先打开VMWare Workstation主程序，左上角“文件”菜单中点击“打开”，然后选择OVA文件。","date_published":"2022-01-06T15:00:00.000Z","tags":["网络安全","完成编写","Snort","IDS"]},{"id":"https://www.zhouweitong.site/post/034-linux-windows-tricks-04/","url":"https://www.zhouweitong.site/post/034-linux-windows-tricks-04/","title":"【WIP】Linux & Windows 小技巧（4）","content_html":"<link rel=\"stylesheet\" type=\"text&#x2F;css\" href=\"https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.5.1/katex.min.css\"><link rel=\"stylesheet\" type=\"text&#x2F;css\" href=\"https://cdn.jsdelivr.net/npm/hexo-tag-hint@0.3.1/dist/hexo-tag-hint.min.css\"><h2 id=\"Linux- 桌面环境\"><a href=\"#Linux- 桌面环境\" class=\"headerlink\" title=\"Linux 桌面环境\"></a>Linux 桌面环境 </h2><p> 两种常见 Display Server：</p>\n<ul>\n<li>X Window System：历史久导致兼容性好，但设计思路老旧，性能问题开始有所体现。官方实现：X.Org Server。</li>\n<li>Wayland：更简单的现代化窗口系统。比 X Window System 更高效，但兼容性仍不够好。正逐步替代 X Window System。官方实现：Weston。</li>\n</ul>\n<h3 id=\"X-Window-System\"><a href=\"#X-Window-System\" class=\"headerlink\" title=\"X Window System\"></a>X Window System</h3><ul>\n<li>增强级：Unity（Gnome）等</li>\n<li>常量级：Gnome（GTK），KDE（Qt）等</li>\n<li>轻量级：XFCE（GTK），LXDE（GTK），LXQt（Qt）等</li>\n<li>超轻量级：iceWM（层叠式），i3WM（平铺式），X.Org Server（层叠式）等</li>\n</ul>\n<h3 id=\"Wayland\"><a href=\"#Wayland\" class=\"headerlink\" title=\"Wayland\"></a>Wayland</h3><ul>\n<li>增强级：Unity（Gnome）等</li>\n<li>常量级：Gnome（GTK），KDE（Qt，正在适配）等</li>\n<li>轻量级：Weston（层叠式），XFCE（GTK，已有适配计划），LXQt（Qt，已有适配计划）等</li>\n<li>超轻量级：SwayWM（平铺式）等</li>\n</ul>\n","content_text":"Linux 桌面环境 两种常见 Display Server： X Window System：历史久导致兼容性好，但设计思路老旧，性能问题开始有所体现。官方实现：X.Org Server。 Wayland：更简单的现代化窗口系统。比 X Window System 更高效，但兼容性仍不够好。正逐步替代 X Window System。官方实现：Weston。 X Window System 增强级：Unity（Gnome）等 常量级：Gnome（GTK），KDE（Qt）等 轻量级：XFCE（GTK），LXDE（GTK），LXQt（Qt）等 超轻量级：iceWM（层叠式），i3WM（平铺式），X.Org Server（层叠式）等 Wayland 增强级：Unity（Gnome）等 常量级：Gnome（GTK），KDE（Qt，正在适配）等 轻量级：Weston（层叠式），XFCE（GTK，已有适配计划），LXQt（Qt，已有适配计划）等 超轻量级：SwayWM（平铺式）等","summary":"Linux 桌面环境 两种常见 Display Server： X Window System：历史久导致兼容性好，但设计思路老旧，性能问题开始有所体现。官方实现：X.Org Server。 Wayland：更简单的现代化窗口系统。比 X Window System 更高效，但兼容性仍不够好。正逐步替代 X Window System。官方实现：Weston。 X Window System 增强级：Unity（Gnome）等 常量级：Gnome（GTK），KDE（Qt）等 轻量级：XFCE（GTK），LXDE（GTK），LXQt（Qt）等 超轻量级：iceWM（层叠式），i3WM（平铺式），X.Org Server（层叠式）等 Wayland 增强级：Unity（Gnome）等 常量级：Gnome（GTK），KDE（Qt，正在适配）等 轻量级：Weston（层叠式），XFCE（GTK，已有适配计划），LXQt（Qt，已有适配计划）等 超轻量级：SwayWM（平铺式）等","date_published":"2021-12-13T17:00:00.000Z","tags":["自由探索","笔记","小tricks"]},{"id":"https://www.zhouweitong.site/post/005-ripping-training-basics-1/","url":"https://www.zhouweitong.site/post/005-ripping-training-basics-1/","title":"【WIP】压制技术 B：从不熟悉的编码开始","content_html":"<link rel=\"stylesheet\" type=\"text&#x2F;css\" href=\"https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.5.1/katex.min.css\"><link rel=\"stylesheet\" type=\"text&#x2F;css\" href=\"https://cdn.jsdelivr.net/npm/hexo-tag-hint@0.3.1/dist/hexo-tag-hint.min.css\"><p>文章摘录和润色于本人的笔记，难免有错漏之处。若您发现了其中的一处或几处，请在评论处指正，我将不胜感激。</p>\n<h2 id=\"什么是压制？\"><a href=\"# 什么是压制？\" class=\"headerlink\" title=\"什么是压制？\"></a>什么是压制？</h2><h3 id=\"压制的对象\"><a href=\"# 压制的对象\" class=\"headerlink\" title=\"压制的对象\"></a>压制的对象 </h3><p> 可以是一切种类的音频、视频、图像，比如说：</p>\n<ul>\n<li>蓝光光盘（BD）中的视频或音频（m2ts 等格式比较多见）</li>\n<li>DVD 光盘中的视频或音频（dat 等格式比较多见）</li>\n<li>CD 光碟中的视频或音频</li>\n<li>通过 Web 下载的各流媒体网站的视频或音频</li>\n<li>各种剪辑软件、合成软件、特效软件、DAW 等渲染的视频或音频</li>\n<li>图片（或者动态图片）转换为视频，例如“一图流 MV”等</li>\n</ul>\n<p><em>注意：要区分压制（Rip）和混流（Mix）。</em></p>\n<p>压制是进行编码，或在编码间转换的过程。</p>\n<p>混流是将特定编码的视频轨 / 音频轨放入容器，或在容器间转换的过程。</p>\n<p><em>注意：要区分编码（Encoding）和容器（Container）。</em></p>\n<p>举例说明如下：</p>\n<ul>\n<li><code>H.264</code> 是一种视频编码，<code>aac </code>是一种音频编码。</li>\n<li><code>mp4 </code>是一种视频容器，<code>wav </code>是一种音频容器。</li>\n<li><code>avi</code> 既是一种视频编码也是一种视频容器。</li>\n<li><code>mp3</code> 既是一种音频编码也是一种音频容器。</li>\n</ul>\n<h3 id=\"压制的目标\"><a href=\"# 压制的目标\" class=\"headerlink\" title=\"压制的目标\"></a>压制的目标 </h3><p> 对视频、音频等的压制，不全面地、概括地来说，有以下几点主要目标：</p>\n<ul>\n<li><strong>使音频 / 视频的编码符合要求。</strong>例如符合视频网站点播视频的要求、直播网站直播串流的要求、流水线中剪辑代理的要求等。</li>\n<li><strong>使音频 / 视频的数据总量（可以理解为音频 / 视频的体积）或音频 / 视频在单位时间内的数据量（可以理解为音频 / 视频的码率）符合要求。</strong>例如符合蓝光光盘的码率要求、窄带（依照 2010 年新的标准为 4Mbps 以下）情况下视频点播的要求等。</li>\n<li><strong>尽可能地保留音频 / 视频中的有效信息。</strong>可以理解为视频画面中物体的轮廓、音频的频段细节等。</li>\n<li><strong>去除或降低音频 / 视频中的干扰信息。</strong>可以理解为视频画面中的噪点、音频中的杂音等。</li>\n</ul>\n<span id=\"more\"></span>\n\n<blockquote>\n<p>题外话：什么是“观感”？</p>\n</blockquote>\n<p>“观感”与“听感”一样，是一种主观的质量评价标准，可以简单地认为是有效信息占比与干扰信息占比（信噪比）的一种综合量度。目前已有诸如 <code>VMAF</code> 等工具辅助人眼进行视频质量的主观评价，在此不再展开。</p>\n<p>对于动漫而言，由于画面的特殊性（明确的线条、规律的颜色和色块、较低的运动帧数等），通过压制可以 <strong> 保持 </strong> 甚至 <strong> 有效提升 </strong> 动漫的观感。</p>\n","content_text":"文章摘录和润色于本人的笔记，难免有错漏之处。若您发现了其中的一处或几处，请在评论处指正，我将不胜感激。 什么是压制？压制的对象 可以是一切种类的音频、视频、图像，比如说： 蓝光光盘（BD）中的视频或音频（m2ts 等格式比较多见） DVD 光盘中的视频或音频（dat 等格式比较多见） CD 光碟中的视频或音频 通过 Web 下载的各流媒体网站的视频或音频 各种剪辑软件、合成软件、特效软件、DAW 等渲染的视频或音频 图片（或者动态图片）转换为视频，例如“一图流 MV”等 注意：要区分压制（Rip）和混流（Mix）。 压制是进行编码，或在编码间转换的过程。 混流是将特定编码的视频轨 / 音频轨放入容器，或在容器间转换的过程。 注意：要区分编码（Encoding）和容器（Container）。 举例说明如下： H.264 是一种视频编码，aac 是一种音频编码。 mp4 是一种视频容器，wav 是一种音频容器。 avi 既是一种视频编码也是一种视频容器。 mp3 既是一种音频编码也是一种音频容器。 压制的目标 对视频、音频等的压制，不全面地、概括地来说，有以下几点主要目标： 使音频 / 视频的编码符合要求。例如符合视频网站点播视频的要求、直播网站直播串流的要求、流水线中剪辑代理的要求等。 使音频 / 视频的数据总量（可以理解为音频 / 视频的体积）或音频 / 视频在单位时间内的数据量（可以理解为音频 / 视频的码率）符合要求。例如符合蓝光光盘的码率要求、窄带（依照 2010 年新的标准为 4Mbps 以下）情况下视频点播的要求等。 尽可能地保留音频 / 视频中的有效信息。可以理解为视频画面中物体的轮廓、音频的频段细节等。 去除或降低音频 / 视频中的干扰信息。可以理解为视频画面中的噪点、音频中的杂音等。 题外话：什么是“观感”？ “观感”与“听感”一样，是一种主观的质量评价标准，可以简单地认为是有效信息占比与干扰信息占比（信噪比）的一种综合量度。目前已有诸如 VMAF 等工具辅助人眼进行视频质量的主观评价，在此不再展开。 对于动漫而言，由于画面的特殊性（明确的线条、规律的颜色和色块、较低的运动帧数等），通过压制可以 保持 甚至 有效提升 动漫的观感。","summary":"文章摘录和润色于本人的笔记，难免有错漏之处。若您发现了其中的一处或几处，请在评论处指正，我将不胜感激。 什么是压制？压制的对象可以是一切种类的音频、视频、图像，比如说： 蓝光光盘（BD）中的视频或音频（m2ts 等格式比较多见） DVD 光盘中的视频或音频（dat 等格式比较多见） CD 光碟中的视频或音频 通过 Web 下载的各流媒体网站的视频或音频 各种剪辑软件、合成软件、特效软件、DAW 等渲染的视频或音频 图片（或者动态图片）转换为视频，例如“一图流 MV”等 注意：要区分压制（Rip）和混流（Mix）。 压制是进行编码，或在编码间转换的过程。 混流是将特定编码的视频轨/音频轨放入容器，或在容器间转换的过程。 注意：要区分编码（Encoding）和容器（Container）。 举例说明如下： H.264 是一种视频编码，aac 是一种音频编码。 mp4 是一种视频容器，wav 是一种音频容器。 avi 既是一种视频编码也是一种视频容器。 mp3 既是一种音频编码也是一种音频容器。 压制的目标对视频、音频等的压制，不全面地、概括地来说，有以下几点主要目标： 使音频/视频的编码符合要求。例如符合视频网站点播视频的要求、直播网站直播串流的要求、流水线中剪辑代理的要求等。 使音频/视频的数据总量（可以理解为音频/视频的体积）或音频/视频在单位时间内的数据量（可以理解为音频/视频的码率）符合要求。例如符合蓝光光盘的码率要求、窄带（依照2010年新的标准为4Mbps以下）情况下视频点播的要求等。 尽可能地保留音频/视频中的有效信息。可以理解为视频画面中物体的轮廓、音频的频段细节等。 去除或降低音频/视频中的干扰信息。可以理解为视频画面中的噪点、音频中的杂音等。","date_published":"2021-12-13T15:00:00.000Z","tags":["媒体技术","压制技术","笔记","WIP"]},{"id":"https://www.zhouweitong.site/post/019-hexo-new-things/","url":"https://www.zhouweitong.site/post/019-hexo-new-things/","title":"Hexo 新姿势！","content_html":"<link rel=\"stylesheet\" type=\"text&#x2F;css\" href=\"https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.5.1/katex.min.css\"><link rel=\"stylesheet\" type=\"text&#x2F;css\" href=\"https://cdn.jsdelivr.net/npm/hexo-tag-hint@0.3.1/dist/hexo-tag-hint.min.css\"><p>图源：《三色Δ绘恋》第 8 幕 烟花大会</p>\n<p>Hexo 的插件真是个好东西！一开始部署博客的时候并没有太在意插件的问题，毕竟觉得博客主题自带的插件挺全面的，足够使用了。但是用久了总是会腻，就想着静态博客能不能整一些新操作，即使只是添加点小功能。于是就翻了翻 Hexo 的插件目录，挑了些比较有用的插件，拿出来做个总结，同时也是为了方便以后使用做的一个简单记录。</p>\n<h2 id=\"管理员界面\"><a href=\"# 管理员界面\" class=\"headerlink\" title=\"管理员界面\"></a>管理员界面 </h2><p> 插件是 <code>hexo-admin</code>，效果是一个类似 CodiMD 编辑页面的“管理控制台”，可以实时编辑预览 Markdown 文章，修改 tag，从剪贴板粘贴图片到文章等操作。注意：仅用于<code>hexo s</code> 状态下的博客实例。</p>\n<h2 id=\"文章加密\"><a href=\"# 文章加密\" class=\"headerlink\" title=\"文章加密\"></a>文章加密 </h2><p> 插件是<code>hexo-blog-encrypt</code>，使用前须在站点配置文件加入以下内容：</p>\n<figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">encrypt:</span></span><br><span class=\"line\">    <span class=\"attr\">enable:</span> <span class=\"literal\">true</span></span><br></pre></td></tr></table></figure>\n\n<p>随后在文章的开头部分加入 <code>password:</code> 字段设置密码即可。</p>\n<p>同时，配合 <code>abstract:</code> 字段和 <code>message:</code> 字段可以设置对无密码人的提示信息。同时注意不要设置 toc。</p>\n<h2 id=\"中英文自动空格\"><a href=\"# 中英文自动空格\" class=\"headerlink\" title=\"中英文自动空格\"></a>中英文自动空格 </h2><p> 插件为 <code>hexo-filter-auto-spacing</code>，<code>npm install --save</code> 之后就可以用，无需手动设置。</p>\n<h2 id=\"插入行内 JS-CSS- 图片\"><a href=\"# 插入行内 JS-CSS- 图片\" class=\"headerlink\" title=\"插入行内 JS/CSS/ 图片\"></a>插入行内 JS/CSS/ 图片 </h2><p> 插件为<code>hexo-filter-inline-assets</code>。</p>\n<p>站点设置：</p>\n<figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">inline_assets:</span></span><br><span class=\"line\">    <span class=\"attr\">enabled:</span> <span class=\"literal\">true</span></span><br><span class=\"line\">    <span class=\"attr\">limit:</span> <span class=\"number\">100000</span></span><br></pre></td></tr></table></figure>\n\n<p>随后引入：</p>\n<figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">link</span> <span class=\"attr\">rel</span>=<span class=\"string\">&quot;stylesheet&quot;</span> <span class=\"attr\">href</span>=<span class=\"string\">&quot;css/main.css?__inline=true&quot;</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">script</span> <span class=\"attr\">src</span>=<span class=\"string\">&quot;myscript.js?__inline=true&quot;</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<span id=\"more\"></span>\n\n<h2 id=\"插入 -ASCIInema- 终端短视频\"><a href=\"# 插入 -ASCIInema- 终端短视频\" class=\"headerlink\" title=\"插入 ASCIInema 终端短视频\"></a>插入 ASCIInema 终端短视频 </h2><p> 插件为 <code>hexo-filter-asciinema</code>，作用是允许向博客文章内插入<a href=\"https://asciinema.org/\">ASCIInema</a> 平台的视频。</p>\n<p>站点设置：</p>\n<figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">asciinema:</span></span><br><span class=\"line\">    <span class=\"attr\">enable:</span> <span class=\"literal\">true</span></span><br></pre></td></tr></table></figure>\n\n<p>随后演示机安装 asciinema，<code>sudo apt install asciinema</code>，并对 asciinema 进行授权，<code>asciinema auth</code>。浏览器打开程序给出的链接，登入账号、查收验证邮件，即可成功启用。使用 <code>asciinema rec</code> 开始录制。由于该网站被墙，因此可以在录制结束后按 <code>&lt;Ctrl+C&gt;</code> 保存至本地，并在本地引用。</p>\n<p>实例：<link rel=\"stylesheet\" type=\"text/css\" href=\"/assets/asciinema-player.css\" /><script src=\"/assets/asciinema-player.js\"></script><asciinema-player src=\"./tmplqth0fkw-ascii.cast\"></asciinema-player></p>\n<h2 id=\"快速上标\"><a href=\"# 快速上标\" class=\"headerlink\" title=\"快速上标\"></a>快速上标 </h2><p> 插件为<code>hexo-filter-sup</code>，站点设置：</p>\n<figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">sup:</span></span><br><span class=\"line\">    <span class=\"attr\">markup:</span> <span class=\"string\">&#x27;^&#x27;</span></span><br></pre></td></tr></table></figure>\n\n<p>实例：x^2^+5=10</p>\n<h2 id=\"文本提示\"><a href=\"# 文本提示\" class=\"headerlink\" title=\"文本提示\"></a>文本提示 </h2><p> 插件为<code>hexo-tag-hint</code>，实例：大家好，这个博客用了<span class=\"hint--info hint--rounded hint--top\" data-hint=\"一个静态博客框架\" ontouchstart>Hexo</span>。</p>\n<p>注意字符串中有单引号的时候加反斜线转义。</p>\n<h2 id=\"H5 视频\"><a href=\"#H5 视频\" class=\"headerlink\" title=\"H5 视频\"></a>H5 视频 </h2><p> 插件为<code>hexo-tag-html5video</code>，实例：</p>\n<video width='100%' height='250px' controls><source src='/post/019-hexo-new-things/2.5_CG_Live_01_mux.mp4' type=video/mp4> Your browser does not support the webm tag.</video>\n\n<p>第一行三个参数必须带上，不然默认<code>video/webm</code>。</p>\n<h2 id=\"统一 ID\"><a href=\"# 统一 ID\" class=\"headerlink\" title=\"统一 ID\"></a>统一 ID</h2><p>插件为<code>hexo-uuid</code>，作用是给每一个页面自动生成一个 UUID 字段。你可以拿这个字段做些别的事情，比如将其设置为博文链接什么的。</p>\n<h2 id=\"二维码\"><a href=\"# 二维码\" class=\"headerlink\" title=\"二维码\"></a>二维码 </h2><p> 插件为<code>hexo-tag-qrcode</code>，实例：</p>\n<img src=\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAH0AAAB9CAAAAACq6zP5AAABKElEQVR42u3auxLDIAxEUf7/p0nnCuRdmUnBXqpMHjp4xgFJZoz3MZ+xfW8uxjgz0G/V527Ueh1PiIwer9cR6ljbudWR0dHf9Xr1RUf/g776H6CjO3q9v9e7+jYZOJRdoF+oC7VG89WhSgr9Ln2KQ5hbIyh6pq7Ww/WGrqaby6+gx+lqt6bu2whl9DIeerD+pQHYTBWGlRKg36qrWV8dUG0yoifrfu+lubXvLxM9Uxcmo2aafuGNHqpbj3i79/L2y+jBunCwpe5Hqwu0sr+jJ+nC75pVzX7S6HG61U722zgvH6Bn6lZxYS3Bh54Qot+qW3e6f7DZyyrRk/TPJw66NQ86utts9k8yo6P3dHWRVZZb9GBdLZTryQiXhI7u7MxCQ+fLyQT0EP0HKVolV1ZRM98AAAAASUVORK5CYII=\" alt=\"\"title=\" 扫扫看！\"class=\" 扫我 \">\n\n<h2 id=\"下拉抽屉\"><a href=\"# 下拉抽屉\" class=\"headerlink\" title=\"下拉抽屉\"></a>下拉抽屉 </h2><p> 插件为<code>hexo-tag-details</code>，实例：</p>\n<details><summary>怎样才能订阅你博客的更新？</summary><p>订阅 RSS 啊！</p>\n</details>\n\n<h2 id=\"SoundCloud\"><a href=\"#SoundCloud\" class=\"headerlink\" title=\"SoundCloud\"></a>SoundCloud</h2><p>插件为<code>hexo-tag-soundcloud</code>，实例：</p>\n<div class=\"soundcloud-wrapper\"><iframe width=\"100%\" height=\"450\" scrolling=\"no\" frameborder=\"no\" src=\"https://w.soundcloud.com/player/?url=https%3A%2F%2Fsoundcloud.com%2Fkawaii-music-192471320%2Fost-weathering-with-you-theme-song-grand-escape-radwimps-feattoko-miura&amp;auto_play=false&amp;hide_related=true&amp;show_comments=true&amp;show_user=true&amp;show_reposts=false&amp;visual=true\"></iframe></div>\n\n<p>当然，不加链接加 Track ID 也是可以的。</p>\n<h2 id=\"脚注\"><a href=\"# 脚注\" class=\"headerlink\" title=\"脚注\"></a>脚注 </h2><p> 插件为<code>hexo-footnotes</code>，实例：我真的喜欢读《三体》<sup id=\"fnref:1\"><a href=\"#fn:1\" rel=\"footnote\">1</a></sup></p>\n<p>支持多行注释和 Markdown 注释。</p>\n<h2 id=\"PDF- 文件\"><a href=\"#PDF- 文件\" class=\"headerlink\" title=\"PDF 文件\"></a>PDF 文件 </h2><p> 插件为<code>hexo-pdf</code>，实例：（Modeling Singing F0 With Neural Network Driven Transition-Sustain Models - By Kanru Hua）</p>\n\n\n\t<div class=\"row\">\n    <embed src=\"./Modeling-Singing-F0-With-Neural-Network-Driven-Transition-Sustain-Models.pdf\" width=\"100%\" height=\"550\" type=\"application/pdf\">\n\t</div>\n\n\n\n\n<h2 id=\"MPlayer\"><a href=\"#MPlayer\" class=\"headerlink\" title=\"MPlayer\"></a>MPlayer</h2><p>插入本地 MP3 文件。插件为<code>hexo-tag-mplayer</code>，实例：</p>\n<div id=\"mplayer5403\"></div>\r\n<script src=\"https://cdn.jsdelivr.net/gh/MoePlayer/cPlayer/dist/cplayer.js\"></script>\r\n<script>\r\n    new cplayer({element: document.getElementById('mplayer5403'),\r\n      playlist: [\n    {\n        name: 'm_sys_title_intro',\n        artist: 'Arknights',\n        src: './m_sys_title_intro.mp3'\n    },\n    {},],\nautoplay: false,\nvolume: 0.75,\nplaymode: \"listloop\",\nbig: false,\ndark: false\r\n    })\r\n</script>\n\n<h2 id=\"已弃用\"><a href=\"# 已弃用\" class=\"headerlink\" title=\"已弃用\"></a>已弃用 </h2><h3 id=\"文字上标\"><a href=\"# 文字上标\" class=\"headerlink\" title=\"文字上标\"></a> 文字上标 </h3><p> 插件是<code>hexo-ruby-character</code>，需要在 Linux 环境下编译 npm 包。</p>\n<p>示例：<code>&#123;% ruby Chocolate | Vanilla %&#125;</code> ，也可方便的给汉字注音，例如：<code>&#123;% ruby 鬼魅魍魉 | 鬼魅魍魉 %&#125;</code>，又或者是恶搞，类似： <code>&#123;% ruby 精彩节目 | 前方高能 %&#125;</code>，同时也适用于其他语言，譬如：<code>&#123;% ruby 噓 | うそ %&#125; だの？</code></p>\n<p>由于其依赖包 nodejieba 兼容性问题，此处不再提供演示。</p>\n<h3 id=\"HTML- 标签\"><a href=\"#HTML- 标签\" class=\"headerlink\" title=\"HTML 标签\"></a>HTML 标签 </h3><p> 插件为<code>hexo-tag-htmltag</code>，使用：</p>\n<figure class=\"highlight markdown\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;% htmlTag button type=&quot;button&quot; data-submit data-action=&quot;add&quot; aria-controls=&quot;calc&quot;%&#125;</span><br><span class=\"line\">Add 10</span><br><span class=\"line\">&#123;% endhtmlTag %&#125;</span><br></pre></td></tr></table></figure>\n\n<p>等效 HTML 代码：</p>\n<figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">button</span> <span class=\"attr\">type</span>=<span class=\"string\">&quot;button&quot;</span> <span class=\"attr\">data-submit</span> <span class=\"attr\">data-action</span>=<span class=\"string\">&quot;add&quot;</span> <span class=\"attr\">aria-controls</span>=<span class=\"string\">&quot;calc&quot;</span>&gt;</span>Add 10<span class=\"tag\">&lt;/<span class=\"name\">button</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<p>由于作者已将该 npm 包删除，因此演示失效。<div id=\"footnotes\"><hr><div id=\"footnotelist\"><ol style=\"list-style:none; padding-left: 0;\"><li id=\"fn:1\"><span style=\"display: inline-block; vertical-align: top; padding-right: 10px;\">1.</span><span style=\"display: inline-block; vertical-align: top;\">作者为 刘慈欣。</span><a href=\"#fnref:1\" rev=\"footnote\"> ↩</a></li></ol></div></div></p>\n","content_text":"图源：《三色Δ绘恋》第 8 幕 烟花大会 Hexo 的插件真是个好东西！一开始部署博客的时候并没有太在意插件的问题，毕竟觉得博客主题自带的插件挺全面的，足够使用了。但是用久了总是会腻，就想着静态博客能不能整一些新操作，即使只是添加点小功能。于是就翻了翻 Hexo 的插件目录，挑了些比较有用的插件，拿出来做个总结，同时也是为了方便以后使用做的一个简单记录。 管理员界面 插件是 hexo-admin，效果是一个类似 CodiMD 编辑页面的“管理控制台”，可以实时编辑预览 Markdown 文章，修改 tag，从剪贴板粘贴图片到文章等操作。注意：仅用于hexo s 状态下的博客实例。 文章加密 插件是hexo-blog-encrypt，使用前须在站点配置文件加入以下内容： 12encrypt: enable: true 随后在文章的开头部分加入 password: 字段设置密码即可。 同时，配合 abstract: 字段和 message: 字段可以设置对无密码人的提示信息。同时注意不要设置 toc。 中英文自动空格 插件为 hexo-filter-auto-spacing，npm install --save 之后就可以用，无需手动设置。 插入行内 JS/CSS/ 图片 插件为hexo-filter-inline-assets。 站点设置： 123inline_assets: enabled: true limit: 100000 随后引入： 12&lt;link rel=&quot;stylesheet&quot; href=&quot;css/main.css?__inline=true&quot;&gt;&lt;script src=&quot;myscript.js?__inline=true&quot;&gt;&lt;/script&gt; 插入 ASCIInema 终端短视频 插件为 hexo-filter-asciinema，作用是允许向博客文章内插入ASCIInema 平台的视频。 站点设置： 12asciinema: enable: true 随后演示机安装 asciinema，sudo apt install asciinema，并对 asciinema 进行授权，asciinema auth。浏览器打开程序给出的链接，登入账号、查收验证邮件，即可成功启用。使用 asciinema rec 开始录制。由于该网站被墙，因此可以在录制结束后按 &lt;Ctrl+C&gt; 保存至本地，并在本地引用。 实例： 快速上标 插件为hexo-filter-sup，站点设置： 12sup: markup: &#x27;^&#x27; 实例：x^2^+5=10 文本提示 插件为hexo-tag-hint，实例：大家好，这个博客用了Hexo。 注意字符串中有单引号的时候加反斜线转义。 H5 视频 插件为hexo-tag-html5video，实例： Your browser does not support the webm tag. 第一行三个参数必须带上，不然默认video/webm。 统一 ID插件为hexo-uuid，作用是给每一个页面自动生成一个 UUID 字段。你可以拿这个字段做些别的事情，比如将其设置为博文链接什么的。 二维码 插件为hexo-tag-qrcode，实例： 下拉抽屉 插件为hexo-tag-details，实例： 怎样才能订阅你博客的更新？订阅 RSS 啊！ SoundCloud插件为hexo-tag-soundcloud，实例： 当然，不加链接加 Track ID 也是可以的。 脚注 插件为hexo-footnotes，实例：我真的喜欢读《三体》1 支持多行注释和 Markdown 注释。 PDF 文件 插件为hexo-pdf，实例：（Modeling Singing F0 With Neural Network Driven Transition-Sustain Models - By Kanru Hua） MPlayer插入本地 MP3 文件。插件为hexo-tag-mplayer，实例： new cplayer({element: document.getElementById('mplayer5403'), playlist: [ { name: 'm_sys_title_intro', artist: 'Arknights', src: './m_sys_title_intro.mp3' }, {},], autoplay: false, volume: 0.75, playmode: \"listloop\", big: false, dark: false }) 已弃用 文字上标 插件是hexo-ruby-character，需要在 Linux 环境下编译 npm 包。 示例：&#123;% ruby Chocolate | Vanilla %&#125; ，也可方便的给汉字注音，例如：&#123;% ruby 鬼魅魍魉 | 鬼魅魍魉 %&#125;，又或者是恶搞，类似： &#123;% ruby 精彩节目 | 前方高能 %&#125;，同时也适用于其他语言，譬如：&#123;% ruby 噓 | うそ %&#125; だの？ 由于其依赖包 nodejieba 兼容性问题，此处不再提供演示。 HTML 标签 插件为hexo-tag-htmltag，使用： 123&#123;% htmlTag button type=&quot;button&quot; data-submit data-action=&quot;add&quot; aria-controls=&quot;calc&quot;%&#125;Add 10&#123;% endhtmlTag %&#125; 等效 HTML 代码： 1&lt;button type=&quot;button&quot; data-submit data-action=&quot;add&quot; aria-controls=&quot;calc&quot;&gt;Add 10&lt;/button&gt; 由于作者已将该 npm 包删除，因此演示失效。1.作者为 刘慈欣。 ↩","summary":"图源：《三色Δ绘恋》第8幕 烟花大会 Hexo的插件真是个好东西！一开始部署博客的时候并没有太在意插件的问题，毕竟觉得博客主题自带的插件挺全面的，足够使用了。但是用久了总是会腻，就想着静态博客能不能整一些新操作，即使只是添加点小功能。于是就翻了翻 Hexo 的插件目录，挑了些比较有用的插件，拿出来做个总结，同时也是为了方便以后使用做的一个简单记录。 管理员界面插件是hexo-admin，效果是一个类似CodiMD编辑页面的“管理控制台”，可以实时编辑预览Markdown文章，修改tag，从剪贴板粘贴图片到文章等操作。注意：仅用于hexo s状态下的博客实例。 文章加密插件是hexo-blog-encrypt，使用前须在站点配置文件加入以下内容： 12encrypt: enable: true 随后在文章的开头部分加入password:字段设置密码即可。 同时，配合abstract:字段和message:字段可以设置对无密码人的提示信息。同时注意不要设置toc。 中英文自动空格插件为hexo-filter-auto-spacing，npm install --save之后就可以用，无需手动设置。 插入行内JS/CSS/图片插件为hexo-filter-inline-assets。 站点设置： 123inline_assets: enabled: true limit: 100000 随后引入： 12&lt;link rel=&quot;stylesheet&quot; href=&quot;css/main.css?__inline=true&quot;&gt;&lt;script src=&quot;myscript.js?__inline=true&quot;&gt;&lt;/script&gt;","date_published":"2021-12-05T07:35:00.000Z","tags":["自由探索","完成编写","hexo"]},{"id":"https://www.zhouweitong.site/post/032-dcc-soft-download-install/","url":"https://www.zhouweitong.site/post/032-dcc-soft-download-install/","title":"【持续更新】常用 DCC 软件下载安装破解指南","content_html":"<div class=\"hbe hbe-container\" id=\"hexo-blog-encrypt\" data-wpm=\"密码错误\" data-whm=\"OOPS, these decrypted content may changed, but you can still have a look.\">\n  <script id=\"hbeData\" type=\"hbeData\" data-hmacdigest=\"a881a391099ef21db818e5e03a7443b19f87956eecfc09115e7de9ceb295c830\">4e2911acdcf2c866c0098ba70a60c31e6102836718a2e88cdc489db43dd8819cffadcd8890bfced0745c331957305bcaf81532a8b35860a519a5e9d94ca4fc4d8c7b58d71dc88ebf7871833c2b007f458145f1db367e0007476db073730e6cd70d0db9a7cba956d43e865ab4f9065fe41824a85e090d5ad0890e662c2ff1e2c6f95f072d511438d0cd1dc994e5c7dfc768615d03fc4470238db2769d6acae83623a231afcbffc3da5bb5e728463ed3b9f667e92b5ec5be99a525e539d5ccbf603908137edf4a083770dc8aa0ca4117ea2ef5fa559356fad204021794b424872e799d4ca52397e2cacc7689a58c242da7457feefdc40994c49ca4dc94cd0392631e8cd0d6c5fa29adc04e6506c5275d1ec82f6720ee561c4dced80cc7a19a6fd0d0bda5be0ba1d391b8db617e5af061ab6afa9e3e7be82db4568d354fb57a4505a9b1d471381c9be5d8056d1a84bb92a5797fbf2314af272937495e29f9c3a324ce01c16b710fe76cc1b257bac19ffb4c18c55d0307271ccd8230aef2f91b8086e89d86b70e9617b739ec034736c954915d28ab213fcdcf71d2ae77c9345773595dc382e06474515b5b110390ea9b039e4eafb5ddd212adefb763e3796ce6f117b5931779b0d007de54e981de4cf6a09d60145f83588aa37b5ddec5f18c09b2141c3126581efd0906d6e1a67dc181791dc9be517803b586f469e4777703971af00373e573b2ec3513632fff0c87b475cda7e362d4ebc713a3aaf84d21649c4082c361df42826a76f67ae61016231ab4c5564b2456a445f78bd45c9fb7824199301eb71f2ef59403a88db2ddb4e0a0df2d613ca33e131636c09b583c67c32eccacd7b19443fb428dbc70524efef7287fa54f49df2f54996f7a82480f94843419fb88ac4225058288135ecf12ef31f4ce7f7242609c036d14c0ef097353e8c112e30e407d40786c145523ce63cda2da6edd6716a01196d82eab82568a3ccd984cd54adf81116256a22317a0aef247eaa1f3a171c112ddb8fe823547ba5ad5a9c8c3dccaa900e42b785c8ed0e54569e0288c702e4b826ab400fa564edc2aebd62dfecb39e5d2d4bef0fda63ca9c76101625839d8b0fc7b8e7b38d0e87b38eb3874e623aee75dbb1533e04561b49bd415aa2bff45c4977e606d5c74a1b88781304eef819e4697e56edc9e21c5df4730386bfed213befae3c0a24027adb4f9b1a93bc323e524ec6fece8fc3e2e02368cf8b9d15980b443b477fd42cdfe048df892e513b8234273861b4da3c7ccac23e9eb2a11a58f9e6dda171d8b917b521e6c8f61c2fae3af4a227cbaf1a8315725200b997f2f65616a5a56364b47bb49d9bce622e42f5fb442a0dd0baf0c4bbb8acb3ef8207d0e53cb43b967f505d159ed74451546276b0638fa199a2dd60bbcbb02e8f8773198b9caf98fa218308b6ae3d7392db64860b2530d10b984fa67cb6b7d02f0ebf6bdb40b0739b2aa883080634bf6aebfb104adca1635bd764b850ade127859a143ccd5dbe41dcb970a02c544dd6b4fa2ae9151ddc272ba1cca12ab702ddce8578250a3d392d717cf5c669c449f9a1a8789a3b78af3930d3db91ec2148132a77391639f2b4dce828e8645b45db7e2ceda59afcd6db75576da7bd1d30539099b2e69e83b03560700c853ae78323f04dacbd16b1d8c3aa099f68c01042c1aec59ef0e903800bc41e729ef8c260829f028af657b651556e74fc74eed558fb43f818f6ff515d134c184a387701c95c5228b6aff205a7f3bbdd1ec970985ab5bd797d0774e07af866c54c6502c01165ae116d864348182456288b1879fe419d58ad25dea82ebd10195547e3f7cab24838080ae921cd0af8197961026131f3e8d753631259f338659b9585b078e0c64b2bc3df96c5a9218f9a991a6ad07d517477783e45d4cfe6a4853c3bc8b4edc38af8587151921da9f1cb3d3b3b0fb196019894febe481a8f376bdff27cdc50d2e0bd77efe348aaf07f8818cafdeca29b248407e813c4c3d1bbd115a9eb6fc78219c39daddf85f4eaf6299fbdb9e6d8e606b5fbbb7770a537054ec59dcacb216726bb5c102b0eada719f97434429f9844b758410278b39f97f7c647e0621b78ceb54350a6d2a009df85e1834df4b49cb12be44e46ea5ef0c543e17690b285bec0b9578379b09fcfe6bf76f287ef01e4931175fd84c7e6182eff3afbc5feb4240982633bab273d0a45eac4c2802c6ffc30fac35e4635c2cdb0a2f341e1c8dbd25fbee591759e33fbcf932c45f395c03e19e26caee8480dbfaf168f03fea97bab2c0543df78333532d39933f05a32bb865bdfd156c9f67ab46eb016591b262a990055be677622d17afce08ad32b1000bf27e1c6f24085ff2d668006134f8ffcc0e39174a530ce1496a75423dc442fd2f2fde0a2c7c666cac3077178de919bbc621c418339f82b0a1a39b47c986e5e97c5939bedd73e992bbb1a49ff1c288f15cdeec2cc3e10abdee87da61447a8d3cc7d3a324ac8e4323cb65afb7203ebcd97e6376a944084be0038cf3ad20699a7871116d1eff91b1c2fb283989a4e2c3f94da377170cebe443cb149d99e7eaa8225f39aba5b3385c1675670e88f64251393bde30749290590b881d309f6e33a1208e5627141bde670972deb62cac14e3200a0dabd98c9796bbc74ef4ef77c6202086ee3f58e4ea651fd027a2f5828822f95a859ca17de9bf2d7fb999d44ece312ba3e7733c295c7795b81621c9e5a9d1d7fc3cd1864abc733288cb16877f403655e5c838d619ffe1d1cf731b38ee297d8758789802c5e2112f224d6a6322f007e40adbc75b86eb198753c9080f8ae9eb5b03d393bc0566f2fdd3399342ad81b59719729673134b0062732a8243e45d643eb41ab5794e885082c4d6feb5c1db51e3f5afcae1cae40e17d955dbe3463f11e7072d62d3c38c5c09f250184e7fbe9fa17605ad0b71cac60a8ea188353d4d776fc3a005112ca376e37bff56e843b29d9490106b0f52ff66b940af88188646f51b218d4bcebb051c61ca693ac775c9ea36f8786577178ddafd1c186c04920fa6125b29fb0849f0c12324bf04ed19943e8825485138b0e6692b98120654b1a1326f154d30efb12a2a3b5216a2345210242964b5b6efed948656c1c0563fe2087b5cb8b01ef0d8627b776d4c15cdab683f6132eb833447638e9b868136eab40e5a48cf11085dbd4153c89f76848e8bb96089096dd805fe1561641090e8cf5ce5ed7dc4f38c210558f43203d1e4c77a088380b54931b5b04c1e2875b5efccc358e78ca35b8a6527a07913ee74bbd25b885e5304085f61e4560acdfccd165acdd1f31cd87ea2febd69fec0fdf62ed7d715e9f89b1a8e1c8633d99b0aeb29993fd89484103137272c330cbb0c33ba26db6257a44cc0be33f287ad1f69832d3b8ae2dcbef7d7ded184c05f9ebf9bb58115cf1000ff2b6ced4f4cd352b530eb69de70ec7cd765281c361887fc2c5795e4a2c5d76bf63dee46d8159a0c3c9c8452466f60c25bf5e769f9282f56056cafb61a737807282081b553a43a31b8cdbf3f368bf5e8a25c50204e081afbfb93f1377c10b9f575f11f3fd83b743f9a41d9b72d72f1bd2ceacb8b89cfef73d8bb64cad4ac6ed84ba49a84ad81aa024d38f01b89689cf967b6b8fd4e80d05ce657ee38ee795fc931e9b9599e63fb2fb78833a8c1a8e1da3b06f4d1ff461d52b2a35ce15b490c0818a01cc4c849f8f1cc52361ba20b023a116b8a50f9ccfa86f1b331877da00b44515149576ede47f7dc4defaebe9ccc6be5d9381210bccf188a0f62b5737a6f969317d3c06c3b8ee7ec1daf7c24146dbdc3e80e019d030788c07e9cf2ac3497ac100ce7d9aafe81cb4df1be35711afd98d863f226e0ef84f13a9c87aabb687694c7c3d434716183d4e9c2508010c931a2e5b6af0cf5e5ddb5c82abf306f41ca24cc6f6a6504c9f11b060a6841a43204ab434f8c3a56c1b351cee41e07dcf39620b1a4e015ae64f8c5216f685c735d5002187ec4fec624da379be18ea9b92928546b940be4c31f3b6137fc391526c319e5d12363738e0f5339878851247923c89eb9aa0b98ee128ce7f38dd20e84ff622cc358aa899b0f81074122446b8284aaf900566ad96e7c2c78fcd2dc4469039c06bef1342b5b12395e2279a851f241fee8e717f718b209bcfd93138917562a9fdcca097d1ef9e41b8215f1732b9393a67175667110113ac9732b169b3e6e617ade9210faab3f20a9215e92ab93681ff443bfbce739f55c225d5a9a1c9a0b4cb9270e329b88eff7239cf489a7058147a4932512b8133c4a8478630ff4d32564fef7134a098fc7d1b431549f412d98a0881791b9d0a9eb158d82955e77a02447f2b4ea029ba2e2993006be72dbce050773688b6b1197c5c1c8bb59594db63e959a30e6017ccf55a2864c5a819de3b19f59fd7415c8197ff997aa98e20885a86ad83a8710c3b522a2ee9abed9fdf95c55b28b15f959a13acac832fc930a5acbde6b081b980e6c95844270db4ac02aedc8651bf9d81ebbd16f0ac5829532cedeafc6efb6afa2eb06176cc29f4e27e2ba44e80d56504221c3746710dfb0d529a7573f7a56ed438a76ab7311d342af130d04777e0fe3467111999a0406f6087a683c649df42d8725d0fad0755faf5deea89ec0056ae6ffa96e0be4ead79c5a880642271f94919b1c9be8999901a5a7fc660deef7bb2cfdb4d06d103f1ec161442fdd2dc34a9859d50a935a0ce0ac487d74b220c7e3b0bfe808f9eb8f4e3ec783aff81203d6bcd8cba006042cf85f960028916109203793a012cb939c69006d837eb9765a9f4627de930803e683f8f92ef507445c888502aac4f53b3b7118c9f9551c339a647827bdcc3731d27e970971610d13de01eb7302d3fa42f7cc4a2bdb134b17ac66d6d068f6ce51e777b81fc3db082ef7c0a1efb3ef2f7f75825c4ceebef7520cfba5a9619baa640011ca88a8fb9398ac492199e6db2251fada5a72fcd07e61bea99d211fc55046ed2fbd909df05577a2fccfce4bb32d4626693c10a5fb2fc1c3abc326d934cea686db902e73bc53fa6318db9824e6df3e5d9c0890e148ce5869b4a30bbbc767952cfd6e7f194c2245708f9cce4c99dc713d86e0f8ff28d8beb2f84eeec5e7c0f1fc7a843c310980cb328e4d19b17f9c7fa27a9d45b95f16e43aac68258b20c07c990d23e35b83e6bce6843db83f68e0e8ca1b8372d1321daaf3c227f048f55bf649527f905befc5aed8f699609fd3f2926b66cdd108909e1eb35bee6a74742fe9ac20b5e921bcaf5001a4b88ba5c986e9b0fdb3b813da38d8009d232f85fa0ae0f85a244edc7dc32d6160a768f9f45296e459476874c7058bba75481786497267c8a9b833173a3f040bbf7f8674c036488e1f26110f0869bf2d8c2151af10ad50979961e5d46e81a6d14a7b464416a3b9dd41a933725b5817036dc9a9f11e82514e86aa52e778fd4692b7533a80723785ff066bfb829d1a335a07a9725223556860b1434d9b5203aff5f41518b3962d0d27b6889d7a0a5a29f6da9f9da47fd3d7ef0ed9aea628892e091d61be1f3a219f1f34b1258547803fb4ffabfbd15d4c33a5af4f7f49fe78a970d79ee9aa798445693d5056c26d639baa6bf80a664b076694d017032053d2bcbb2af09696e8705f572cb68a64a6be61645abc2eaa7309d589b1d4dee49497bca5549a5100bd9067997bba20bd7f0aa6d9b0e79568547575ba0a0ff4b30e360d1c64ba03108463aea7ec4d784a0489fbd36a35f217546cf36dd7fb579caaaf79c5f2a7af1d3c3a499863bb515d760293c4b9f98b35f4403dfd0b2e73c1b06ec96759bca0d085f18bdf29ae545c74e3ac33488c672b85712ee539512891e0e899e2718b2c4c75be68b49b76449821e7367edfd7824e1706b1384c772f4bc6975e0efe527741684e1bdba18e60ab367647a8669e5c4eeeda281a7e0f0f05fbdbd529cf7775e722602cfd111da377ec551ab63cf6fef503ba762cc8e6268b525ab615795b49007fef82494f13486196bcb80cf39d0cc37b682dfc159db165637d784ebd95e1d49be2acf810138417219190204681c0045979e3db3222d73c6fb16ea69043d584fe4e1f8d65ecd5472ba179911d7a0437ffbcaacc5c815a0538699c284f5a48c7e6d7b87fa4b9222329af0b0e7042d5662295d0c4ebb6de9eb2e15c0f8ee274d0d4b7d323b102181472f50d6f94c71211dc9f7daf4f13cff1f79b8347780026a495b4836e7c081bfab8ca0de4f5dd6cf1548ff45f9c190004eb15566bbd2a333561b180669519b4029ccdf571678201be07b7486ddf65c87842d540843a2aee9aab08dee5766f320c3d836bcbf132caa08380551a154e0c66fc9ced56205f3d8ff9133d34f713829f61494cdbb2e7ec8180e8bae8af5d7f8b21daa57a541b4d1b88bfb0507a606e15b519ca65755b078e6c6d0e3ac2bb522159658977e6b2d31ed6421ba63ef942cb2f97a9a8309f08266e72f2ab63127daba3f05232a8ea2bf0b29b9ac12f534966673833d9b0d50db80d572ee64ca4d9c5c21f3eb31b3a687ad71e5df2d284f1dadec0066e1f80ec1aa848f6c2b451696bdd482b4016dfd8040b1fd65b8a75cbbf1d15bb9c069e726e16486ad268f624908c94b5642bb1e648af353baed32fe8c1d59be33620fbc3da76396b00ca147302006c4684a8af2cf72243c9ed9ac99229d70380d1135c177d288933a12515080f0f1280d6efbcccfc55fec686c6245b1cd69d6984f4a60d15e2e915f703093852d98cb4113e22ae7b81001d904d233c8b2f482352985cf8cb87012bc3473588ed894e4cebf1cc83d6a544e0fa7ad9e31527df7420da9be5e296c235ac8ad24a3df2e18c49da541b82398113d555dc38fac6a8d03d684f983dc0c422bb0a738ba0d450d06cad0307dd531996556ad4bdb51562f2dbba7b2a117be83e8b8dd25dd78ca1c4902d8a436c1268625a3b6ae5ececc8192fcc59a29e629aba8f8d4f363e94312dcaa45b81209dfb75d81202082049c7a042ee880d5ea376dc14102f2619dd7911798221802bf6a9bb0c6d6969af0268cca293bf84522acaf6cad1e31ccf6adca47e21294746f411d38d500e4ff027a6eb0eabf071bf8dc43985254240ac55a98d2b06d54ac78ce31acb120eba4d4f2401305423209353fda382014e7be9a4ffe2e0c3450dacc51bcdbe681c5a49fb8af7cdd2f1de2b43b1780411b79517ea59002bfa95d7b30b80aea39da56fb528b8dbc6594c7caecabe66c02e4897fe7ce3a899349b1d97103f73340cd9a2de384558057986ffb91e216aeab642795810a5d9e1a90a06607c70cbec97620525a4d7521504e2f8f52b711ef747ad662e869c61cf056324f10ae5d7e38abd441837f9ce9391fb3a7d8363832e4490704cdedd8d07a257e18eddb0bc4ec609317c13067e7984b71f4f5549e347ed74703bbcc482393217df4624bf05e4db316296becd32d9b126a09787b25be9c711057512ac95eb71c5d40bcbe9d2b0be951f389194b5fad657324c4dc5bef34c5d7ecd10429ec87d7ccda4c1192615bd6318de5430f9a7833f0d331deeb2ad2880b8d227695cb39fc8f0273508411eb8bede83aa405c1011dea4dbba5259d366b4e3036873e87e05b201c874e6a3976e91b6b96147815d358aaa9d0909ee53cd659cf7b3898a487fe438aea25ed689a7c33a09dda8e2e04ae9ab9e9851da5b387e72953a9614711674dc0fc2064cf5625b0bc4826fd59b109d250d84238689a1e5ba47963d5e2a72f94f5021e4b8638cd5e2bb10d22fce0a06aaa1c402b3172183e656c102f5750068b86048d6485b2ac47ea87fbb761b94540fdf4421f38735d2bba27abc408205f603f31009dbecc6bdcd5c8ab6bd27712190ec1a0c3b4023e03d814c5e8d566b44f3aad640b0b38a13050a5eca46b14f3f19d72d005e91281d1151c4abaa46ab2d7c10366dda215a8401fff5a513e52b87acdae871ceec654a496ed6ea0595645890856ad3cf6da4448e86c61a686e27e653c3630bd99e740aa0bb5ec62216aa763f72dd58138f2c9220e2e684728fdfb34f71bd89fcf4bf4617db47f35576ec7127f1b049c65b02de53413b9426c26d5004d7b7e81b249273f68d5732554dc347b560f1256500644fd343a97a039a7c491cc27253d2e327a6d83f510d570bae6216e207717cce51f5d5f6ecbefdc507ae553eeb0ad812762bee56b840b055e56c0b203ca6a249d7a5d0fc4fea3be1676515a97589e07aadc47af4c167e23e996e4928a18d6f600449386d4079aec1d1f5c43c1a336737baa99d4494b4f50352ddb146acc9cea511579ed800469d320ae9406c6ceba76bdf000fce57ba61b1888836787d1758d1d9ee35cf8ce6f34ee48a450724e663e17d64469fb7639305601464a538cc5d679b06bb2911dda5b8885be5b762a80438e99901ed1f2f86f15789d2ebab9422e818102807cda98fede4941c03e8ed5b9424006415b30abee57d1fbb899e1c78cb75aaa92eee4a6163a69321760c7f830b57952bdb6c707eeb6b6263f25379e346b99c440f54dd964114d98ae5350d41b4e711f882bd967ab9da9445021738342b30f14ef7f162abe670774593847dbca529c6bb7de75ef05bd813687b00e61adbd01b0b564528f945913b8838577ea82f54d40e2db1019484c215be034b930265b9212bf6a0ad416c9363f08e6631f834092edde2622c81d91d1db7b3aa219aaa140669c29543e081ef874d915511d5d8ddfaf6c06627d7704df93339b8a0f367b8830795bea7e3a1828b85b88b336dfb7673910eb9c80eb85a92bbfa2d2b93d2537d9327253a273d83fac25eb3ed9346a6ec4fe18c802bac178161a562585d92adf7ca14b2586a406e2025582a24cb458de7252eb55e5a02ad2033195f0b059ed7a4628f2ddfa92b2dbb99fca4e699fa76a9c3dc7d311da50a248a9947666c69c1d6d7f6c786e082e95247fce190c743f7d4dda9d319055c6f797b1c364155ffd1c4f3a8c719e9f3957170e6077ee4263f18a283996eda953a0b9e1a24dce40e34aeb11ba052be08bd6a6e47113b9d19e864100de836e6107d6a4e4be2267828f17448240c0801b0e2d1fcb0a7428151f3e0dee8d6be464e5684d97d3362786233559681e7bd21198a26f9ca8632bcca9ef546dd9db018998a4ef0f92346e8364fc51f7e717474a026661fbedb8f37f4481025ba2fcd960d574f8b23bcbfac7d118d65cbc12b84aa27be0b2d5c8d4835a0c5addbfd293e6b4ee6c74ac3fd3070db3b456d0f69680acf1280b22ca6869bcc3fa0258d2e7c4c5c41e540f1b1b0e27fec52df49b925604c2ffaa5f4c476fb34c3415919e3a0b8c626d85ad9945658beeb4da0fd3326477b44e24b5841465ea50634996747afc8328e0892677746f8f8980cb8a34f4b048b5e3aa51f045afea4d8a02e0662faf0da04a749a96c297c7ae99d1dfdb471f2bf7975a299efade4c06bf7da22423b3dd56282e31bef1da1f2fe0b73d78537170f51323643f8e449b3cb4f83688dd03542791ef15673453ea4b5cd53566f4223453d67c8ac9f07a444b336db227193de747099f0bb832f4d25167e88d3b69897605297e6024b25018232779cb255955b5388dfbbaa4bb863c0ef33aa7813a61c4cbc45354d87804ad004f5daf31c4c202e805c95de30cc44e37bdc26bc5d92d455059bcb456f569986e14333989ed3ef5997e9b0904f1585b75c28c2b3d1fffd0881364659c2f91368f5ff1950384cc37c9f112852e78d9ee8fa6e950516fcba9a4124b5a786995e80dcfaf54aa11108e7390ad3e9c645744e93bf60005c86beb54099228c0678d5b81f903c9dd120652a9132ce887fab5a0c0bdae08d68e4e577980767a4f2f50ff6c56922a13593f54b35bbe68982c576ebc60642011d59754d48afa5f7b4e7bf60f434c790190cb3c936d77a43fa99e1c36acdd16f5e0050ebb6dd9f2e312f71f56d5d58d2146d3dacf32f4405292d0845ae04a7d81c90ccb7fc4399cc1ea1738ecba79147a3fed4a050feca5fcf2041c19d75a6306948b63ce4cb4edb96af1eb7bb41e21101aaac9540af06e1e1995f9d713ac1355005d79d8bed78471cd2df17ed7a0f3e4d9f2eaa74d5864c6db609a2887126f87a7039dcf50b38da2c2e5c94ef9d728a9787a0e70d8f126e75ca9602ae49752017f7128e24bdae5ed8a6e2ed7c11339bbcab7a8ae1d3e3e82a82f9e7b5b08777cd0daf37418b68a9b0b64d856b94f52cf2a713d490730fa5e56136403348d594d872c5addf59c527aaebe136d22990baf16ec4595e4039377f21c2df18b1cbfc1c2f806ba3a50845784f99205de36409a41b9630dd8e16d624a208aa14eae2cf3a8f412dccbb29ebe303135faa434dffba4b85817638e9c9dc43685020bf0a253dcfeee8a1d4c532522dc4c69ce1491e59f3ad1509e8ec8ccacc192f7481950eb62173d4b77b7d42a6cced3d01a23ccc84ad3dba46f7451652558527a22151bed5c4e3bbd38a9f2c5e8b61ccc5450f4b574f4a2f1307544284aed7ea7761a38327d20eff35eba6cceededcc19c1fe4dd0c0cb04138e2faed728413fc333301f278e6435262a8f030f31f5dc63e2b69e5f4a1bcf00037a9e214fd59738611e78bd0562699512977c74a84873a42c39669f65d1c57001c78797077e533fdb6b66c40545e918de2797d24b9fe08ed3e79cd4722e9c46040ad9b38d150cb9bb6f835dfc597329d499b882bfd7105717cf5bbfc6882a2e203ecd1e5ef52ab6a7286f195b69463e5e3d309cc0fe274ad2409b751a8a6c4985f426aed0daef09bce3375518b4532a86550cc21bed0fbc1ad1af4c130709e7a41342c9e4510f32dec49cb018d45d6da9d56411d0a51750d8b48aa5875b2854a0cbab731ce61a209d303e046f367a3fbf58585c8c869cbf90db7fd4e53baf2a90eb3660f2c32d431fe34c8ee350265c340cd9f70f3cecb979fa1ff332403df7a3365b485ca796de90fd9c0058e189024e69ebd3a6e5177befa4fa48e98e2df50a9e8a0e9b9fddeb7d4683b53823a7e2b5046f309d1d08c7d4f4716c73f5aa73968ac168d019d16c8d675e4267399f4875cef50a36c2c3c392888878f8022cc188446aa16b8d008b376828f452006a40ea013c43e36df95b6f29f4dca32263ccdee9500afa183c3fcdd3cd03db0720b03823a9dd10a47118db82578a050ce7d7ee4523c635be238e76fe4fd7d9f9f4ef3c971b925f62fab590cfc58d0e122c70d35cb93e901024a4bfcd27ecb9f5087b201d74506b689e442509703e5f6ffd110b3119cedffbbbeb0237b122a453f71348e3f7664c4ab3d63e88b0701d1d7dcd1365030e5cde55e285c4f56dc25fd2137d11915dac9db270d63437fed3053de21aaf0cb5971a3515bc050b84c43dabea7993d509f13fddb76e0f4560e702a97d83f419963db0acab614f1d1da0fc43f510d8d7803d841895620ca20c25b26a5dff8405070d481ece80f51f044beabe116154258792ce6014c8f7c9d435fd31a4a9779a0fe4645e5c39353388c22d26d54030abc61e20026ffa68875b98c8cfa8859d8d960599da872a491b3c8a8b9c6a92fc7a3c2f90422b36b9e2dff80c2e71fad7cd0ff269507146a33fec19c66c3aed6403cf38203c29ced844c061f5ab421a81a276b218aa9bf2005567a92912d10efdc5016603b0ac5d1b2a23b66ec85c2d8ce20867880f4406752981bc97be5f7595a69d4cce7c2def9e309697f5a3a3702c93d11034e591f519187c06c05af2ba979868b4f2019c990cbf6f5d66a61a22f2b846bbbd978869c5fece3bd2b17ca0c24da6558b017bb6386decbfee66575d7bb01e47d6e569dfd94ffe0140e5d1d4d0ee5f437fd19f240de4547d85b10aaa1f1d911497a413a8cc0385d04a7cf51d72a0a3229cca886ecc67f18332a154207d5b34b544b6f529b3ced9ed4de1a44d5cc0df40651ae2f0b126e3fa8331f75cb6430dc3e7dba8dc25351bbb710e1fcdf8675bdbfb6dbf159253f7c7a39333babc0ac7893015cc99284fff82d5f8947e81d18ffaa7593f6e0305264bf063e072adeb66a12ffb19092a01e43cac7e6a1d4fe3dac6a9e4d9048bc08714929e1333bacd4ef93433bd1735ddbb4ea5a708827074e77ac529ea02e2c15ce52c1bad405fd49277af1e9b61de9c8c0c4915c1455063345cf04654fe8a79012854449ae086cee3baf92a1971d19dfcf303b1b9b012327e63af68b809bb92b8cb6762cc3d671208c19d94e4f7ad6bb3ae8e3d83f385a2adbbd10e1011f2f71da00ad3fdcf0944b31526e00fcaacab420647f2208135da16608c9b25207465d12643d5bfbafd8bc8779e3045504cec0c7e3c84fc7c3ae36f6572a90127cd95853743341060577768ca4d83b11c37379d6fd70e4f81d65a849d46ad1e0b1e49ce22f463a5f39a8aea95ecc73a1f7b9bfbb28c223d04fec64f14ba7b90cca56ed02ffab6c541cff3062c39d02955704fb4252c6873693c5e0b7c138e1b61b8fff6b42e031a34ee20b6516ab734cb69ea22ad64a0468635ff619a44b1b66ab020e7b74eba6546a53c1f420920548531db55293e5ec3f28a5cfc605cebdd30aeda7cf825eacac03b4387574</script>\n  <div class=\"hbe hbe-content\">\n    <div class=\"hbe hbe-input hbe-input-default\">\n      <input class=\"hbe hbe-input-field hbe-input-field-default\" type=\"password\" id=\"hbePass\">\n      <label class=\"hbe hbe-input-label hbe-input-label-default\" for=\"hbePass\">\n        <span class=\"hbe hbe-input-label-content hbe-input-label-content-default\">请输入密码</span>\n      </label>\n    </div>\n  </div>\n</div>\n<script data-pjax src=\"/lib/hbe.js\"></script><link href=\"/css/hbe.style.css\" rel=\"stylesheet\" type=\"text/css\">","content_text":"4e2911acdcf2c866c0098ba70a60c31e6102836718a2e88cdc489db43dd8819cffadcd8890bfced0745c331957305bcaf81532a8b35860a519a5e9d94ca4fc4d8c7b58d71dc88ebf7871833c2b007f458145f1db367e0007476db073730e6cd70d0db9a7cba956d43e865ab4f9065fe41824a85e090d5ad0890e662c2ff1e2c6f95f072d511438d0cd1dc994e5c7dfc768615d03fc4470238db2769d6acae83623a231afcbffc3da5bb5e728463ed3b9f667e92b5ec5be99a525e539d5ccbf603908137edf4a083770dc8aa0ca4117ea2ef5fa559356fad204021794b424872e799d4ca52397e2cacc7689a58c242da7457feefdc40994c49ca4dc94cd0392631e8cd0d6c5fa29adc04e6506c5275d1ec82f6720ee561c4dced80cc7a19a6fd0d0bda5be0ba1d391b8db617e5af061ab6afa9e3e7be82db4568d354fb57a4505a9b1d471381c9be5d8056d1a84bb92a5797fbf2314af272937495e29f9c3a324ce01c16b710fe76cc1b257bac19ffb4c18c55d0307271ccd8230aef2f91b8086e89d86b70e9617b739ec034736c954915d28ab213fcdcf71d2ae77c9345773595dc382e06474515b5b110390ea9b039e4eafb5ddd212adefb763e3796ce6f117b5931779b0d007de54e981de4cf6a09d60145f83588aa37b5ddec5f18c09b2141c3126581efd0906d6e1a67dc181791dc9be517803b586f469e4777703971af00373e573b2ec3513632fff0c87b475cda7e362d4ebc713a3aaf84d21649c4082c361df42826a76f67ae61016231ab4c5564b2456a445f78bd45c9fb7824199301eb71f2ef59403a88db2ddb4e0a0df2d613ca33e131636c09b583c67c32eccacd7b19443fb428dbc70524efef7287fa54f49df2f54996f7a82480f94843419fb88ac4225058288135ecf12ef31f4ce7f7242609c036d14c0ef097353e8c112e30e407d40786c145523ce63cda2da6edd6716a01196d82eab82568a3ccd984cd54adf81116256a22317a0aef247eaa1f3a171c112ddb8fe823547ba5ad5a9c8c3dccaa900e42b785c8ed0e54569e0288c702e4b826ab400fa564edc2aebd62dfecb39e5d2d4bef0fda63ca9c76101625839d8b0fc7b8e7b38d0e87b38eb3874e623aee75dbb1533e04561b49bd415aa2bff45c4977e606d5c74a1b88781304eef819e4697e56edc9e21c5df4730386bfed213befae3c0a24027adb4f9b1a93bc323e524ec6fece8fc3e2e02368cf8b9d15980b443b477fd42cdfe048df892e513b8234273861b4da3c7ccac23e9eb2a11a58f9e6dda171d8b917b521e6c8f61c2fae3af4a227cbaf1a8315725200b997f2f65616a5a56364b47bb49d9bce622e42f5fb442a0dd0baf0c4bbb8acb3ef8207d0e53cb43b967f505d159ed74451546276b0638fa199a2dd60bbcbb02e8f8773198b9caf98fa218308b6ae3d7392db64860b2530d10b984fa67cb6b7d02f0ebf6bdb40b0739b2aa883080634bf6aebfb104adca1635bd764b850ade127859a143ccd5dbe41dcb970a02c544dd6b4fa2ae9151ddc272ba1cca12ab702ddce8578250a3d392d717cf5c669c449f9a1a8789a3b78af3930d3db91ec2148132a77391639f2b4dce828e8645b45db7e2ceda59afcd6db75576da7bd1d30539099b2e69e83b03560700c853ae78323f04dacbd16b1d8c3aa099f68c01042c1aec59ef0e903800bc41e729ef8c260829f028af657b651556e74fc74eed558fb43f818f6ff515d134c184a387701c95c5228b6aff205a7f3bbdd1ec970985ab5bd797d0774e07af866c54c6502c01165ae116d864348182456288b1879fe419d58ad25dea82ebd10195547e3f7cab24838080ae921cd0af8197961026131f3e8d753631259f338659b9585b078e0c64b2bc3df96c5a9218f9a991a6ad07d517477783e45d4cfe6a4853c3bc8b4edc38af8587151921da9f1cb3d3b3b0fb196019894febe481a8f376bdff27cdc50d2e0bd77efe348aaf07f8818cafdeca29b248407e813c4c3d1bbd115a9eb6fc78219c39daddf85f4eaf6299fbdb9e6d8e606b5fbbb7770a537054ec59dcacb216726bb5c102b0eada719f97434429f9844b758410278b39f97f7c647e0621b78ceb54350a6d2a009df85e1834df4b49cb12be44e46ea5ef0c543e17690b285bec0b9578379b09fcfe6bf76f287ef01e4931175fd84c7e6182eff3afbc5feb4240982633bab273d0a45eac4c2802c6ffc30fac35e4635c2cdb0a2f341e1c8dbd25fbee591759e33fbcf932c45f395c03e19e26caee8480dbfaf168f03fea97bab2c0543df78333532d39933f05a32bb865bdfd156c9f67ab46eb016591b262a990055be677622d17afce08ad32b1000bf27e1c6f24085ff2d668006134f8ffcc0e39174a530ce1496a75423dc442fd2f2fde0a2c7c666cac3077178de919bbc621c418339f82b0a1a39b47c986e5e97c5939bedd73e992bbb1a49ff1c288f15cdeec2cc3e10abdee87da61447a8d3cc7d3a324ac8e4323cb65afb7203ebcd97e6376a944084be0038cf3ad20699a7871116d1eff91b1c2fb283989a4e2c3f94da377170cebe443cb149d99e7eaa8225f39aba5b3385c1675670e88f64251393bde30749290590b881d309f6e33a1208e5627141bde670972deb62cac14e3200a0dabd98c9796bbc74ef4ef77c6202086ee3f58e4ea651fd027a2f5828822f95a859ca17de9bf2d7fb999d44ece312ba3e7733c295c7795b81621c9e5a9d1d7fc3cd1864abc733288cb16877f403655e5c838d619ffe1d1cf731b38ee297d8758789802c5e2112f224d6a6322f007e40adbc75b86eb198753c9080f8ae9eb5b03d393bc0566f2fdd3399342ad81b59719729673134b0062732a8243e45d643eb41ab5794e885082c4d6feb5c1db51e3f5afcae1cae40e17d955dbe3463f11e7072d62d3c38c5c09f250184e7fbe9fa17605ad0b71cac60a8ea188353d4d776fc3a005112ca376e37bff56e843b29d9490106b0f52ff66b940af88188646f51b218d4bcebb051c61ca693ac775c9ea36f8786577178ddafd1c186c04920fa6125b29fb0849f0c12324bf04ed19943e8825485138b0e6692b98120654b1a1326f154d30efb12a2a3b5216a2345210242964b5b6efed948656c1c0563fe2087b5cb8b01ef0d8627b776d4c15cdab683f6132eb833447638e9b868136eab40e5a48cf11085dbd4153c89f76848e8bb96089096dd805fe1561641090e8cf5ce5ed7dc4f38c210558f43203d1e4c77a088380b54931b5b04c1e2875b5efccc358e78ca35b8a6527a07913ee74bbd25b885e5304085f61e4560acdfccd165acdd1f31cd87ea2febd69fec0fdf62ed7d715e9f89b1a8e1c8633d99b0aeb29993fd89484103137272c330cbb0c33ba26db6257a44cc0be33f287ad1f69832d3b8ae2dcbef7d7ded184c05f9ebf9bb58115cf1000ff2b6ced4f4cd352b530eb69de70ec7cd765281c361887fc2c5795e4a2c5d76bf63dee46d8159a0c3c9c8452466f60c25bf5e769f9282f56056cafb61a737807282081b553a43a31b8cdbf3f368bf5e8a25c50204e081afbfb93f1377c10b9f575f11f3fd83b743f9a41d9b72d72f1bd2ceacb8b89cfef73d8bb64cad4ac6ed84ba49a84ad81aa024d38f01b89689cf967b6b8fd4e80d05ce657ee38ee795fc931e9b9599e63fb2fb78833a8c1a8e1da3b06f4d1ff461d52b2a35ce15b490c0818a01cc4c849f8f1cc52361ba20b023a116b8a50f9ccfa86f1b331877da00b44515149576ede47f7dc4defaebe9ccc6be5d9381210bccf188a0f62b5737a6f969317d3c06c3b8ee7ec1daf7c24146dbdc3e80e019d030788c07e9cf2ac3497ac100ce7d9aafe81cb4df1be35711afd98d863f226e0ef84f13a9c87aabb687694c7c3d434716183d4e9c2508010c931a2e5b6af0cf5e5ddb5c82abf306f41ca24cc6f6a6504c9f11b060a6841a43204ab434f8c3a56c1b351cee41e07dcf39620b1a4e015ae64f8c5216f685c735d5002187ec4fec624da379be18ea9b92928546b940be4c31f3b6137fc391526c319e5d12363738e0f5339878851247923c89eb9aa0b98ee128ce7f38dd20e84ff622cc358aa899b0f81074122446b8284aaf900566ad96e7c2c78fcd2dc4469039c06bef1342b5b12395e2279a851f241fee8e717f718b209bcfd93138917562a9fdcca097d1ef9e41b8215f1732b9393a67175667110113ac9732b169b3e6e617ade9210faab3f20a9215e92ab93681ff443bfbce739f55c225d5a9a1c9a0b4cb9270e329b88eff7239cf489a7058147a4932512b8133c4a8478630ff4d32564fef7134a098fc7d1b431549f412d98a0881791b9d0a9eb158d82955e77a02447f2b4ea029ba2e2993006be72dbce050773688b6b1197c5c1c8bb59594db63e959a30e6017ccf55a2864c5a819de3b19f59fd7415c8197ff997aa98e20885a86ad83a8710c3b522a2ee9abed9fdf95c55b28b15f959a13acac832fc930a5acbde6b081b980e6c95844270db4ac02aedc8651bf9d81ebbd16f0ac5829532cedeafc6efb6afa2eb06176cc29f4e27e2ba44e80d56504221c3746710dfb0d529a7573f7a56ed438a76ab7311d342af130d04777e0fe3467111999a0406f6087a683c649df42d8725d0fad0755faf5deea89ec0056ae6ffa96e0be4ead79c5a880642271f94919b1c9be8999901a5a7fc660deef7bb2cfdb4d06d103f1ec161442fdd2dc34a9859d50a935a0ce0ac487d74b220c7e3b0bfe808f9eb8f4e3ec783aff81203d6bcd8cba006042cf85f960028916109203793a012cb939c69006d837eb9765a9f4627de930803e683f8f92ef507445c888502aac4f53b3b7118c9f9551c339a647827bdcc3731d27e970971610d13de01eb7302d3fa42f7cc4a2bdb134b17ac66d6d068f6ce51e777b81fc3db082ef7c0a1efb3ef2f7f75825c4ceebef7520cfba5a9619baa640011ca88a8fb9398ac492199e6db2251fada5a72fcd07e61bea99d211fc55046ed2fbd909df05577a2fccfce4bb32d4626693c10a5fb2fc1c3abc326d934cea686db902e73bc53fa6318db9824e6df3e5d9c0890e148ce5869b4a30bbbc767952cfd6e7f194c2245708f9cce4c99dc713d86e0f8ff28d8beb2f84eeec5e7c0f1fc7a843c310980cb328e4d19b17f9c7fa27a9d45b95f16e43aac68258b20c07c990d23e35b83e6bce6843db83f68e0e8ca1b8372d1321daaf3c227f048f55bf649527f905befc5aed8f699609fd3f2926b66cdd108909e1eb35bee6a74742fe9ac20b5e921bcaf5001a4b88ba5c986e9b0fdb3b813da38d8009d232f85fa0ae0f85a244edc7dc32d6160a768f9f45296e459476874c7058bba75481786497267c8a9b833173a3f040bbf7f8674c036488e1f26110f0869bf2d8c2151af10ad50979961e5d46e81a6d14a7b464416a3b9dd41a933725b5817036dc9a9f11e82514e86aa52e778fd4692b7533a80723785ff066bfb829d1a335a07a9725223556860b1434d9b5203aff5f41518b3962d0d27b6889d7a0a5a29f6da9f9da47fd3d7ef0ed9aea628892e091d61be1f3a219f1f34b1258547803fb4ffabfbd15d4c33a5af4f7f49fe78a970d79ee9aa798445693d5056c26d639baa6bf80a664b076694d017032053d2bcbb2af09696e8705f572cb68a64a6be61645abc2eaa7309d589b1d4dee49497bca5549a5100bd9067997bba20bd7f0aa6d9b0e79568547575ba0a0ff4b30e360d1c64ba03108463aea7ec4d784a0489fbd36a35f217546cf36dd7fb579caaaf79c5f2a7af1d3c3a499863bb515d760293c4b9f98b35f4403dfd0b2e73c1b06ec96759bca0d085f18bdf29ae545c74e3ac33488c672b85712ee539512891e0e899e2718b2c4c75be68b49b76449821e7367edfd7824e1706b1384c772f4bc6975e0efe527741684e1bdba18e60ab367647a8669e5c4eeeda281a7e0f0f05fbdbd529cf7775e722602cfd111da377ec551ab63cf6fef503ba762cc8e6268b525ab615795b49007fef82494f13486196bcb80cf39d0cc37b682dfc159db165637d784ebd95e1d49be2acf810138417219190204681c0045979e3db3222d73c6fb16ea69043d584fe4e1f8d65ecd5472ba179911d7a0437ffbcaacc5c815a0538699c284f5a48c7e6d7b87fa4b9222329af0b0e7042d5662295d0c4ebb6de9eb2e15c0f8ee274d0d4b7d323b102181472f50d6f94c71211dc9f7daf4f13cff1f79b8347780026a495b4836e7c081bfab8ca0de4f5dd6cf1548ff45f9c190004eb15566bbd2a333561b180669519b4029ccdf571678201be07b7486ddf65c87842d540843a2aee9aab08dee5766f320c3d836bcbf132caa08380551a154e0c66fc9ced56205f3d8ff9133d34f713829f61494cdbb2e7ec8180e8bae8af5d7f8b21daa57a541b4d1b88bfb0507a606e15b519ca65755b078e6c6d0e3ac2bb522159658977e6b2d31ed6421ba63ef942cb2f97a9a8309f08266e72f2ab63127daba3f05232a8ea2bf0b29b9ac12f534966673833d9b0d50db80d572ee64ca4d9c5c21f3eb31b3a687ad71e5df2d284f1dadec0066e1f80ec1aa848f6c2b451696bdd482b4016dfd8040b1fd65b8a75cbbf1d15bb9c069e726e16486ad268f624908c94b5642bb1e648af353baed32fe8c1d59be33620fbc3da76396b00ca147302006c4684a8af2cf72243c9ed9ac99229d70380d1135c177d288933a12515080f0f1280d6efbcccfc55fec686c6245b1cd69d6984f4a60d15e2e915f703093852d98cb4113e22ae7b81001d904d233c8b2f482352985cf8cb87012bc3473588ed894e4cebf1cc83d6a544e0fa7ad9e31527df7420da9be5e296c235ac8ad24a3df2e18c49da541b82398113d555dc38fac6a8d03d684f983dc0c422bb0a738ba0d450d06cad0307dd531996556ad4bdb51562f2dbba7b2a117be83e8b8dd25dd78ca1c4902d8a436c1268625a3b6ae5ececc8192fcc59a29e629aba8f8d4f363e94312dcaa45b81209dfb75d81202082049c7a042ee880d5ea376dc14102f2619dd7911798221802bf6a9bb0c6d6969af0268cca293bf84522acaf6cad1e31ccf6adca47e21294746f411d38d500e4ff027a6eb0eabf071bf8dc43985254240ac55a98d2b06d54ac78ce31acb120eba4d4f2401305423209353fda382014e7be9a4ffe2e0c3450dacc51bcdbe681c5a49fb8af7cdd2f1de2b43b1780411b79517ea59002bfa95d7b30b80aea39da56fb528b8dbc6594c7caecabe66c02e4897fe7ce3a899349b1d97103f73340cd9a2de384558057986ffb91e216aeab642795810a5d9e1a90a06607c70cbec97620525a4d7521504e2f8f52b711ef747ad662e869c61cf056324f10ae5d7e38abd441837f9ce9391fb3a7d8363832e4490704cdedd8d07a257e18eddb0bc4ec609317c13067e7984b71f4f5549e347ed74703bbcc482393217df4624bf05e4db316296becd32d9b126a09787b25be9c711057512ac95eb71c5d40bcbe9d2b0be951f389194b5fad657324c4dc5bef34c5d7ecd10429ec87d7ccda4c1192615bd6318de5430f9a7833f0d331deeb2ad2880b8d227695cb39fc8f0273508411eb8bede83aa405c1011dea4dbba5259d366b4e3036873e87e05b201c874e6a3976e91b6b96147815d358aaa9d0909ee53cd659cf7b3898a487fe438aea25ed689a7c33a09dda8e2e04ae9ab9e9851da5b387e72953a9614711674dc0fc2064cf5625b0bc4826fd59b109d250d84238689a1e5ba47963d5e2a72f94f5021e4b8638cd5e2bb10d22fce0a06aaa1c402b3172183e656c102f5750068b86048d6485b2ac47ea87fbb761b94540fdf4421f38735d2bba27abc408205f603f31009dbecc6bdcd5c8ab6bd27712190ec1a0c3b4023e03d814c5e8d566b44f3aad640b0b38a13050a5eca46b14f3f19d72d005e91281d1151c4abaa46ab2d7c10366dda215a8401fff5a513e52b87acdae871ceec654a496ed6ea0595645890856ad3cf6da4448e86c61a686e27e653c3630bd99e740aa0bb5ec62216aa763f72dd58138f2c9220e2e684728fdfb34f71bd89fcf4bf4617db47f35576ec7127f1b049c65b02de53413b9426c26d5004d7b7e81b249273f68d5732554dc347b560f1256500644fd343a97a039a7c491cc27253d2e327a6d83f510d570bae6216e207717cce51f5d5f6ecbefdc507ae553eeb0ad812762bee56b840b055e56c0b203ca6a249d7a5d0fc4fea3be1676515a97589e07aadc47af4c167e23e996e4928a18d6f600449386d4079aec1d1f5c43c1a336737baa99d4494b4f50352ddb146acc9cea511579ed800469d320ae9406c6ceba76bdf000fce57ba61b1888836787d1758d1d9ee35cf8ce6f34ee48a450724e663e17d64469fb7639305601464a538cc5d679b06bb2911dda5b8885be5b762a80438e99901ed1f2f86f15789d2ebab9422e818102807cda98fede4941c03e8ed5b9424006415b30abee57d1fbb899e1c78cb75aaa92eee4a6163a69321760c7f830b57952bdb6c707eeb6b6263f25379e346b99c440f54dd964114d98ae5350d41b4e711f882bd967ab9da9445021738342b30f14ef7f162abe670774593847dbca529c6bb7de75ef05bd813687b00e61adbd01b0b564528f945913b8838577ea82f54d40e2db1019484c215be034b930265b9212bf6a0ad416c9363f08e6631f834092edde2622c81d91d1db7b3aa219aaa140669c29543e081ef874d915511d5d8ddfaf6c06627d7704df93339b8a0f367b8830795bea7e3a1828b85b88b336dfb7673910eb9c80eb85a92bbfa2d2b93d2537d9327253a273d83fac25eb3ed9346a6ec4fe18c802bac178161a562585d92adf7ca14b2586a406e2025582a24cb458de7252eb55e5a02ad2033195f0b059ed7a4628f2ddfa92b2dbb99fca4e699fa76a9c3dc7d311da50a248a9947666c69c1d6d7f6c786e082e95247fce190c743f7d4dda9d319055c6f797b1c364155ffd1c4f3a8c719e9f3957170e6077ee4263f18a283996eda953a0b9e1a24dce40e34aeb11ba052be08bd6a6e47113b9d19e864100de836e6107d6a4e4be2267828f17448240c0801b0e2d1fcb0a7428151f3e0dee8d6be464e5684d97d3362786233559681e7bd21198a26f9ca8632bcca9ef546dd9db018998a4ef0f92346e8364fc51f7e717474a026661fbedb8f37f4481025ba2fcd960d574f8b23bcbfac7d118d65cbc12b84aa27be0b2d5c8d4835a0c5addbfd293e6b4ee6c74ac3fd3070db3b456d0f69680acf1280b22ca6869bcc3fa0258d2e7c4c5c41e540f1b1b0e27fec52df49b925604c2ffaa5f4c476fb34c3415919e3a0b8c626d85ad9945658beeb4da0fd3326477b44e24b5841465ea50634996747afc8328e0892677746f8f8980cb8a34f4b048b5e3aa51f045afea4d8a02e0662faf0da04a749a96c297c7ae99d1dfdb471f2bf7975a299efade4c06bf7da22423b3dd56282e31bef1da1f2fe0b73d78537170f51323643f8e449b3cb4f83688dd03542791ef15673453ea4b5cd53566f4223453d67c8ac9f07a444b336db227193de747099f0bb832f4d25167e88d3b69897605297e6024b25018232779cb255955b5388dfbbaa4bb863c0ef33aa7813a61c4cbc45354d87804ad004f5daf31c4c202e805c95de30cc44e37bdc26bc5d92d455059bcb456f569986e14333989ed3ef5997e9b0904f1585b75c28c2b3d1fffd0881364659c2f91368f5ff1950384cc37c9f112852e78d9ee8fa6e950516fcba9a4124b5a786995e80dcfaf54aa11108e7390ad3e9c645744e93bf60005c86beb54099228c0678d5b81f903c9dd120652a9132ce887fab5a0c0bdae08d68e4e577980767a4f2f50ff6c56922a13593f54b35bbe68982c576ebc60642011d59754d48afa5f7b4e7bf60f434c790190cb3c936d77a43fa99e1c36acdd16f5e0050ebb6dd9f2e312f71f56d5d58d2146d3dacf32f4405292d0845ae04a7d81c90ccb7fc4399cc1ea1738ecba79147a3fed4a050feca5fcf2041c19d75a6306948b63ce4cb4edb96af1eb7bb41e21101aaac9540af06e1e1995f9d713ac1355005d79d8bed78471cd2df17ed7a0f3e4d9f2eaa74d5864c6db609a2887126f87a7039dcf50b38da2c2e5c94ef9d728a9787a0e70d8f126e75ca9602ae49752017f7128e24bdae5ed8a6e2ed7c11339bbcab7a8ae1d3e3e82a82f9e7b5b08777cd0daf37418b68a9b0b64d856b94f52cf2a713d490730fa5e56136403348d594d872c5addf59c527aaebe136d22990baf16ec4595e4039377f21c2df18b1cbfc1c2f806ba3a50845784f99205de36409a41b9630dd8e16d624a208aa14eae2cf3a8f412dccbb29ebe303135faa434dffba4b85817638e9c9dc43685020bf0a253dcfeee8a1d4c532522dc4c69ce1491e59f3ad1509e8ec8ccacc192f7481950eb62173d4b77b7d42a6cced3d01a23ccc84ad3dba46f7451652558527a22151bed5c4e3bbd38a9f2c5e8b61ccc5450f4b574f4a2f1307544284aed7ea7761a38327d20eff35eba6cceededcc19c1fe4dd0c0cb04138e2faed728413fc333301f278e6435262a8f030f31f5dc63e2b69e5f4a1bcf00037a9e214fd59738611e78bd0562699512977c74a84873a42c39669f65d1c57001c78797077e533fdb6b66c40545e918de2797d24b9fe08ed3e79cd4722e9c46040ad9b38d150cb9bb6f835dfc597329d499b882bfd7105717cf5bbfc6882a2e203ecd1e5ef52ab6a7286f195b69463e5e3d309cc0fe274ad2409b751a8a6c4985f426aed0daef09bce3375518b4532a86550cc21bed0fbc1ad1af4c130709e7a41342c9e4510f32dec49cb018d45d6da9d56411d0a51750d8b48aa5875b2854a0cbab731ce61a209d303e046f367a3fbf58585c8c869cbf90db7fd4e53baf2a90eb3660f2c32d431fe34c8ee350265c340cd9f70f3cecb979fa1ff332403df7a3365b485ca796de90fd9c0058e189024e69ebd3a6e5177befa4fa48e98e2df50a9e8a0e9b9fddeb7d4683b53823a7e2b5046f309d1d08c7d4f4716c73f5aa73968ac168d019d16c8d675e4267399f4875cef50a36c2c3c392888878f8022cc188446aa16b8d008b376828f452006a40ea013c43e36df95b6f29f4dca32263ccdee9500afa183c3fcdd3cd03db0720b03823a9dd10a47118db82578a050ce7d7ee4523c635be238e76fe4fd7d9f9f4ef3c971b925f62fab590cfc58d0e122c70d35cb93e901024a4bfcd27ecb9f5087b201d74506b689e442509703e5f6ffd110b3119cedffbbbeb0237b122a453f71348e3f7664c4ab3d63e88b0701d1d7dcd1365030e5cde55e285c4f56dc25fd2137d11915dac9db270d63437fed3053de21aaf0cb5971a3515bc050b84c43dabea7993d509f13fddb76e0f4560e702a97d83f419963db0acab614f1d1da0fc43f510d8d7803d841895620ca20c25b26a5dff8405070d481ece80f51f044beabe116154258792ce6014c8f7c9d435fd31a4a9779a0fe4645e5c39353388c22d26d54030abc61e20026ffa68875b98c8cfa8859d8d960599da872a491b3c8a8b9c6a92fc7a3c2f90422b36b9e2dff80c2e71fad7cd0ff269507146a33fec19c66c3aed6403cf38203c29ced844c061f5ab421a81a276b218aa9bf2005567a92912d10efdc5016603b0ac5d1b2a23b66ec85c2d8ce20867880f4406752981bc97be5f7595a69d4cce7c2def9e309697f5a3a3702c93d11034e591f519187c06c05af2ba979868b4f2019c990cbf6f5d66a61a22f2b846bbbd978869c5fece3bd2b17ca0c24da6558b017bb6386decbfee66575d7bb01e47d6e569dfd94ffe0140e5d1d4d0ee5f437fd19f240de4547d85b10aaa1f1d911497a413a8cc0385d04a7cf51d72a0a3229cca886ecc67f18332a154207d5b34b544b6f529b3ced9ed4de1a44d5cc0df40651ae2f0b126e3fa8331f75cb6430dc3e7dba8dc25351bbb710e1fcdf8675bdbfb6dbf159253f7c7a39333babc0ac7893015cc99284fff82d5f8947e81d18ffaa7593f6e0305264bf063e072adeb66a12ffb19092a01e43cac7e6a1d4fe3dac6a9e4d9048bc08714929e1333bacd4ef93433bd1735ddbb4ea5a708827074e77ac529ea02e2c15ce52c1bad405fd49277af1e9b61de9c8c0c4915c1455063345cf04654fe8a79012854449ae086cee3baf92a1971d19dfcf303b1b9b012327e63af68b809bb92b8cb6762cc3d671208c19d94e4f7ad6bb3ae8e3d83f385a2adbbd10e1011f2f71da00ad3fdcf0944b31526e00fcaacab420647f2208135da16608c9b25207465d12643d5bfbafd8bc8779e3045504cec0c7e3c84fc7c3ae36f6572a90127cd95853743341060577768ca4d83b11c37379d6fd70e4f81d65a849d46ad1e0b1e49ce22f463a5f39a8aea95ecc73a1f7b9bfbb28c223d04fec64f14ba7b90cca56ed02ffab6c541cff3062c39d02955704fb4252c6873693c5e0b7c138e1b61b8fff6b42e031a34ee20b6516ab734cb69ea22ad64a0468635ff619a44b1b66ab020e7b74eba6546a53c1f420920548531db55293e5ec3f28a5cfc605cebdd30aeda7cf825eacac03b4387574 请输入密码","summary":"该文章受密码保护","date_published":"2021-12-05T06:00:00.000Z","tags":["自由探索","持续更新","软件"]},{"id":"https://www.zhouweitong.site/post/033-algorithm-stack/","url":"https://www.zhouweitong.site/post/033-algorithm-stack/","title":"【WIP】算法与数据结构回顾 - 栈","content_html":"<link rel=\"stylesheet\" type=\"text&#x2F;css\" href=\"https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.5.1/katex.min.css\"><link rel=\"stylesheet\" type=\"text&#x2F;css\" href=\"https://cdn.jsdelivr.net/npm/hexo-tag-hint@0.3.1/dist/hexo-tag-hint.min.css\"><h2 id=\"简述\"><a href=\"# 简述\" class=\"headerlink\" title=\"简述\"></a>简述 </h2><p> 栈是一种常见的数据结构，由于其“后进先出”（LIFO）的特性而被广泛使用。栈的常见逻辑结构如下：</p>\n","content_text":"简述 栈是一种常见的数据结构，由于其“后进先出”（LIFO）的特性而被广泛使用。栈的常见逻辑结构如下：","summary":"简述 栈是一种常见的数据结构，由于其“后进先出”（LIFO）的特性而被广泛使用。栈的常见逻辑结构如下：","date_published":"2021-11-03T07:00:00.000Z","tags":["开发与代码","笔记","WIP","算法"]},{"id":"https://www.zhouweitong.site/post/031-algorithm-generalized-list/","url":"https://www.zhouweitong.site/post/031-algorithm-generalized-list/","title":"【WIP】算法与数据结构回顾 - 广义表","content_html":"<link rel=\"stylesheet\" type=\"text&#x2F;css\" href=\"https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.5.1/katex.min.css\"><link rel=\"stylesheet\" type=\"text&#x2F;css\" href=\"https://cdn.jsdelivr.net/npm/hexo-tag-hint@0.3.1/dist/hexo-tag-hint.min.css\"><p>图源：@Rella 《glow》 <a href=\"https://www.pixiv.net/artworks/91882132\">91882132</a></p>\n<h2 id=\"简述\"><a href=\"# 简述\" class=\"headerlink\" title=\"简述\"></a>简述 </h2><p> 广义表是线性表的一种推广。线性表要求表中元素拥有统一的类型，而广义表无此限制。需要注意的是，广义表和线性表长度一般认为是有限的，但广义表的深度可以是无限的（即递归表）。</p>\n<p>广义表是一种数据结构。对广义表的常见操作包括：</p>\n<ul>\n<li>创建</li>\n<li>从字符串形式创建</li>\n<li>销毁</li>\n<li>复制</li>\n<li>取表头</li>\n<li>取表尾</li>\n<li>判空</li>\n<li>求长度</li>\n<li>求深度</li>\n<li>从表头插入</li>\n<li>从表头删除</li>\n<li>遍历</li>\n</ul>\n<p>广义表是 Lisp 语言的基本数据结构。后文以 Common Lisp 和 C++ 给出各基本操作的示例。</p>\n<h2 id=\"名词注解\"><a href=\"# 名词注解\" class=\"headerlink\" title=\"名词注解\"></a>名词注解 </h2><h3 id=\"长度\"><a href=\"# 长度\" class=\"headerlink\" title=\"长度\"></a> 长度 </h3><p> 指广义表中的元素个数。举例如下：</p>\n<blockquote>\n<p>例一</p>\n</blockquote>\n<figure class=\"highlight css\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">(<span class=\"selector-tag\">a</span>, <span class=\"selector-tag\">b</span>)</span><br></pre></td></tr></table></figure>\n\n<p>该表中共有两个元素：原子项<code>a</code>，原子项<code>b</code>。因而该表的长度为 2。</p>\n<blockquote>\n<p>例二</p>\n</blockquote>\n<figure class=\"highlight clojure\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">(<span class=\"name\">a</span>, (<span class=\"name\">b</span>, c))</span><br></pre></td></tr></table></figure>\n\n<p>该表中共有两个元素：原子项<code>a</code>，广义表<code>(b, c)</code>。因而该表的长度为 2。</p>\n<h3 id=\"深度\"><a href=\"# 深度\" class=\"headerlink\" title=\"深度\"></a>深度 </h3><p> 指广义表中子表的嵌套层数。举例如下：</p>\n<blockquote>\n<p>例一</p>\n</blockquote>\n<figure class=\"highlight css\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">(<span class=\"selector-tag\">a</span>, <span class=\"selector-tag\">b</span>)</span><br></pre></td></tr></table></figure>\n\n<p>该表中没有子表，因而该表的深度为 1。</p>\n<blockquote>\n<p>例二</p>\n</blockquote>\n<figure class=\"highlight clojure\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">(<span class=\"name\">a</span>, (<span class=\"name\">b</span>, c))</span><br></pre></td></tr></table></figure>\n\n<p>该表中嵌套了一个无嵌套的子表，因而该表的深度为 2。</p>\n<span id=\"more\"></span>\n\n<blockquote>\n<p>例三</p>\n</blockquote>\n<figure class=\"highlight clojure\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">((<span class=\"name\">a</span>, b), (<span class=\"name\">c</span>, d))</span><br></pre></td></tr></table></figure>\n\n<p>该表中嵌套了两个无嵌套的子表，因而该表的深度为 2。</p>\n<blockquote>\n<p>例四</p>\n</blockquote>\n<figure class=\"highlight clojure\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">(<span class=\"name\">a</span>, (<span class=\"name\">b</span>, (<span class=\"name\">c</span>, d)))</span><br></pre></td></tr></table></figure>\n\n<p>该表中嵌套了 1 个子表，子表中嵌套了 1 个无嵌套的子表，因而该表的深度为 3。</p>\n<p>可理解为广义表字符串形式中括号的层数。</p>\n<h3 id=\"子表\"><a href=\"# 子表\" class=\"headerlink\" title=\"子表\"></a>子表 </h3><p> 嵌套在广义表中的广义表叫做该广义表的字表。例如：</p>\n<figure class=\"highlight clojure\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">(<span class=\"name\">a</span>, (<span class=\"name\">b</span>, c))</span><br></pre></td></tr></table></figure>\n\n<p>称 <code>(b, c)</code> 是<code>(a, (b, c))</code>的字表。</p>\n<h3 id=\"原子项\"><a href=\"# 原子项\" class=\"headerlink\" title=\"原子项\"></a>原子项 </h3><p> 不可作为广义表再分的元素。例如：</p>\n<figure class=\"highlight clojure\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">(<span class=\"number\">1</span>, (<span class=\"name\">a</span>, b))</span><br></pre></td></tr></table></figure>\n\n<p>上表中 <code>1</code> 不是广义表，对广义表来说不可再分，因此是原子项。</p>\n<p>上表中 <code>(a, b)</code> 是广义表，可以被分割为 <code>(a)</code> 与<code>(b)</code>，因此不是原子项。</p>\n<h3 id=\"字符串形式（书写形式）\"><a href=\"# 字符串形式（书写形式）\" class=\"headerlink\" title=\"字符串形式（书写形式）\"></a>字符串形式（书写形式）</h3><p>一种广义表的序列化方法。即将广义表写成由括号、原子项的值、（逗号）等组成的字符串。例如：</p>\n<figure class=\"highlight clojure\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">(<span class=\"number\">1</span> <span class=\"number\">2</span> (<span class=\"name\">A</span> B))</span><br></pre></td></tr></table></figure>\n\n<p>与</p>\n<figure class=\"highlight clojure\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">(<span class=\"number\">1</span>, <span class=\"number\">2</span>, (<span class=\"name\">A</span>, B))</span><br></pre></td></tr></table></figure>\n\n<p>都是常见的广义表的书写形式。</p>\n<h2 id=\"Lisp- 中的实现\"><a href=\"#Lisp- 中的实现\" class=\"headerlink\" title=\"Lisp 中的实现\"></a>Lisp 中的实现 </h2><p> 使用 SBCL Lisp 环境。</p>\n<h3 id=\"创建\"><a href=\"# 创建\" class=\"headerlink\" title=\"创建\"></a>创建 </h3><p> 使用 cons 函数可以创建列表。例如创建一个只包含数字 1（表头为原子项整数 1，表尾为空）的列表：</p>\n<figure class=\"highlight lisp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">(<span class=\"name\">cons</span> <span class=\"number\">1</span> <span class=\"literal\">nil</span>)</span><br></pre></td></tr></table></figure>\n\n<p>或者：</p>\n<figure class=\"highlight lisp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">(<span class=\"name\">list</span> <span class=\"number\">1</span>)</span><br></pre></td></tr></table></figure>\n\n<p>也可以根据已有的表头和表尾创建列表：</p>\n<figure class=\"highlight lisp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">(<span class=\"name\">cons</span> <span class=\"number\">1</span> &#x27;(<span class=\"number\">2</span> <span class=\"number\">5</span>))</span><br></pre></td></tr></table></figure>\n\n<p>也可以使用符号。</p>\n<figure class=\"highlight lisp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">(<span class=\"name\">cons</span> &#x27;a &#x27;(b <span class=\"number\">2</span>))</span><br></pre></td></tr></table></figure>\n\n<p>设置变量 X 为列表<code>(1 A B)</code>，作为接下来的示例：</p>\n<figure class=\"highlight lisp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">(<span class=\"name\">let</span> ((<span class=\"name\">x</span> (<span class=\"name\">cons</span> <span class=\"number\">1</span> &#x27;(a b)))) (<span class=\"name\">prin1</span> x))</span><br></pre></td></tr></table></figure>\n\n<p>输出为：</p>\n<figure class=\"highlight css\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">(<span class=\"number\">1</span> <span class=\"selector-tag\">A</span> <span class=\"selector-tag\">B</span>)</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"复制\"><a href=\"# 复制\" class=\"headerlink\" title=\"复制\"></a>复制 </h3><p> 可以理解为变量传值。</p>\n<figure class=\"highlight lisp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">(<span class=\"name\">let</span> ((<span class=\"name\">x</span> (<span class=\"name\">cons</span> <span class=\"number\">1</span> &#x27;(a b))))</span><br><span class=\"line\">     (<span class=\"name\">let</span> ((<span class=\"name\">y</span> x))</span><br><span class=\"line\">          (<span class=\"name\">prin1</span> y)))</span><br></pre></td></tr></table></figure>\n\n<p>输出为：</p>\n<figure class=\"highlight css\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">(<span class=\"number\">1</span> <span class=\"selector-tag\">A</span> <span class=\"selector-tag\">B</span>)</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"取表头\"><a href=\"# 取表头\" class=\"headerlink\" title=\"取表头\"></a>取表头 </h3><p> 使用 <code>car</code> 函数。</p>\n<figure class=\"highlight lisp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">(<span class=\"name\">let</span> ((<span class=\"name\">x</span> (<span class=\"name\">cons</span> <span class=\"number\">1</span> &#x27;(a b)))) (<span class=\"name\">car</span> x))</span><br></pre></td></tr></table></figure>\n\n<p>输出为：</p>\n<figure class=\"highlight\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">1</span><br></pre></td></tr></table></figure>\n\n<p>此时输出为原子项。</p>\n<h3 id=\"取表尾\"><a href=\"# 取表尾\" class=\"headerlink\" title=\"取表尾\"></a>取表尾 </h3><p> 使用 <code>cdr</code> 函数。</p>\n<figure class=\"highlight lisp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">(<span class=\"name\">let</span> ((<span class=\"name\">x</span> (<span class=\"name\">cons</span> <span class=\"number\">1</span> &#x27;(a b)))) (<span class=\"name\">cdr</span> x))</span><br></pre></td></tr></table></figure>\n\n<p>输出为：</p>\n<figure class=\"highlight css\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">(<span class=\"selector-tag\">A</span> <span class=\"selector-tag\">B</span>)</span><br></pre></td></tr></table></figure>\n\n<p>此时输出为广义表。</p>\n<h3 id=\"求长度\"><a href=\"# 求长度\" class=\"headerlink\" title=\"求长度\"></a>求长度 </h3><p> 使用 <code>length</code> 函数。</p>\n<blockquote>\n<p>例一</p>\n</blockquote>\n<p>有广义表<code>(1 A B)</code>，求长度。</p>\n<figure class=\"highlight lisp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">(<span class=\"name\">length</span> &#x27;(<span class=\"number\">1</span> A B))</span><br></pre></td></tr></table></figure>\n\n<p>得到结果为 3。</p>\n<blockquote>\n<p>例二</p>\n</blockquote>\n<p>有广义表<code>(1 (A B))</code>，求长度。</p>\n<figure class=\"highlight lisp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">(<span class=\"name\">length</span> &#x27;(<span class=\"number\">1</span> (A B)))</span><br></pre></td></tr></table></figure>\n\n<p>得到结果为 2。</p>\n<h3 id=\"判空\"><a href=\"# 判空\" class=\"headerlink\" title=\"判空\"></a>判空 </h3><p> 广义表的长度为 0 即为空。</p>\n<figure class=\"highlight lisp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">(<span class=\"name\">if</span> (<span class=\"name\">=</span> (<span class=\"name\">length</span> &#x27;()) <span class=\"number\">1</span>) <span class=\"literal\">t</span> <span class=\"literal\">nil</span>)</span><br></pre></td></tr></table></figure>\n\n<p>得到结果为<code>NIL</code>。</p>\n<h3 id=\"从表头插入\"><a href=\"# 从表头插入\" class=\"headerlink\" title=\"从表头插入\"></a>从表头插入 </h3><p> 反复应用函数 <code>cons</code> 可以实现从表头将数据插入广义表。</p>\n<figure class=\"highlight lisp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">(<span class=\"name\">let</span> ((<span class=\"name\">x</span> (<span class=\"name\">cons</span> <span class=\"number\">1</span> &#x27;(A B))))</span><br><span class=\"line\">     (<span class=\"name\">setf</span> x (<span class=\"name\">cons</span> <span class=\"number\">3</span> (<span class=\"name\">cons</span> <span class=\"number\">2</span> x)))</span><br><span class=\"line\">     (<span class=\"name\">prin1</span> x))</span><br></pre></td></tr></table></figure>\n\n<p>输出为：</p>\n<figure class=\"highlight css\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">(<span class=\"number\">3</span> <span class=\"number\">2</span> <span class=\"number\">1</span> <span class=\"selector-tag\">A</span> <span class=\"selector-tag\">B</span>)</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"从表头删除\"><a href=\"# 从表头删除\" class=\"headerlink\" title=\"从表头删除\"></a>从表头删除 </h3><p> 反复应用函数 <code>cdr</code> 可以实现从表头删除数据。</p>\n<figure class=\"highlight lisp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">(<span class=\"name\">let</span> ((<span class=\"name\">x</span> (<span class=\"name\">cons</span> <span class=\"number\">1</span> &#x27;(a b))))</span><br><span class=\"line\">     (<span class=\"name\">setf</span> x (<span class=\"name\">cdr</span> (<span class=\"name\">cdr</span> x)))</span><br><span class=\"line\">     (<span class=\"name\">prin1</span> x))</span><br></pre></td></tr></table></figure>\n\n<p>输出为：</p>\n<figure class=\"highlight clojure\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">(<span class=\"name\">B</span>)</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"求深度\"><a href=\"# 求深度\" class=\"headerlink\" title=\"求深度\"></a>求深度 </h3><p> 基本思路：递归求解。</p>\n<ul>\n<li>定义函数 <code>list-depth</code>，接受变量<code>list</code> 作为参数</li>\n<li>判断 <code>list</code> 是否为广义表，不是则直接返回 0</li>\n<li>若 <code>list</code> 是广义表，则：<ul>\n<li>对该广义表中的每一个元素调用 <code>list-depth</code>，使用<code>mapcar</code> 实现这一操作。返回值组成一张广义表。</li>\n<li>取该广义表的最大值。</li>\n<li>（赋初始值，可选项）</li>\n<li>将已有的最大深度值 +1。</li>\n</ul>\n</li>\n</ul>\n<figure class=\"highlight lisp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">(<span class=\"name\">defun</span> list-depth (<span class=\"name\">list</span>)</span><br><span class=\"line\">    (<span class=\"name\">if</span> (<span class=\"name\">listp</span> list)</span><br><span class=\"line\">        (<span class=\"name\">+</span> <span class=\"number\">1</span> (<span class=\"name\">reduce</span> #&#x27;max (<span class=\"name\">mapcar</span> #&#x27;list-depth list)</span><br><span class=\"line\">            <span class=\"symbol\">:initial-value</span> <span class=\"number\">0</span>))</span><br><span class=\"line\">        <span class=\"number\">0</span>)</span><br><span class=\"line\">)</span><br></pre></td></tr></table></figure>\n\n<p>调用：</p>\n<figure class=\"highlight lisp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">(<span class=\"name\">list-depth</span> &#x27;(<span class=\"number\">1</span> (<span class=\"number\">2</span> <span class=\"number\">3</span>)))</span><br></pre></td></tr></table></figure>\n\n<p>输出为：</p>\n<figure class=\"highlight\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">2</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"存储结构\"><a href=\"# 存储结构\" class=\"headerlink\" title=\"存储结构\"></a>存储结构 </h2><p> 由于广义表的特性，其很难使用顺序结构进行存储。因此广义表多建立在链式存储的模式之上。</p>\n<p>讨论只含有两种可能结点的广义表：</p>\n<ul>\n<li>int(32)类型的原子项结点</li>\n<li>由 int(32)类型构成的广义表结点</li>\n</ul>\n<p>因此可以设计存储结构如下：</p>\n<p><img src=\"/post/031-algorithm-generalized-list/20211103174117.png\"></p>\n<p>其中，<code>Node.type</code>指明了结点的类型：为 <code>false</code> 时代表该结点是原子项结点，为 <code>true</code> 时代表该结点为子表结点。</p>\n<h2 id=\"C-C- 实现\"><a href=\"#C-C- 实现\" class=\"headerlink\" title=\"C - C++ 实现\"></a>C - C++ 实现 </h2><h3 id=\"数据结构定义\"><a href=\"# 数据结构定义\" class=\"headerlink\" title=\"数据结构定义\"></a> 数据结构定义 </h3><p> 设置“表结构”和“结点结构”。“表结构”中保存该表的头结点指针，及表的长度。当表为空表时，其头结点指针为<code>nullptr</code>。</p>\n<p>按一般考核要求，显式设置类型别名，不使用对象，不使用未经允许的 STL 模板，不使用类型推导，忽略常量标识和异常处理等内容等（“C-styled C++”）。如有需求可自行按照逻辑改写。</p>\n<figure class=\"highlight c++\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">typedef</span> <span class=\"class\"><span class=\"keyword\">struct</span> <span class=\"title\">Node</span></span></span><br><span class=\"line\"><span class=\"class\">&#123;</span></span><br><span class=\"line\">    <span class=\"keyword\">bool</span> type;</span><br><span class=\"line\">    Node *next;</span><br><span class=\"line\">    <span class=\"class\"><span class=\"keyword\">union</span></span></span><br><span class=\"line\"><span class=\"class\">    &#123;</span></span><br><span class=\"line\">        ElementType atom;</span><br><span class=\"line\">        Node *nodePointer;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    nodeContent;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">NodeType;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">typedef</span> <span class=\"class\"><span class=\"keyword\">struct</span> <span class=\"title\">List</span></span></span><br><span class=\"line\"><span class=\"class\">&#123;</span></span><br><span class=\"line\">    <span class=\"keyword\">int</span> length;</span><br><span class=\"line\">    Node *head;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">ListType;</span><br></pre></td></tr></table></figure>\n\n<p>随后逐一实现基本方法。</p>\n<h3 id=\"创建 -1\"><a href=\"# 创建 -1\" class=\"headerlink\" title=\"创建\"></a>创建 </h3><p> 把表和各结点都放在堆里。</p>\n<figure class=\"highlight c++\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">construct_list</span><span class=\"params\">(ListType **gList)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    *gList = <span class=\"keyword\">new</span> ListType&#123;<span class=\"number\">0</span>, <span class=\"literal\">nullptr</span>&#125;;</span><br><span class=\"line\">    <span class=\"keyword\">return</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"销毁\"><a href=\"# 销毁\" class=\"headerlink\" title=\"销毁\"></a>销毁</h3><figure class=\"highlight c++\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">destroy_list</span><span class=\"params\">(ListType **gList)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">delete</span> *gList;</span><br><span class=\"line\">    <span class=\"keyword\">return</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"判空 -1\"><a href=\"# 判空 -1\" class=\"headerlink\" title=\"判空\"></a>判空 </h3><p> 利用“表结构”中的 <code>length</code> 即可。</p>\n<figure class=\"highlight c++\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">bool</span> <span class=\"title\">check_list_empty</span><span class=\"params\">(ListType *gList)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (gList-&gt;length == <span class=\"number\">0</span>) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"literal\">true</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"literal\">false</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"求长度 -1\"><a href=\"# 求长度 -1\" class=\"headerlink\" title=\"求长度\"></a>求长度 </h3><p> 同上。</p>\n<figure class=\"highlight c++\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">get_list_length</span><span class=\"params\">(ListType *gList)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> gList-&gt;length;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n\n\n","content_text":"图源：@Rella 《glow》 91882132 简述 广义表是线性表的一种推广。线性表要求表中元素拥有统一的类型，而广义表无此限制。需要注意的是，广义表和线性表长度一般认为是有限的，但广义表的深度可以是无限的（即递归表）。 广义表是一种数据结构。对广义表的常见操作包括： 创建 从字符串形式创建 销毁 复制 取表头 取表尾 判空 求长度 求深度 从表头插入 从表头删除 遍历 广义表是 Lisp 语言的基本数据结构。后文以 Common Lisp 和 C++ 给出各基本操作的示例。 名词注解 长度 指广义表中的元素个数。举例如下： 例一 1(a, b) 该表中共有两个元素：原子项a，原子项b。因而该表的长度为 2。 例二 1(a, (b, c)) 该表中共有两个元素：原子项a，广义表(b, c)。因而该表的长度为 2。 深度 指广义表中子表的嵌套层数。举例如下： 例一 1(a, b) 该表中没有子表，因而该表的深度为 1。 例二 1(a, (b, c)) 该表中嵌套了一个无嵌套的子表，因而该表的深度为 2。 例三 1((a, b), (c, d)) 该表中嵌套了两个无嵌套的子表，因而该表的深度为 2。 例四 1(a, (b, (c, d))) 该表中嵌套了 1 个子表，子表中嵌套了 1 个无嵌套的子表，因而该表的深度为 3。 可理解为广义表字符串形式中括号的层数。 子表 嵌套在广义表中的广义表叫做该广义表的字表。例如： 1(a, (b, c)) 称 (b, c) 是(a, (b, c))的字表。 原子项 不可作为广义表再分的元素。例如： 1(1, (a, b)) 上表中 1 不是广义表，对广义表来说不可再分，因此是原子项。 上表中 (a, b) 是广义表，可以被分割为 (a) 与(b)，因此不是原子项。 字符串形式（书写形式）一种广义表的序列化方法。即将广义表写成由括号、原子项的值、（逗号）等组成的字符串。例如： 1(1 2 (A B)) 与 1(1, 2, (A, B)) 都是常见的广义表的书写形式。 Lisp 中的实现 使用 SBCL Lisp 环境。 创建 使用 cons 函数可以创建列表。例如创建一个只包含数字 1（表头为原子项整数 1，表尾为空）的列表： 1(cons 1 nil) 或者： 1(list 1) 也可以根据已有的表头和表尾创建列表： 1(cons 1 &#x27;(2 5)) 也可以使用符号。 1(cons &#x27;a &#x27;(b 2)) 设置变量 X 为列表(1 A B)，作为接下来的示例： 1(let ((x (cons 1 &#x27;(a b)))) (prin1 x)) 输出为： 1(1 A B) 复制 可以理解为变量传值。 123(let ((x (cons 1 &#x27;(a b)))) (let ((y x)) (prin1 y))) 输出为： 1(1 A B) 取表头 使用 car 函数。 1(let ((x (cons 1 &#x27;(a b)))) (car x)) 输出为： 11 此时输出为原子项。 取表尾 使用 cdr 函数。 1(let ((x (cons 1 &#x27;(a b)))) (cdr x)) 输出为： 1(A B) 此时输出为广义表。 求长度 使用 length 函数。 例一 有广义表(1 A B)，求长度。 1(length &#x27;(1 A B)) 得到结果为 3。 例二 有广义表(1 (A B))，求长度。 1(length &#x27;(1 (A B))) 得到结果为 2。 判空 广义表的长度为 0 即为空。 1(if (= (length &#x27;()) 1) t nil) 得到结果为NIL。 从表头插入 反复应用函数 cons 可以实现从表头将数据插入广义表。 123(let ((x (cons 1 &#x27;(A B)))) (setf x (cons 3 (cons 2 x))) (prin1 x)) 输出为： 1(3 2 1 A B) 从表头删除 反复应用函数 cdr 可以实现从表头删除数据。 123(let ((x (cons 1 &#x27;(a b)))) (setf x (cdr (cdr x))) (prin1 x)) 输出为： 1(B) 求深度 基本思路：递归求解。 定义函数 list-depth，接受变量list 作为参数 判断 list 是否为广义表，不是则直接返回 0 若 list 是广义表，则： 对该广义表中的每一个元素调用 list-depth，使用mapcar 实现这一操作。返回值组成一张广义表。 取该广义表的最大值。 （赋初始值，可选项） 将已有的最大深度值 +1。 123456(defun list-depth (list) (if (listp list) (+ 1 (reduce #&#x27;max (mapcar #&#x27;list-depth list) :initial-value 0)) 0)) 调用： 1(list-depth &#x27;(1 (2 3))) 输出为： 12 存储结构 由于广义表的特性，其很难使用顺序结构进行存储。因此广义表多建立在链式存储的模式之上。 讨论只含有两种可能结点的广义表： int(32)类型的原子项结点 由 int(32)类型构成的广义表结点 因此可以设计存储结构如下： 其中，Node.type指明了结点的类型：为 false 时代表该结点是原子项结点，为 true 时代表该结点为子表结点。 C - C++ 实现 数据结构定义 设置“表结构”和“结点结构”。“表结构”中保存该表的头结点指针，及表的长度。当表为空表时，其头结点指针为nullptr。 按一般考核要求，显式设置类型别名，不使用对象，不使用未经允许的 STL 模板，不使用类型推导，忽略常量标识和异常处理等内容等（“C-styled C++”）。如有需求可自行按照逻辑改写。 12345678910111213141516171819typedef struct Node&#123; bool type; Node *next; union &#123; ElementType atom; Node *nodePointer; &#125; nodeContent;&#125;NodeType;typedef struct List&#123; int length; Node *head;&#125;ListType; 随后逐一实现基本方法。 创建 把表和各结点都放在堆里。 12345void construct_list(ListType **gList)&#123; *gList = new ListType&#123;0, nullptr&#125;; return;&#125; 销毁12345void destroy_list(ListType **gList)&#123; delete *gList; return;&#125; 判空 利用“表结构”中的 length 即可。 1234567bool check_list_empty(ListType *gList)&#123; if (gList-&gt;length == 0) &#123; return true; &#125; return false;&#125; 求长度 同上。 1234int get_list_length(ListType *gList)&#123; return gList-&gt;length;&#125;","summary":"图源：@Rella 《glow》 91882132 简述广义表是线性表的一种推广。线性表要求表中元素拥有统一的类型，而广义表无此限制。需要注意的是，广义表和线性表长度一般认为是有限的，但广义表的深度可以是无限的（即递归表）。 广义表是一种数据结构。对广义表的常见操作包括： 创建 从字符串形式创建 销毁 复制 取表头 取表尾 判空 求长度 求深度 从表头插入 从表头删除 遍历 广义表是Lisp语言的基本数据结构。后文以Common Lisp和C++给出各基本操作的示例。 名词注解长度指广义表中的元素个数。举例如下： 例一 1(a, b) 该表中共有两个元素：原子项a，原子项b。因而该表的长度为2。 例二 1(a, (b, c)) 该表中共有两个元素：原子项a，广义表(b, c)。因而该表的长度为2。 深度指广义表中子表的嵌套层数。举例如下： 例一 1(a, b) 该表中没有子表，因而该表的深度为1。 例二 1(a, (b, c)) 该表中嵌套了一个无嵌套的子表，因而该表的深度为2。","date_published":"2021-10-29T14:00:00.000Z","tags":["开发与代码","笔记","WIP","算法"]},{"id":"https://www.zhouweitong.site/post/030-algorithm-outline/","url":"https://www.zhouweitong.site/post/030-algorithm-outline/","title":"【持续更新】算法与数据结构回顾 - 大纲","content_html":"<link rel=\"stylesheet\" type=\"text&#x2F;css\" href=\"https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.5.1/katex.min.css\"><link rel=\"stylesheet\" type=\"text&#x2F;css\" href=\"https://cdn.jsdelivr.net/npm/hexo-tag-hint@0.3.1/dist/hexo-tag-hint.min.css\"><p>由于高中接触过，大学本科期间又深入了些，以防忘记记一些注意事项、概念和模板之类的东西。</p>\n<h2 id=\"简单分类\"><a href=\"# 简单分类\" class=\"headerlink\" title=\"简单分类\"></a>简单分类 </h2><h3 id=\"数据结构\"><a href=\"# 数据结构\" class=\"headerlink\" title=\"数据结构\"></a> 数据结构</h3><ul>\n<li><p>一维：</p>\n<ul>\n<li><p>基础：数组（Array），链表（Linked list)</p>\n</li>\n<li><p>高级：栈（Stack），队列（Queue），双端队列（Deque），集合（Set），映射（Map）等。</p>\n</li>\n</ul>\n</li>\n<li><p>二维：</p>\n<ul>\n<li><p>基础：树（Tree），图（Graph）</p>\n</li>\n<li><p>高级：二叉搜索树（BST），堆（Heap），并查集（Disjoint Set），字典树（Trie）等。</p>\n</li>\n</ul>\n</li>\n<li><p>特殊结构：</p>\n<ul>\n<li><p>位运算（Bitwise），布隆过滤器（BloomFilter）</p>\n</li>\n<li><p>缓存（LRU）</p>\n</li>\n<li><p>……</p>\n</li>\n</ul>\n</li>\n<li><p>……</p>\n</li>\n</ul>\n<h3 id=\"算法\"><a href=\"# 算法\" class=\"headerlink\" title=\"算法\"></a>算法</h3><ul>\n<li><p>分支（if-else，switch）</p>\n</li>\n<li><p>迭代（for，while）</p>\n</li>\n<li><p>递归（分治法，回溯法等）</p>\n</li>\n<li><p>搜索（深搜，广搜，A* 等）</p>\n</li>\n<li><p>动态规划</p>\n</li>\n<li><p>二分查找</p>\n</li>\n<li><p>贪心</p>\n</li>\n<li><p>计算几何</p>\n</li>\n<li><p>……</p>\n</li>\n</ul>\n<span id=\"more\"></span>\n\n<h2 id=\"文章目录\"><a href=\"# 文章目录\" class=\"headerlink\" title=\"文章目录\"></a>文章目录 </h2><h3 id=\"数据结构 -1\"><a href=\"# 数据结构 -1\" class=\"headerlink\" title=\"数据结构\"></a> 数据结构</h3><ul>\n<li>广义表：<a href=\"https://www.zhouweitong.site/2021/10/29/031-algorithm-generalized-list/\">算法与数据结构回顾 - 广义表 </a>，<a href=\"https://github.com/objectnf/training-code/tree/master/DataStructure/2_GeneralList\"> 代码</a></li>\n</ul>\n","content_text":"由于高中接触过，大学本科期间又深入了些，以防忘记记一些注意事项、概念和模板之类的东西。 简单分类 数据结构 一维： 基础：数组（Array），链表（Linked list) 高级：栈（Stack），队列（Queue），双端队列（Deque），集合（Set），映射（Map）等。 二维： 基础：树（Tree），图（Graph） 高级：二叉搜索树（BST），堆（Heap），并查集（Disjoint Set），字典树（Trie）等。 特殊结构： 位运算（Bitwise），布隆过滤器（BloomFilter） 缓存（LRU） …… …… 算法 分支（if-else，switch） 迭代（for，while） 递归（分治法，回溯法等） 搜索（深搜，广搜，A* 等） 动态规划 二分查找 贪心 计算几何 …… 文章目录 数据结构 广义表：算法与数据结构回顾 - 广义表 ， 代码","summary":"由于高中接触过，大学本科期间又深入了些，以防忘记记一些注意事项、概念和模板之类的东西。 简单分类数据结构 一维： 基础：数组（Array），链表（Linked list) 高级：栈（Stack），队列（Queue），双端队列（Deque），集合（Set），映射（Map）等。 二维： 基础：树（Tree），图（Graph） 高级：二叉搜索树（BST），堆（Heap），并查集（Disjoint Set），字典树（Trie）等。 特殊结构： 位运算（Bitwise），布隆过滤器（BloomFilter） 缓存（LRU） …… …… 算法 分支（if-else，switch） 迭代（for，while） 递归（分治法，回溯法等） 搜索（深搜，广搜，A*等） 动态规划 二分查找 贪心 计算几何 ……","date_published":"2021-10-29T04:00:00.000Z","tags":["开发与代码","笔记","持续更新","算法"]},{"id":"https://www.zhouweitong.site/post/014-d3ctf-2021-easyquantum-writeup/","url":"https://www.zhouweitong.site/post/014-d3ctf-2021-easyquantum-writeup/","title":"【补档】D^3CTF 2021 - Misc - easyQuantum WriteUp","content_html":"<link rel=\"stylesheet\" type=\"text&#x2F;css\" href=\"https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.5.1/katex.min.css\"><link rel=\"stylesheet\" type=\"text&#x2F;css\" href=\"https://cdn.jsdelivr.net/npm/hexo-tag-hint@0.3.1/dist/hexo-tag-hint.min.css\"><p> 图源：@しぐれうい  《雨に恋う》  <a href=\"https://www.pixiv.net/artworks/83975808\">83975808</a></p>\n<p>cap.pcapng 用 Wireshark 打开，清晰可见 TCP 的三次握手和四次挥手：</p>\n<p><img src=\"/2021/08/15/014-d3ctf-2021-easyquantum-writeup/image-20210225173442277.png\" alt=\"image-20210225173442277\"></p>\n<p><img src=\"/2021/08/15/014-d3ctf-2021-easyquantum-writeup/image-20210225173518052.png\" alt=\"image-20210225173518052\"></p>\n<p> 于是需要仔细分析中间的数据传输过程。</p>\n<p> 注意到某些数据包内有“numpy”等字符串：</p>\n<p><img src=\"/2021/08/15/014-d3ctf-2021-easyquantum-writeup/image-20210225173716886.png\" alt=\"image-20210225173716886\"></p>\n<p> 于是想到可能是某种兼容 Python 的序列化方法。</p>\n<p> 又注意到有固定的头部数据：</p>\n<p><img src=\"/2021/08/15/014-d3ctf-2021-easyquantum-writeup/image-20210225174044360.png\" alt=\"image-20210225174044360\"></p>\n<p><img src=\"/2021/08/15/014-d3ctf-2021-easyquantum-writeup/image-20210225174106286.png\" alt=\"image-20210225174106286\"></p>\n<p> 而 pickle 序列化时也有固定的头部数据（协议版本 4.0）：</p>\n<p><img src=\"/2021/08/15/014-d3ctf-2021-easyquantum-writeup/image-20210225174451338.png\" alt=\"image-20210225174451338\"></p>\n<p> 于是尝试利用 pickle 进行反序列化。示例如下：</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> pyshark</span><br><span class=\"line\"><span class=\"keyword\">import</span> pickle</span><br><span class=\"line\"></span><br><span class=\"line\">cap = pyshark.FileCapture(<span class=\"string\">&#x27;cap.pcapng&#x27;</span>)</span><br><span class=\"line\">test_pack = cap[<span class=\"number\">3</span>]</span><br><span class=\"line\">data = test_pack.data.data.binary_value</span><br><span class=\"line\"></span><br><span class=\"line\">deserialized = pickle.loads(data)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"built_in\">print</span>(deserialized)</span><br></pre></td></tr></table></figure>\n\n<span id=\"more\"></span>\n\n<p> 得到结果 312。随后发现之后的数据包的长度有规律：即 436-(ACK)-90-(ACK)-90-(ACK) 五个一组，或 436-(ACK)-81-(ACK) 两种组合。分别拿一组包进行反序列化测试：</p>\n<figure class=\"highlight apache\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attribute\">Pack</span>:<span class=\"number\">327</span> Data:[array([<span class=\"number\">0</span>.<span class=\"number\">70710678</span>+<span class=\"number\">0</span>.j, <span class=\"number\">0</span>.<span class=\"number\">70710678</span>+<span class=\"number\">0</span>.j]), array([<span class=\"number\">0</span>.<span class=\"number\">70710678</span>-<span class=\"number\">8</span>.<span class=\"number\">65956056</span>e-<span class=\"number\">17</span>j, -<span class=\"number\">0</span>.<span class=\"number\">70710678</span>+<span class=\"number\">8</span>.<span class=\"number\">65956056</span>e-<span class=\"number\">17</span>j]), array([<span class=\"number\">0</span>.+<span class=\"number\">0</span>.j, <span class=\"number\">1</span>.+<span class=\"number\">0</span>.j]), array([<span class=\"number\">1</span>.+<span class=\"number\">0</span>.j, <span class=\"number\">0</span>.+<span class=\"number\">0</span>.j])]</span><br><span class=\"line\"><span class=\"attribute\">Pack</span>:<span class=\"number\">329</span> Data:</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight apache\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attribute\">Pack</span>:<span class=\"number\">331</span> Data:[array([<span class=\"number\">0</span>.<span class=\"number\">70710678</span>+<span class=\"number\">0</span>.j, <span class=\"number\">0</span>.<span class=\"number\">70710678</span>+<span class=\"number\">0</span>.j]), array([<span class=\"number\">1</span>.+<span class=\"number\">0</span>.j, <span class=\"number\">0</span>.+<span class=\"number\">0</span>.j]), array([<span class=\"number\">1</span>.+<span class=\"number\">0</span>.j, <span class=\"number\">0</span>.+<span class=\"number\">0</span>.j]), array([<span class=\"number\">0</span>.<span class=\"number\">70710678</span>-<span class=\"number\">8</span>.<span class=\"number\">65956056</span>e-<span class=\"number\">17</span>j, -<span class=\"number\">0</span>.<span class=\"number\">70710678</span>+<span class=\"number\">8</span>.<span class=\"number\">65956056</span>e-<span class=\"number\">17</span>j])]</span><br><span class=\"line\"><span class=\"attribute\">Pack</span>:<span class=\"number\">333</span> Data:[<span class=\"number\">0</span>, <span class=\"number\">0</span>, <span class=\"number\">1</span>, <span class=\"number\">1</span>]</span><br><span class=\"line\"><span class=\"attribute\">Pack</span>:<span class=\"number\">335</span> Data:[<span class=\"number\">0</span>, <span class=\"number\">1</span>, <span class=\"number\">0</span>, <span class=\"number\">1</span>]</span><br></pre></td></tr></table></figure>\n\n<p> 又发现第 1041 个数据包处有疑似密文的数据：</p>\n<p><img src=\"/2021/08/15/014-d3ctf-2021-easyquantum-writeup/image-20210225233951420.png\" alt=\"image-20210225233951420\"></p>\n<p> 题目中的“QKD”即量子密钥分发。常见的 QKD 协议有 BB84、B92、E91 等。结合前面的关于流程的分析（通过状态向量传递量子、两个数组先后传递 Bob 的测量基和 Alice 的判断结果）可以确定使用 BB84 协议进行的密钥分发。这就也能解释开头处传输的“312”：Alice 和 Bob 需要提前约定好密钥长度。（严谨的 BB84 密钥交换协议中包括纠错、保密放大、认证等流程，此处略去）</p>\n<p> 同时注意到密文与密钥一样是 312 字节，考虑可能是流密码对每一位进行加密。</p>\n<p><img src=\"/2021/08/15/014-d3ctf-2021-easyquantum-writeup/image-20210301111356787.png\" alt=\"image-20210301111356787\"></p>\n<p> 而如上述序号为 329 的数据包处的空数据，结合量子传输过程中不可直接窃听的特性，可以想到存在窃听者 Eve，测量了量子后使 Bob 没有收到 Alice 传输的量子。</p>\n<p> 通过量子的状态向量和题目中给出的量子初始状态，已经可以判断出对量子进行操作的量子门及其顺序，因此就相当于获得了 Alice 传输的量子。这也是题目中“Debug info”的含意。</p>\n<p><img src=\"/2021/08/15/014-d3ctf-2021-easyquantum-writeup/image-20210301120232378.png\" alt=\"image-20210301120232378\"></p>\n<p> 编写程序解密即可。</p>\n<p> 增补：为降低难度，量子的初状态已经已题目描述的方式给出。参考资料的不同可能导致对状态向量的理解上产生偏差。为降低难度，此题使用量子数学的表示方式，即：</p>\n<p>$ \\left| \\phi \\right&gt; = \\alpha \\left| 0 \\right&gt; + \\beta \\left| 1 \\right&gt; $ 得到 $ [\\alpha, \\beta] $</p>\n<p> 为方便处理，过滤掉所有不包含数据的包，并存为新的文件：</p>\n<figure class=\"highlight apache\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attribute\">tcp</span>.flags == <span class=\"number\">0</span>x<span class=\"number\">018</span></span><br></pre></td></tr></table></figure>\n\n<p><img src=\"/2021/08/15/014-d3ctf-2021-easyquantum-writeup/image-20210301121736321.png\" alt=\"image-20210301121736321\"></p>\n<p> 随后编写脚本解密即可。示例脚本如下：</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> pyshark</span><br><span class=\"line\"><span class=\"keyword\">import</span> binascii</span><br><span class=\"line\"><span class=\"keyword\">import</span> qiskit</span><br><span class=\"line\"><span class=\"keyword\">import</span> pickle</span><br><span class=\"line\"><span class=\"keyword\">from</span> bitstring <span class=\"keyword\">import</span> BitArray</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">QUANLENG = <span class=\"number\">4</span></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">key = <span class=\"string\">&quot;&quot;</span></span><br><span class=\"line\">cap = pyshark.FileCapture(<span class=\"string\">&#x27;cap2.pcapng&#x27;</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">decrypt_msg</span>(<span class=\"params\">enckey: BitArray, msg: BitArray</span>):</span></span><br><span class=\"line\">    res = BitArray()</span><br><span class=\"line\">    <span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> <span class=\"built_in\">range</span>(msg.<span class=\"built_in\">len</span>):</span><br><span class=\"line\">        tmp = enckey[i] ^ msg[i]</span><br><span class=\"line\">        res.append(<span class=\"string\">&quot;0b&quot;</span> + <span class=\"built_in\">str</span>(<span class=\"built_in\">int</span>(tmp)))</span><br><span class=\"line\">    <span class=\"keyword\">return</span> res</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">recv_quantum</span>(<span class=\"params\">quantum_state: <span class=\"built_in\">list</span></span>):</span></span><br><span class=\"line\">    <span class=\"comment\"># Load state</span></span><br><span class=\"line\">    quantum = [qiskit.QuantumCircuit(<span class=\"number\">1</span>, <span class=\"number\">1</span>) <span class=\"keyword\">for</span> _ <span class=\"keyword\">in</span> <span class=\"built_in\">range</span>(<span class=\"number\">4</span>)]</span><br><span class=\"line\">    <span class=\"comment\"># Recover quantum</span></span><br><span class=\"line\">    <span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> <span class=\"built_in\">range</span>(<span class=\"number\">4</span>):</span><br><span class=\"line\">        real_part_a = quantum_state[i][<span class=\"number\">0</span>].real</span><br><span class=\"line\">        real_part_b = quantum_state[i][<span class=\"number\">1</span>].real</span><br><span class=\"line\">        <span class=\"keyword\">if</span> real_part_a == <span class=\"number\">1.0</span> <span class=\"keyword\">and</span> real_part_b == <span class=\"number\">0.0</span>:</span><br><span class=\"line\">            <span class=\"keyword\">continue</span></span><br><span class=\"line\">        <span class=\"keyword\">elif</span> real_part_a == <span class=\"number\">0.0</span> <span class=\"keyword\">and</span> real_part_b == <span class=\"number\">1.0</span>:</span><br><span class=\"line\">            quantum[i].x(<span class=\"number\">0</span>)</span><br><span class=\"line\">        <span class=\"keyword\">elif</span> real_part_a &gt; <span class=\"number\">0.7</span> <span class=\"keyword\">and</span> real_part_b &gt; <span class=\"number\">0.7</span>:</span><br><span class=\"line\">            quantum[i].h(<span class=\"number\">0</span>)</span><br><span class=\"line\">        <span class=\"keyword\">else</span>:</span><br><span class=\"line\">            quantum[i].x(<span class=\"number\">0</span>)</span><br><span class=\"line\">            quantum[i].h(<span class=\"number\">0</span>)</span><br><span class=\"line\">    <span class=\"keyword\">return</span> quantum</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">measure</span>(<span class=\"params\">receiver_bases: <span class=\"built_in\">list</span>, quantum: <span class=\"built_in\">list</span></span>):</span></span><br><span class=\"line\">    <span class=\"comment\"># Change quantum bit</span></span><br><span class=\"line\">    <span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> <span class=\"built_in\">range</span>(<span class=\"number\">4</span>):</span><br><span class=\"line\">        <span class=\"keyword\">if</span> receiver_bases[i]:</span><br><span class=\"line\">            quantum[i].h(<span class=\"number\">0</span>)</span><br><span class=\"line\">            quantum[i].measure(<span class=\"number\">0</span>, <span class=\"number\">0</span>)</span><br><span class=\"line\">        <span class=\"keyword\">else</span>:</span><br><span class=\"line\">            quantum[i].measure(<span class=\"number\">0</span>, <span class=\"number\">0</span>)</span><br><span class=\"line\">        quantum[i].barrier()</span><br><span class=\"line\">    <span class=\"comment\"># Execute</span></span><br><span class=\"line\">    backend = qiskit.Aer.get_backend(<span class=\"string\">&quot;statevector_simulator&quot;</span>)</span><br><span class=\"line\">    result = qiskit.execute(quantum, backend).result().get_counts()</span><br><span class=\"line\">    <span class=\"keyword\">return</span> result</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">get_key</span>(<span class=\"params\">qubits: <span class=\"built_in\">list</span>, bases: <span class=\"built_in\">list</span>, compare_result: <span class=\"built_in\">list</span></span>):</span></span><br><span class=\"line\">    measure_result = measure(bases, qubits)</span><br><span class=\"line\">    <span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> <span class=\"built_in\">range</span>(<span class=\"number\">4</span>):</span><br><span class=\"line\">        <span class=\"keyword\">if</span> compare_result[i]:</span><br><span class=\"line\">            tmp_res = <span class=\"built_in\">list</span>(measure_result[i].keys())</span><br><span class=\"line\">            <span class=\"keyword\">global</span> key</span><br><span class=\"line\">            key += <span class=\"built_in\">str</span>(tmp_res[<span class=\"number\">0</span>])</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">if</span> __name__ == <span class=\"string\">&quot;__main__&quot;</span>:</span><br><span class=\"line\">    key_len = pickle.loads(cap[<span class=\"number\">0</span>].data.data.binary_value)</span><br><span class=\"line\">    i = <span class=\"number\">1</span></span><br><span class=\"line\">    <span class=\"keyword\">while</span> i &lt; <span class=\"number\">567</span>:</span><br><span class=\"line\">        <span class=\"keyword\">if</span> <span class=\"built_in\">int</span>(cap[i+<span class=\"number\">1</span>].data.<span class=\"built_in\">len</span>) == <span class=\"number\">15</span>:</span><br><span class=\"line\">            i += <span class=\"number\">2</span></span><br><span class=\"line\">            <span class=\"keyword\">continue</span></span><br><span class=\"line\">        quantum_state = pickle.loads(cap[i].data.data.binary_value)</span><br><span class=\"line\">        quantum = recv_quantum(quantum_state)</span><br><span class=\"line\">        bob_bases = pickle.loads(cap[i+<span class=\"number\">1</span>].data.data.binary_value)</span><br><span class=\"line\">        alice_judge = pickle.loads(cap[i+<span class=\"number\">2</span>].data.data.binary_value)</span><br><span class=\"line\">        get_key(quantum, bob_bases, alice_judge)</span><br><span class=\"line\">        i += <span class=\"number\">3</span></span><br><span class=\"line\">    key = key[:key_len]</span><br><span class=\"line\">    msg = BitArray(pikle.loads(cap[<span class=\"number\">567</span>].data.data.binary_value))</span><br><span class=\"line\">    plaintext = decrypt_msg(BitArray(<span class=\"string\">&quot;0b&quot;</span>+key), msg)</span><br><span class=\"line\">    <span class=\"built_in\">print</span>(plaintext.tobytes())</span><br></pre></td></tr></table></figure>\n\n<p> 得到 Flag:</p>\n<figure class=\"highlight apache\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attribute\">d3ctf</span>&#123;y<span class=\"number\">1</span>DcuFuYwCgRfX<span class=\"number\">33</span>uT<span class=\"number\">1</span>lgSy<span class=\"number\">27</span>jYIsF<span class=\"number\">4</span>i&#125;</span><br></pre></td></tr></table></figure>\n\n<p> 当然，使用量子状态向量、Bob 的测量基和测量结果的直接对应关系直接得出结果（即不需要模拟）也是可以的。这里不再赘述。</p>\n","content_text":"图源：@しぐれうい 《雨に恋う》 83975808 cap.pcapng 用 Wireshark 打开，清晰可见 TCP 的三次握手和四次挥手： 于是需要仔细分析中间的数据传输过程。 注意到某些数据包内有“numpy”等字符串： 于是想到可能是某种兼容 Python 的序列化方法。 又注意到有固定的头部数据： 而 pickle 序列化时也有固定的头部数据（协议版本 4.0）： 于是尝试利用 pickle 进行反序列化。示例如下： 12345678910import pysharkimport picklecap = pyshark.FileCapture(&#x27;cap.pcapng&#x27;)test_pack = cap[3]data = test_pack.data.data.binary_valuedeserialized = pickle.loads(data)print(deserialized) 得到结果 312。随后发现之后的数据包的长度有规律：即 436-(ACK)-90-(ACK)-90-(ACK) 五个一组，或 436-(ACK)-81-(ACK) 两种组合。分别拿一组包进行反序列化测试： 12Pack:327 Data:[array([0.70710678+0.j, 0.70710678+0.j]), array([0.70710678-8.65956056e-17j, -0.70710678+8.65956056e-17j]), array([0.+0.j, 1.+0.j]), array([1.+0.j, 0.+0.j])]Pack:329 Data: 123Pack:331 Data:[array([0.70710678+0.j, 0.70710678+0.j]), array([1.+0.j, 0.+0.j]), array([1.+0.j, 0.+0.j]), array([0.70710678-8.65956056e-17j, -0.70710678+8.65956056e-17j])]Pack:333 Data:[0, 0, 1, 1]Pack:335 Data:[0, 1, 0, 1] 又发现第 1041 个数据包处有疑似密文的数据： 题目中的“QKD”即量子密钥分发。常见的 QKD 协议有 BB84、B92、E91 等。结合前面的关于流程的分析（通过状态向量传递量子、两个数组先后传递 Bob 的测量基和 Alice 的判断结果）可以确定使用 BB84 协议进行的密钥分发。这就也能解释开头处传输的“312”：Alice 和 Bob 需要提前约定好密钥长度。（严谨的 BB84 密钥交换协议中包括纠错、保密放大、认证等流程，此处略去） 同时注意到密文与密钥一样是 312 字节，考虑可能是流密码对每一位进行加密。 而如上述序号为 329 的数据包处的空数据，结合量子传输过程中不可直接窃听的特性，可以想到存在窃听者 Eve，测量了量子后使 Bob 没有收到 Alice 传输的量子。 通过量子的状态向量和题目中给出的量子初始状态，已经可以判断出对量子进行操作的量子门及其顺序，因此就相当于获得了 Alice 传输的量子。这也是题目中“Debug info”的含意。 编写程序解密即可。 增补：为降低难度，量子的初状态已经已题目描述的方式给出。参考资料的不同可能导致对状态向量的理解上产生偏差。为降低难度，此题使用量子数学的表示方式，即： $ \\left| \\phi \\right&gt; = \\alpha \\left| 0 \\right&gt; + \\beta \\left| 1 \\right&gt; $ 得到 $ [\\alpha, \\beta] $ 为方便处理，过滤掉所有不包含数据的包，并存为新的文件： 1tcp.flags == 0x018 随后编写脚本解密即可。示例脚本如下： 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879808182import pysharkimport binasciiimport qiskitimport picklefrom bitstring import BitArrayQUANLENG = 4key = &quot;&quot;cap = pyshark.FileCapture(&#x27;cap2.pcapng&#x27;)def decrypt_msg(enckey: BitArray, msg: BitArray): res = BitArray() for i in range(msg.len): tmp = enckey[i] ^ msg[i] res.append(&quot;0b&quot; + str(int(tmp))) return resdef recv_quantum(quantum_state: list): # Load state quantum = [qiskit.QuantumCircuit(1, 1) for _ in range(4)] # Recover quantum for i in range(4): real_part_a = quantum_state[i][0].real real_part_b = quantum_state[i][1].real if real_part_a == 1.0 and real_part_b == 0.0: continue elif real_part_a == 0.0 and real_part_b == 1.0: quantum[i].x(0) elif real_part_a &gt; 0.7 and real_part_b &gt; 0.7: quantum[i].h(0) else: quantum[i].x(0) quantum[i].h(0) return quantumdef measure(receiver_bases: list, quantum: list): # Change quantum bit for i in range(4): if receiver_bases[i]: quantum[i].h(0) quantum[i].measure(0, 0) else: quantum[i].measure(0, 0) quantum[i].barrier() # Execute backend = qiskit.Aer.get_backend(&quot;statevector_simulator&quot;) result = qiskit.execute(quantum, backend).result().get_counts() return resultdef get_key(qubits: list, bases: list, compare_result: list): measure_result = measure(bases, qubits) for i in range(4): if compare_result[i]: tmp_res = list(measure_result[i].keys()) global key key += str(tmp_res[0])if __name__ == &quot;__main__&quot;: key_len = pickle.loads(cap[0].data.data.binary_value) i = 1 while i &lt; 567: if int(cap[i+1].data.len) == 15: i += 2 continue quantum_state = pickle.loads(cap[i].data.data.binary_value) quantum = recv_quantum(quantum_state) bob_bases = pickle.loads(cap[i+1].data.data.binary_value) alice_judge = pickle.loads(cap[i+2].data.data.binary_value) get_key(quantum, bob_bases, alice_judge) i += 3 key = key[:key_len] msg = BitArray(pikle.loads(cap[567].data.data.binary_value)) plaintext = decrypt_msg(BitArray(&quot;0b&quot;+key), msg) print(plaintext.tobytes()) 得到 Flag: 1d3ctf&#123;y1DcuFuYwCgRfX33uT1lgSy27jYIsF4i&#125; 当然，使用量子状态向量、Bob 的测量基和测量结果的直接对应关系直接得出结果（即不需要模拟）也是可以的。这里不再赘述。","summary":"图源：@しぐれうい 《雨に恋う》 83975808 cap.pcapng用Wireshark打开，清晰可见TCP的三次握手和四次挥手： 于是需要仔细分析中间的数据传输过程。 注意到某些数据包内有“numpy”等字符串： 于是想到可能是某种兼容Python的序列化方法。 又注意到有固定的头部数据： 而pickle序列化时也有固定的头部数据（协议版本4.0）： 于是尝试利用pickle进行反序列化。示例如下： 12345678910import pysharkimport picklecap = pyshark.FileCapture(&#x27;cap.pcapng&#x27;)test_pack = cap[3]data = test_pack.data.data.binary_valuedeserialized = pickle.loads(data)print(deserialized)","date_published":"2021-08-15T11:00:00.000Z","tags":["网络安全","完成编写","CTF","WriteUp"]},{"id":"https://www.zhouweitong.site/post/012-d3ctf-2021-robust-writeup/","url":"https://www.zhouweitong.site/post/012-d3ctf-2021-robust-writeup/","title":"【补档】D^3CTF 2021 - Misc - Robust WriteUp","content_html":"<link rel=\"stylesheet\" type=\"text&#x2F;css\" href=\"https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.5.1/katex.min.css\"><link rel=\"stylesheet\" type=\"text&#x2F;css\" href=\"https://cdn.jsdelivr.net/npm/hexo-tag-hint@0.3.1/dist/hexo-tag-hint.min.css\"><p> 图源：@電瘋扇  《仓鼠松鼠》 <a href=\"https://www.pixiv.net/artworks/91999586\">91999586</a></p>\n<p>“Robust”意为“鲁棒性”。</p>\n<p> 打开 cap.pcapng，发现都是 QUIC 协议的数据包。结合提供的 firefox.log（即使用 firefox 浏览器访问时生成的 SSL Key Log）可以想到基于 QUIC 协议且强制使用 TLS 1.3 的 HTTP3。</p>\n<p> 导入 SSL Key Log：</p>\n<p><img src=\"/2021/08/15/012-d3ctf-2021-robust-writeup/image-20210301153942031.png\" alt=\"image-20210301153942031\"></p>\n<p> 清晰可见 HTTP3 数据包。利用过滤器过滤出所有 HTTP3 数据包，然后从头查看：</p>\n<figure class=\"highlight smali\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">http3</span><br></pre></td></tr></table></figure>\n\n<p><img src=\"/2021/08/15/012-d3ctf-2021-robust-writeup/image-20210301154351049.png\" alt=\"image-20210301154351049\"></p>\n<p> 可以明显看出，642 号包之前的部分是在载入网页和 JavaScript 脚本。在第 642 号包处可以发现一个 m3u8 playlist：</p>\n<p><img src=\"/2021/08/15/012-d3ctf-2021-robust-writeup/image-20210305163835730.png\" alt=\"image-20210305163835730\"></p>\n<span id=\"more\"></span>\n\n<p> 注意到是加密的直播流，因此想到浏览器应该获取到了解密 Key。继续向下分析数据包，在第 648 号数据包处找到解密 Key：</p>\n<p><img src=\"/2021/08/15/012-d3ctf-2021-robust-writeup/image-20210305164439478.png\" alt=\"image-20210305164439478\"></p>\n<p> 复制出来，另存为 enc.key。</p>\n<p> 随后就是找到切片并提取切片了。600 余个数据包，肯定不能手动进行处理（除非你有耐心）。因此依旧借助 pyshark 进行处理。有两种办法：</p>\n<ul>\n<li><p> 通过 HTTP3 数据包的类型和长度，判断每个切片的起始位置，再利用数据包内原始的 m3u8 playlist 和 key 做解密，随后合并。</p>\n</li>\n<li><p> 依据 MPEG-TS 容器格式特性和 AES-128-CBC 加密方式特性，可以先合并，再解密。</p>\n</li>\n</ul>\n<p> 下面以方法二为例解题。</p>\n<p> 编写脚本将所有的 HTTP3 frame payload 提取出来，并依次序写入同一个文件中：</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> pyshark</span><br><span class=\"line\"><span class=\"keyword\">import</span> os</span><br><span class=\"line\"></span><br><span class=\"line\">cap = pyshark.FileCapture(<span class=\"string\">&quot;cap.pcapng&quot;</span>, override_prefs=&#123;<span class=\"string\">&quot;ssl.keylog_file&quot;</span>: os.path.abspath(<span class=\"string\">&quot;firefox.log&quot;</span>)&#125;)</span><br><span class=\"line\">fd = <span class=\"built_in\">open</span>(<span class=\"string\">&quot;output.ts&quot;</span>, <span class=\"string\">&quot;wb&quot;</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> <span class=\"built_in\">range</span>(<span class=\"number\">678</span>, <span class=\"number\">18706</span>):</span><br><span class=\"line\">    <span class=\"keyword\">try</span>:</span><br><span class=\"line\">        <span class=\"keyword\">if</span> <span class=\"built_in\">int</span>(cap[i].http3.frame_type) == <span class=\"number\">0</span>:</span><br><span class=\"line\">            fd.write(cap[i].http3.frame_payload.binary_value)</span><br><span class=\"line\">    <span class=\"keyword\">except</span> Exception:</span><br><span class=\"line\">        <span class=\"keyword\">continue</span></span><br><span class=\"line\"></span><br><span class=\"line\">fd.close()</span><br></pre></td></tr></table></figure>\n\n<p> 之后，构造只含一个切片的 m3u8 playlist：</p>\n<figure class=\"highlight vala\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#EXTM3U</span></span><br><span class=\"line\"><span class=\"meta\">#EXT-X-VERSION:3</span></span><br><span class=\"line\"><span class=\"meta\">#EXT-X-MEDIA-SEQUENCE:0</span></span><br><span class=\"line\"><span class=\"meta\">#EXT-X-PLAYLIST-TYPE:VOD</span></span><br><span class=\"line\"><span class=\"meta\">#EXT-X-KEY:METHOD=AES-128,URI=&quot;enc.key&quot;,IV=0x00000000000000000000000000000000</span></span><br><span class=\"line\"><span class=\"meta\">#EXTINF:10000</span></span><br><span class=\"line\">output.ts</span><br><span class=\"line\"><span class=\"meta\">#EXT-X-ENDLIST</span></span><br></pre></td></tr></table></figure>\n\n<p>EXTINF 可以随意给大，解密密钥的 URI 改为相对路径。随后使用 FFMPEG 进行解密即可。</p>\n<figure class=\"highlight apache\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attribute\">ffmpeg</span> -allowed_extensions <span class=\"literal\">ALL</span> -i index.m<span class=\"number\">3</span>u<span class=\"number\">8</span> -c copy outdec.ts</span><br></pre></td></tr></table></figure>\n\n<p> 你也可以使用 openssl。这里注意，HLS 切片加密时遇到过长的 Key 会截取前 128 位作为加密密钥。</p>\n<figure class=\"highlight css\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">xxd -<span class=\"selector-tag\">P</span> enc<span class=\"selector-class\">.key</span></span><br></pre></td></tr></table></figure>\n\n<p> 得到如下输出：</p>\n<figure class=\"highlight\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">343632386565613630313966323236316132623437346336336637653536</span><br><span class=\"line\">663531383439653831663166353931326538363835663861303461666430</span><br><span class=\"line\">323133640d0a</span><br></pre></td></tr></table></figure>\n\n<p> 取前 128 位进行解密即可：</p>\n<figure class=\"highlight apache\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attribute\">openssl</span> aes-<span class=\"number\">128</span>-cbc -d -in .\\output.ts -out .\\out.ts -iv <span class=\"number\">00000000000000000000000000000000</span> -K <span class=\"number\">34363238656561363031396632323631</span> -nosalt</span><br></pre></td></tr></table></figure>\n\n<p> 随后，解密出的 ts 切片就可以直接播放了。利用 Adobe Audition 查看频谱：</p>\n<p><img src=\"/2021/08/15/012-d3ctf-2021-robust-writeup/image-20210305230017553.png\" alt=\"image-20210305230017553\"></p>\n<p> 很明显这里包含了信息，需要解码。将数据通过转换变为声信号的过程很容易想到拨号上网时需要用到的的“调制解调器”。于是尝试搜索解码工具：</p>\n<p><img src=\"/2021/08/15/012-d3ctf-2021-robust-writeup/image-20210305230530754.png\" alt=\"image-20210305230530754\"></p>\n<p> 发现 quiet 工具（<a href=\"https://github.com/quiet/quiet\">https://github.com/quiet/quiet</a>）具有将数据转换为高频声信号（所谓的“ultrasonic”）的功能。</p>\n<p><img src=\"/2021/08/15/012-d3ctf-2021-robust-writeup/image-20210305230820162.png\" alt=\"image-20210305230820162\"></p>\n<p> 随后，clone 两个 repo：quiet/libfec 和 quiet/quiet，编译即可。编译过程略。</p>\n<p> 在默认配置文件 quiet-profiles.json 中，有多个以 ultrasonic 开头的配置。这时回到 Audition，仔细观察频谱频率：</p>\n<p><img src=\"/2021/08/15/012-d3ctf-2021-robust-writeup/image-20210305231221367.png\" alt=\"image-20210305231221367\"></p>\n<p> 频谱很明显以 19KHz 为中心，这与 ultrasonic 配置文件的配置相吻合：</p>\n<p><img src=\"/2021/08/15/012-d3ctf-2021-robust-writeup/image-20210305231333881.png\" alt=\"image-20210305231333881\"></p>\n<p> 因此可以确定使用了该配置文件。</p>\n<p> 随后进行解码。可以直接使用 quiet 的 API，当然也可使用 quiet 的示例程序。阅读示例程序代码 decode_file.c：</p>\n<p><img src=\"/2021/08/15/012-d3ctf-2021-robust-writeup/image-20210305231550128.png\" alt=\"image-20210305231550128\"></p>\n<p><img src=\"/2021/08/15/012-d3ctf-2021-robust-writeup/image-20210305231736623.png\" alt=\"image-20210305231736623\"></p>\n<p> 需要将待解码的文件转化为 wav 格式，且重命名为 encoded.wav。联想到题目的“Robust”，意即“鲁棒性”，因此大胆直接转码。但是为了不丢失数据，保险起见，保持原采样率和最高量化位数：</p>\n<p><img src=\"/2021/08/15/012-d3ctf-2021-robust-writeup/image-20210305231940753.png\" alt=\"image-20210305231940753\"></p>\n<p> 随后解码：</p>\n<figure class=\"highlight ada\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">./quiet_decode_file ultrasonic <span class=\"keyword\">out</span>.txt</span><br></pre></td></tr></table></figure>\n\n<p><img src=\"/2021/08/15/012-d3ctf-2021-robust-writeup/image-20210305232408000.png\" alt=\"image-20210305232408000\"></p>\n<p> 得到 Base64，解码发现 PK 头，保存为 Zip，打开，发现有密码：</p>\n<p><img src=\"/2021/08/15/012-d3ctf-2021-robust-writeup/image-20210305232932437.png\" alt=\"image-20210305232932437\"></p>\n<p> 根据文件名称，联想到网易云音乐的歌词。至于是哪首歌的歌词，联想到网易云音乐有歌曲的“Song ID”。因此首先找到歌曲：</p>\n<p><a href=\"https://music.163.com/song?id=1818031620\">https://music.163.com/song?id=1818031620</a></p>\n<p> 随后提取歌词。</p>\n<p> 方法一：利用网页 API。F12 仔细分析即可找到歌词获取接口。例子如下：</p>\n<figure class=\"highlight apache\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attribute\">https</span>://music.<span class=\"number\">163</span>.com/weapi/song/lyric?csrf_token=<span class=\"number\">7</span>ab<span class=\"number\">6599</span>ebc<span class=\"number\">00854</span>e<span class=\"number\">324</span>f<span class=\"number\">6</span>dcf<span class=\"number\">04353358</span></span><br></pre></td></tr></table></figure>\n\n<p> 将网页内容保存为 lyric-1818031620.json 文件即可。</p>\n<p> 方法二：利用网易云音乐客户端缓存。容易找到缓存歌词的文件夹（以 Windows 系统为例）：C:\\Users\\ObjectNotFound\\AppData\\Local\\Netease\\CloudMusic\\webdata\\lyric</p>\n<p><img src=\"/2021/08/15/012-d3ctf-2021-robust-writeup/image-20210305233650533.png\" alt=\"image-20210305233650533\"></p>\n<p> 将该文件复制出来改名为 lyric-1818031620.json 即可。</p>\n<p> 然后就可以进行明文攻击了。可以使用 Advanced Archive Password Recovery，也可以使用 pkcrack。注意 Zip 的压缩算法设置。</p>\n<p><img src=\"/2021/08/15/012-d3ctf-2021-robust-writeup/image-20210305234301248.png\" alt=\"image-20210305234301248\"></p>\n<p><img src=\"/2021/08/15/012-d3ctf-2021-robust-writeup/image-20210305234324948.png\" alt=\"image-20210305234324948\"></p>\n<p> 得到 txt 文档的内容：</p>\n<p><img src=\"/2021/08/15/012-d3ctf-2021-robust-writeup/image-20210305234424081.png\" alt=\"image-20210305234424081\"></p>\n<p> 换用其他软件查看，发现存在空白字符隐写：</p>\n<p><img src=\"/2021/08/15/012-d3ctf-2021-robust-writeup/image-20210305234539937.png\" alt=\"image-20210305234539937\"></p>\n<p> 利用工具解密即可。注意选择正确的解码设置。可以使用十六进制编辑器的查找功能确定使用的编码字符。</p>\n<p><a href=\"https://330k.github.io/misc_tools/unicode_steganography.html\">https://330k.github.io/misc_tools/unicode_steganography.html</a></p>\n<p><img src=\"/2021/08/15/012-d3ctf-2021-robust-writeup/image-20210306001813253.png\" alt=\"image-20210306001813253\"></p>\n<p> 得到解码结果：</p>\n<figure class=\"highlight elixir\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;~A2<span class=\"variable\">@_</span>;ApZ7(GA0]MC.i&amp;<span class=\"symbol\">:F%<span class=\"string\">&#x27;t#:JXSd=tj-$&gt;&#x27;</span>EtK0m</span>.<span class=\"number\">1</span>t0i38~&gt;</span><br></pre></td></tr></table></figure>\n\n<p> 由定界符 &lt;~ ~&gt; 易知其为 Base85 编码。解码可得 Flag：</p>\n<figure class=\"highlight apache\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attribute\">d3ctf</span>&#123;<span class=\"number\">1</span>IwiKUjKcUsEn<span class=\"number\">0</span>OOJZZ<span class=\"number\">0</span>ZsZwUX<span class=\"number\">1</span>uiC<span class=\"number\">1</span>P&#125;</span><br></pre></td></tr></table></figure>\n\n","content_text":"图源：@電瘋扇 《仓鼠松鼠》 91999586 “Robust”意为“鲁棒性”。 打开 cap.pcapng，发现都是 QUIC 协议的数据包。结合提供的 firefox.log（即使用 firefox 浏览器访问时生成的 SSL Key Log）可以想到基于 QUIC 协议且强制使用 TLS 1.3 的 HTTP3。 导入 SSL Key Log： 清晰可见 HTTP3 数据包。利用过滤器过滤出所有 HTTP3 数据包，然后从头查看： 1http3 可以明显看出，642 号包之前的部分是在载入网页和 JavaScript 脚本。在第 642 号包处可以发现一个 m3u8 playlist： 注意到是加密的直播流，因此想到浏览器应该获取到了解密 Key。继续向下分析数据包，在第 648 号数据包处找到解密 Key： 复制出来，另存为 enc.key。 随后就是找到切片并提取切片了。600 余个数据包，肯定不能手动进行处理（除非你有耐心）。因此依旧借助 pyshark 进行处理。有两种办法： 通过 HTTP3 数据包的类型和长度，判断每个切片的起始位置，再利用数据包内原始的 m3u8 playlist 和 key 做解密，随后合并。 依据 MPEG-TS 容器格式特性和 AES-128-CBC 加密方式特性，可以先合并，再解密。 下面以方法二为例解题。 编写脚本将所有的 HTTP3 frame payload 提取出来，并依次序写入同一个文件中： 123456789101112131415import pysharkimport oscap = pyshark.FileCapture(&quot;cap.pcapng&quot;, override_prefs=&#123;&quot;ssl.keylog_file&quot;: os.path.abspath(&quot;firefox.log&quot;)&#125;)fd = open(&quot;output.ts&quot;, &quot;wb&quot;)for i in range(678, 18706): try: if int(cap[i].http3.frame_type) == 0: fd.write(cap[i].http3.frame_payload.binary_value) except Exception: continuefd.close() 之后，构造只含一个切片的 m3u8 playlist： 12345678#EXTM3U#EXT-X-VERSION:3#EXT-X-MEDIA-SEQUENCE:0#EXT-X-PLAYLIST-TYPE:VOD#EXT-X-KEY:METHOD=AES-128,URI=&quot;enc.key&quot;,IV=0x00000000000000000000000000000000#EXTINF:10000output.ts#EXT-X-ENDLIST EXTINF 可以随意给大，解密密钥的 URI 改为相对路径。随后使用 FFMPEG 进行解密即可。 1ffmpeg -allowed_extensions ALL -i index.m3u8 -c copy outdec.ts 你也可以使用 openssl。这里注意，HLS 切片加密时遇到过长的 Key 会截取前 128 位作为加密密钥。 1xxd -P enc.key 得到如下输出： 123343632386565613630313966323236316132623437346336336637653536663531383439653831663166353931326538363835663861303461666430323133640d0a 取前 128 位进行解密即可： 1openssl aes-128-cbc -d -in .\\output.ts -out .\\out.ts -iv 00000000000000000000000000000000 -K 34363238656561363031396632323631 -nosalt 随后，解密出的 ts 切片就可以直接播放了。利用 Adobe Audition 查看频谱： 很明显这里包含了信息，需要解码。将数据通过转换变为声信号的过程很容易想到拨号上网时需要用到的的“调制解调器”。于是尝试搜索解码工具： 发现 quiet 工具（https://github.com/quiet/quiet）具有将数据转换为高频声信号（所谓的“ultrasonic”）的功能。 随后，clone 两个 repo：quiet/libfec 和 quiet/quiet，编译即可。编译过程略。 在默认配置文件 quiet-profiles.json 中，有多个以 ultrasonic 开头的配置。这时回到 Audition，仔细观察频谱频率： 频谱很明显以 19KHz 为中心，这与 ultrasonic 配置文件的配置相吻合： 因此可以确定使用了该配置文件。 随后进行解码。可以直接使用 quiet 的 API，当然也可使用 quiet 的示例程序。阅读示例程序代码 decode_file.c： 需要将待解码的文件转化为 wav 格式，且重命名为 encoded.wav。联想到题目的“Robust”，意即“鲁棒性”，因此大胆直接转码。但是为了不丢失数据，保险起见，保持原采样率和最高量化位数： 随后解码： 1./quiet_decode_file ultrasonic out.txt 得到 Base64，解码发现 PK 头，保存为 Zip，打开，发现有密码： 根据文件名称，联想到网易云音乐的歌词。至于是哪首歌的歌词，联想到网易云音乐有歌曲的“Song ID”。因此首先找到歌曲： https://music.163.com/song?id=1818031620 随后提取歌词。 方法一：利用网页 API。F12 仔细分析即可找到歌词获取接口。例子如下： 1https://music.163.com/weapi/song/lyric?csrf_token=7ab6599ebc00854e324f6dcf04353358 将网页内容保存为 lyric-1818031620.json 文件即可。 方法二：利用网易云音乐客户端缓存。容易找到缓存歌词的文件夹（以 Windows 系统为例）：C:\\Users\\ObjectNotFound\\AppData\\Local\\Netease\\CloudMusic\\webdata\\lyric 将该文件复制出来改名为 lyric-1818031620.json 即可。 然后就可以进行明文攻击了。可以使用 Advanced Archive Password Recovery，也可以使用 pkcrack。注意 Zip 的压缩算法设置。 得到 txt 文档的内容： 换用其他软件查看，发现存在空白字符隐写： 利用工具解密即可。注意选择正确的解码设置。可以使用十六进制编辑器的查找功能确定使用的编码字符。 https://330k.github.io/misc_tools/unicode_steganography.html 得到解码结果： 1&lt;~A2@_;ApZ7(GA0]MC.i&amp;:F%&#x27;t#:JXSd=tj-$&gt;&#x27;EtK0m.1t0i38~&gt; 由定界符 &lt;~ ~&gt; 易知其为 Base85 编码。解码可得 Flag： 1d3ctf&#123;1IwiKUjKcUsEn0OOJZZ0ZsZwUX1uiC1P&#125;","summary":"图源：@電瘋扇 《仓鼠松鼠》 91999586 “Robust”意为“鲁棒性”。 打开cap.pcapng，发现都是QUIC协议的数据包。结合提供的firefox.log（即使用firefox浏览器访问时生成的SSL Key Log）可以想到基于QUIC协议且强制使用TLS 1.3的HTTP3。 导入SSL Key Log： 清晰可见HTTP3数据包。利用过滤器过滤出所有HTTP3数据包，然后从头查看： 1http3 可以明显看出，642号包之前的部分是在载入网页和JavaScript脚本。在第642号包处可以发现一个m3u8 playlist：","date_published":"2021-08-15T04:00:00.000Z","tags":["网络安全","完成编写","CTF","WriteUp"]},{"id":"https://www.zhouweitong.site/post/028-c-programming-gaps-filling/","url":"https://www.zhouweitong.site/post/028-c-programming-gaps-filling/","title":"【WIP】C 语言拾遗 Part.1","content_html":"<link rel=\"stylesheet\" type=\"text&#x2F;css\" href=\"https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.5.1/katex.min.css\"><link rel=\"stylesheet\" type=\"text&#x2F;css\" href=\"https://cdn.jsdelivr.net/npm/hexo-tag-hint@0.3.1/dist/hexo-tag-hint.min.css\"><h2 id=\"long- 与 -long-long\"><a href=\"#long- 与 -long-long\" class=\"headerlink\" title=\"long 与 long long\"></a>long 与 long long</h2><p>long 一般占用 4~8 字节，long long <strong>至少</strong> 占用 8 个字节。不同的平台和编译器，长度可能不同。</p>\n<h2 id=\"sizeof- 运算符\"><a href=\"#sizeof- 运算符\" class=\"headerlink\" title=\"sizeof() 运算符\"></a>sizeof() 运算符 </h2><p> 注意 sizeof() 属于运算符的一种，这个运算符用于测量括号内的变量（或类型）占用的字节数量。多数情况下，这一数量在编译时确定，因此 sizeof() 的运行结果是一个编译时常量。但也有例外，如 C99 标准引入的变长数组特性。该类数组的 size 需在程序运行时、数组开辟后确定。</p>\n<p>由于是编译时常量，括号内如果是表达式，则表达式不会被执行。</p>\n<figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">int</span> a = <span class=\"number\">1</span>; <span class=\"comment\">// a = 1</span></span><br><span class=\"line\"><span class=\"keyword\">int</span> b = <span class=\"keyword\">sizeof</span>(a++); <span class=\"comment\">// b = 4</span></span><br><span class=\"line\"><span class=\"comment\">// a = 1, a++ 没有执行</span></span><br></pre></td></tr></table></figure>\n\n<h2 id=\"浮点数精度问题\"><a href=\"# 浮点数精度问题\" class=\"headerlink\" title=\"浮点数精度问题\"></a>浮点数精度问题 </h2><p> 老生长谈的话题了。由于误差，以下的逻辑判断结果都是成立（1）：</p>\n<figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">(<span class=\"number\">0.1</span> + <span class=\"number\">0.1</span> + <span class=\"number\">0.1</span>) != <span class=\"number\">0.3</span>; <span class=\"comment\">// 1;</span></span><br><span class=\"line\"><span class=\"number\">1</span> + (<span class=\"number\">1e123</span> - <span class=\"number\">1e123</span>) != (<span class=\"number\">1</span> + <span class=\"number\">1e123</span>) - <span class=\"number\">1e123</span>; <span class=\"comment\">// 1;</span></span><br></pre></td></tr></table></figure>\n\n<h2 id=\"没有 -body- 的 -for- 循环\"><a href=\"# 没有 -body- 的 -for- 循环\" class=\"headerlink\" title=\"没有 body 的 for 循环\"></a>没有 body 的 for 循环 </h2><p> 可以写成如下形式：</p>\n<figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">for</span>(i = <span class=\"number\">0</span>; i &lt; <span class=\"number\">10</span>; i++) &#123;</span><br><span class=\"line\">    ;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>或者如下形式：</p>\n<figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">for</span>(i = <span class=\"number\">0</span>; i &lt; <span class=\"number\">10</span>; i++);</span><br></pre></td></tr></table></figure>\n\n<span id=\"more\"></span>\n\n<h2 id=\"三目运算符\"><a href=\"# 三目运算符\" class=\"headerlink\" title=\"三目运算符\"></a>三目运算符</h2><figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">a ? b : c</span><br></pre></td></tr></table></figure>\n\n<p>等价于</p>\n<figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">if</span>(a)&#123;</span><br><span class=\"line\">    b;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"keyword\">else</span>&#123;</span><br><span class=\"line\">    c;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>这没什么可说的。</p>\n<h2 id=\"面条式代码\"><a href=\"# 面条式代码\" class=\"headerlink\" title=\"面条式代码\"></a>面条式代码 </h2><p><a href=\"https://en.wikipedia.org/wiki/Spaghetti_code\"> 面条式代码（Spaghetti code）</a>最初指代码过度使用 <code>goto</code> 等破坏程序结构化（顺序结构、选择结构、循环结构）的关键字的代码。现也泛指不满足项目代码规范的代码、缺乏代码风格的代码、项目要求经常变化导致过度冗余的代码或缺乏项目编程经验者写出的代码。</p>\n<h2 id=\"limits-h\"><a href=\"#limits-h\" class=\"headerlink\" title=\"limits.h\"></a>limits.h</h2><p>C 语言标准库之一，包含了常见数据类型的数据上界和数据下界。节选代码：</p>\n<figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/* Maximum value an `unsigned char&#x27; can hold.  (Minimum is 0).  */</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">undef</span> UCHAR_MAX</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> UCHAR_MAX 255</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/* Minimum and maximum values a `char&#x27; can hold.  */</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">ifdef</span> __CHAR_UNSIGNED__</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">undef</span> CHAR_MIN</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> CHAR_MIN 0</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">undef</span> CHAR_MAX</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> CHAR_MAX 255</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">else</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">undef</span> CHAR_MIN</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> CHAR_MIN (-128)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">undef</span> CHAR_MAX</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> CHAR_MAX 127</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">endif</span></span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/* Minimum and maximum values a `signed short int&#x27; can hold.  */</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">undef</span> SHRT_MIN</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> SHRT_MIN (-32768)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">undef</span> SHRT_MAX</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> SHRT_MAX 32767</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/* Maximum value an `unsigned short int&#x27; can hold.  (Minimum is 0).  */</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">undef</span> USHRT_MAX</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> USHRT_MAX 65535</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/* Minimum and maximum values a `signed int&#x27; can hold.  */</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">ifndef</span> __INT_MAX__</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> __INT_MAX__ 2147483647</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">endif</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">undef</span> INT_MIN</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> INT_MIN (-INT_MAX-1)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">undef</span> INT_MAX</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> INT_MAX __INT_MAX__</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/* Maximum value an `unsigned int&#x27; can hold.  (Minimum is 0).  */</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">undef</span> UINT_MAX</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> UINT_MAX (INT_MAX * 2U + 1)</span></span><br></pre></td></tr></table></figure>\n\n<h2 id=\"十六进制和 -printf\"><a href=\"# 十六进制和 -printf\" class=\"headerlink\" title=\"十六进制和 printf\"></a>十六进制和 printf</h2><p>十六进制可以直接用于赋值。比如下列语句可将 a 赋值为 1：</p>\n<figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">int</span> a = <span class=\"number\">0x01</span>;</span><br></pre></td></tr></table></figure>\n\n<p>要注意 <code>printf</code> 在进行格式化输出的时候，<code>float</code>和 <code>double</code> 类型都可以用 <code>%f</code>，而<code>dobule</code> 类型也可以用 <code>%lf</code>。<code>long double</code> 类型需要使用<code>%Lf</code>。</p>\n<p>具体标准（C99）如下：</p>\n<p><img src=\"/2021/08/12/028-c-programming-gaps-filling/image-20210409173302756.png\" alt=\"image-20210409173302756\"></p>\n<p><img src=\"/2021/08/12/028-c-programming-gaps-filling/image-20210409173314667.png\" alt=\"image-20210409173314667\"></p>\n<p><img src=\"/2021/08/12/028-c-programming-gaps-filling/image-20210409173324188.png\" alt=\"image-20210409173324188\"></p>\n<h2 id=\"多行注释的问题\"><a href=\"# 多行注释的问题\" class=\"headerlink\" title=\"多行注释的问题\"></a>多行注释的问题 </h2><p> 注意 C 语言的多行注释是不会嵌套的。看下面的例子：</p>\n<figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/*</span></span><br><span class=\"line\"><span class=\"comment\">Change &quot;username&quot; and &quot;password&quot; to /* your account&#x27;s identity. */</span></span><br><span class=\"line\">Enjoy!</span><br><span class=\"line\">*/</span><br></pre></td></tr></table></figure>\n\n<p>多行注释自 <strong> 第一个 /* 起 </strong>，至<strong> 第一个 */ 止 </strong>，中间的一切 /* 均做注释内字符串而不是多行注释起始符进行处理。如上面例子，多行注释在第二行截止，第三行的<code>Enjoy!</code> 和第四行的 <code>*/</code> 均不在多行注释内。</p>\n","content_text":"long 与 long longlong 一般占用 4~8 字节，long long 至少 占用 8 个字节。不同的平台和编译器，长度可能不同。 sizeof() 运算符 注意 sizeof() 属于运算符的一种，这个运算符用于测量括号内的变量（或类型）占用的字节数量。多数情况下，这一数量在编译时确定，因此 sizeof() 的运行结果是一个编译时常量。但也有例外，如 C99 标准引入的变长数组特性。该类数组的 size 需在程序运行时、数组开辟后确定。 由于是编译时常量，括号内如果是表达式，则表达式不会被执行。 123int a = 1; // a = 1int b = sizeof(a++); // b = 4// a = 1, a++ 没有执行 浮点数精度问题 老生长谈的话题了。由于误差，以下的逻辑判断结果都是成立（1）： 12(0.1 + 0.1 + 0.1) != 0.3; // 1;1 + (1e123 - 1e123) != (1 + 1e123) - 1e123; // 1; 没有 body 的 for 循环 可以写成如下形式： 123for(i = 0; i &lt; 10; i++) &#123; ;&#125; 或者如下形式： 1for(i = 0; i &lt; 10; i++); 三目运算符1a ? b : c 等价于 123456if(a)&#123; b;&#125;else&#123; c;&#125; 这没什么可说的。 面条式代码 面条式代码（Spaghetti code）最初指代码过度使用 goto 等破坏程序结构化（顺序结构、选择结构、循环结构）的关键字的代码。现也泛指不满足项目代码规范的代码、缺乏代码风格的代码、项目要求经常变化导致过度冗余的代码或缺乏项目编程经验者写出的代码。 limits.hC 语言标准库之一，包含了常见数据类型的数据上界和数据下界。节选代码： 123456789101112131415161718192021222324252627282930313233343536373839/* Maximum value an `unsigned char&#x27; can hold. (Minimum is 0). */#undef UCHAR_MAX#define UCHAR_MAX 255/* Minimum and maximum values a `char&#x27; can hold. */#ifdef __CHAR_UNSIGNED__#undef CHAR_MIN#define CHAR_MIN 0#undef CHAR_MAX#define CHAR_MAX 255#else#undef CHAR_MIN#define CHAR_MIN (-128)#undef CHAR_MAX#define CHAR_MAX 127#endif/* Minimum and maximum values a `signed short int&#x27; can hold. */#undef SHRT_MIN#define SHRT_MIN (-32768)#undef SHRT_MAX#define SHRT_MAX 32767/* Maximum value an `unsigned short int&#x27; can hold. (Minimum is 0). */#undef USHRT_MAX#define USHRT_MAX 65535/* Minimum and maximum values a `signed int&#x27; can hold. */#ifndef __INT_MAX__#define __INT_MAX__ 2147483647#endif#undef INT_MIN#define INT_MIN (-INT_MAX-1)#undef INT_MAX#define INT_MAX __INT_MAX__/* Maximum value an `unsigned int&#x27; can hold. (Minimum is 0). */#undef UINT_MAX#define UINT_MAX (INT_MAX * 2U + 1) 十六进制和 printf十六进制可以直接用于赋值。比如下列语句可将 a 赋值为 1： 1int a = 0x01; 要注意 printf 在进行格式化输出的时候，float和 double 类型都可以用 %f，而dobule 类型也可以用 %lf。long double 类型需要使用%Lf。 具体标准（C99）如下： 多行注释的问题 注意 C 语言的多行注释是不会嵌套的。看下面的例子： 1234/*Change &quot;username&quot; and &quot;password&quot; to /* your account&#x27;s identity. */Enjoy!*/ 多行注释自 第一个 /* 起 ，至 第一个 */ 止 ，中间的一切 /* 均做注释内字符串而不是多行注释起始符进行处理。如上面例子，多行注释在第二行截止，第三行的Enjoy! 和第四行的 */ 均不在多行注释内。","summary":"long 与 long longlong 一般占用4~8字节，long long 至少 占用8个字节。不同的平台和编译器，长度可能不同。 sizeof() 运算符注意 sizeof() 属于运算符的一种，这个运算符用于测量括号内的变量（或类型）占用的字节数量。多数情况下，这一数量在编译时确定，因此 sizeof() 的运行结果是一个编译时常量。但也有例外，如C99标准引入的变长数组特性。该类数组的size需在程序运行时、数组开辟后确定。 由于是编译时常量，括号内如果是表达式，则表达式不会被执行。 123int a = 1; // a = 1int b = sizeof(a++); // b = 4// a = 1, a++ 没有执行 浮点数精度问题老生长谈的话题了。由于误差，以下的逻辑判断结果都是成立（1）： 12(0.1 + 0.1 + 0.1) != 0.3; // 1;1 + (1e123 - 1e123) != (1 + 1e123) - 1e123; // 1; 没有 body 的 for 循环可以写成如下形式： 123for(i = 0; i &lt; 10; i++) &#123; ;&#125; 或者如下形式： 1for(i = 0; i &lt; 10; i++);","date_published":"2021-08-12T07:00:00.000Z","tags":["开发与代码","笔记","WIP","C"]},{"id":"https://www.zhouweitong.site/post/011-rime-1-intro/","url":"https://www.zhouweitong.site/post/011-rime-1-intro/","title":"Rime（1）：介绍与安装","content_html":"<link rel=\"stylesheet\" type=\"text&#x2F;css\" href=\"https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.5.1/katex.min.css\"><link rel=\"stylesheet\" type=\"text&#x2F;css\" href=\"https://cdn.jsdelivr.net/npm/hexo-tag-hint@0.3.1/dist/hexo-tag-hint.min.css\"><p>图源：@爱卿 《夏》 <a href=\"https://www.pixiv.net/artworks/82079855\">82079855</a></p>\n<h2 id=\"什么是 -Rime？\"><a href=\"# 什么是 -Rime？\" class=\"headerlink\" title=\"什么是 Rime？\"></a>什么是 Rime？</h2><p>RIME，官方中文名称为“中州韻”（即“中州韵”，中原之韵），是一款开源的轻量的跨平台输入法库，由佛振等人开发。源代码现托管在 Github 上：<a href=\"https://github.com/rime/librime\">rime/librime</a>。Rime 具有很强的扩展性和可定制性——你可以使用 Lua <strong>编写它的插件 </strong>，也可以通过自定义配置文件实现自己研发的、更加高效的<strong> 汉字输入方案 </strong>，或者实现<strong> 多语言混合输入 </strong>，又或者你只是想在各个平台上获得<strong> 统一的文字输入体验</strong>。这一特性使得强大的 Rime 在使用上拥有无限的可能性。本文是 Rime 系列的第一篇，主要记录 Rime 在各个平台下的安装，及其基础的使用方法。</p>\n<h2 id=\"如何安装 -Rime？\"><a href=\"# 如何安装 -Rime？\" class=\"headerlink\" title=\"如何安装 Rime？\"></a>如何安装 Rime？</h2><p>Librime 是一个开源的输入法库。库像是一种”后端“，不能直接用于文字输入。需要和配套的“前端”（一说“发行版”）一起使用。“前端”也已有不少实现，列举使用人数较多的输入法“前端”如下：</p>\n<ul>\n<li><a href=\"https://github.com/rime/squirrel\">rime/squirrel</a>，中文名为“鼠须管”，macOS 下的输入法前端；</li>\n<li><a href=\"https://github.com/rime/weasel\">rime/weasel</a>，中文名为“小狼毫”，Windows 下的输入法前端；</li>\n<li><a href=\"https://github.com/osfans/trime\">osfans/trime</a>，中文名为“同文输入法”，Android 下的输入法前端；</li>\n<li><a href=\"https://github.com/jimmy54/iRime\">jimmy54/iRime</a>，中文名为“iRime 输入法”，iOS 下的输入法前端，注意有应用内购付费，而且有人反映其并未严格按照 Rime 前端统一的规范加载配置文件；</li>\n<li><a href=\"https://github.com/rime/ibus-rime\">rime/ibus-rime</a>，Linux 下的输入法前端，基于 IBus；</li>\n<li><a href=\"https://github.com/fcitx/fcitx-rime\">fcitx-rime</a>，Linux 下的输入法前端，基于 Fcitx</li>\n</ul>\n<p>或者你也可以利用 librime，编写自己的输入法前端。</p>\n<h3 id=\"Windows-Weasel\"><a href=\"#Windows-Weasel\" class=\"headerlink\" title=\"Windows - Weasel\"></a>Windows - Weasel</h3><p>Weasel 可以直接在 Rime 的官网下载安装，也可以手动编译安装。截止本文写作之时，Rime 官方发布的稳定版本为 0.14.3，采用 librime 1.5.3 版本，更新于 2019 年 6 月 22 日。而 librime 的最新版本已迭代至了 1.7.2，修复了不少错误并且向后兼容。因此强烈推荐手动编译新版本并安装。</p>\n<p>编译所需环境：</p>\n<ul>\n<li>Visual Studio 2017</li>\n<li>Boost 1.69.0</li>\n<li>CMake</li>\n<li>NSIS</li>\n<li>Git、7z、Wget for Windows 等常见工具</li>\n</ul>\n<p>下面简单叙述步骤。</p>\n<span id=\"more\"></span>\n\n<p>第一步：Clone 项目，下载并更新子模块为最新。</p>\n<figure class=\"highlight cmd\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">git clone --recursive https://github.com/rime/weasel.git</span><br><span class=\"line\"><span class=\"built_in\">cd</span> weasel\\</span><br><span class=\"line\">git submodule update --remote --recursive</span><br></pre></td></tr></table></figure>\n\n<p>第二步：修正 NSIS 配置文件错误。找到<code>output\\install.nsi</code>，修改第 159 行的：</p>\n<figure class=\"highlight nsis\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">File</span> <span class=\"string\">&quot;data\\opencc\\*.ocd&quot;</span></span><br></pre></td></tr></table></figure>\n\n<p>为：</p>\n<figure class=\"highlight nsis\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">File</span> <span class=\"string\">&quot;data\\opencc\\*.ocd2&quot;</span></span><br></pre></td></tr></table></figure>\n\n<p>这是因为新版本的 opencc 使用 ocd2 作为字典格式，而不是老版本的 ocd 格式。</p>\n<p>第三步：设置环境变量。包括编译器版本、工具集、Boost 位置、librime 编译成品的版本号（可从 <a href=\"https://github.com/rime/librime/releases\">librime 的 Release 页</a> 查询）、下载链接等。根据实际情况和版本需要进行修改。</p>\n<p>如果你不想通过命令行下载 librime，也可使用浏览器下载后，参照第四步所述命令手动将所需文件放置于指定位置。</p>\n<figure class=\"highlight cmd\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">set</span> BOOST_ROOT=C:\\Libraries\\boost_1_69_0</span><br><span class=\"line\"><span class=\"built_in\">set</span> CMAKE_GENERATOR=&quot;Visual Studio <span class=\"number\">15</span> <span class=\"number\">2017</span>&quot;</span><br><span class=\"line\"><span class=\"built_in\">set</span> PLATFORM_TOOLSET=v141_xp</span><br><span class=\"line\"><span class=\"built_in\">set</span> rime_version=<span class=\"number\">1</span>.<span class=\"number\">7</span>.<span class=\"number\">3</span></span><br><span class=\"line\"><span class=\"built_in\">set</span> rime_variant=rime-with-plugins</span><br><span class=\"line\"><span class=\"built_in\">set</span> download_archive=<span class=\"variable\">%rime_variant%</span>-<span class=\"variable\">%rime_version%</span>-win32.zip</span><br><span class=\"line\"><span class=\"built_in\">set</span> WEASEL_BUILD=<span class=\"number\">20210309</span></span><br></pre></td></tr></table></figure>\n\n<p>推荐下载支持 Lua 插件扩展的 rime-with-plugin 版本。</p>\n<p>第四步：下载编译好的 librime 并复制文件。</p>\n<figure class=\"highlight cmd\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">wget https://github.com/rime/librime/releases/download/<span class=\"variable\">%rime_version%</span>/<span class=\"variable\">%download_archive%</span></span><br><span class=\"line\"><span class=\"number\">7</span>z x <span class=\"variable\">%download_archive%</span> * -y -olibrime</span><br><span class=\"line\"><span class=\"built_in\">copy</span> /Y librime\\dist\\include\\rime_*.h include\\</span><br><span class=\"line\"><span class=\"built_in\">copy</span> /Y librime\\dist\\lib\\rime.lib lib\\</span><br><span class=\"line\"><span class=\"built_in\">copy</span> /Y librime\\dist\\lib\\rime.dll output\\</span><br><span class=\"line\"><span class=\"keyword\">if</span> <span class=\"keyword\">not</span> <span class=\"keyword\">exist</span> output\\data\\opencc <span class=\"built_in\">mkdir</span> output\\data\\opencc</span><br><span class=\"line\"><span class=\"built_in\">copy</span> /Y librime\\thirdparty\\share\\opencc\\*.* output\\data\\opencc\\</span><br></pre></td></tr></table></figure>\n\n<p>第五步：编译 Boost 环境。直接使用为 AppVeyor 编写的编译脚本即可。</p>\n<figure class=\"highlight cmd\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">.\\appveyor_build_boost.bat</span><br></pre></td></tr></table></figure>\n\n<p>第六步：编译主程序。</p>\n<figure class=\"highlight cmd\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">.\\build.bat data hant weasel installer</span><br></pre></td></tr></table></figure>\n\n<p>随后在 output 文件夹中即可找到编译完成的安装文件。双击进行安装即可。</p>\n<p>安装时会弹出设置选项：</p>\n<p><img src=\"/2021/06/19/011-rime-1-intro/upload_f826d10519ce09ddc6ba865cf7cbd827.png\"></p>\n<p>用户资料夹即为下文提到的“用户资料路径”，如果你想直接开始使用，选择默认方案为“中文（简体）”就可以了。</p>\n<p>安装完成后，需要留意以下三个路径：</p>\n<ul>\n<li>默认数据路径：默认为<code>C:\\Program Files (x86)\\Rime\\weasel-$ 版本号</code></li>\n<li>用户数据路径：默认为<code>C:\\Users\\$ 用户名 \\AppData\\Roaming\\Rime</code></li>\n<li>同步路径：默认为<code>C:\\Users\\$ 用户名 \\AppData\\Roaming\\Rime\\sync\\$ 安装 ID</code></li>\n</ul>\n<p>这两个路径对后续 Rime 的配置有很大用处。</p>\n<h3 id=\"Linux-Ibus-rime\"><a href=\"#Linux-Ibus-rime\" class=\"headerlink\" title=\"Linux - Ibus-rime\"></a>Linux - Ibus-rime</h3><p>Linux 下的前端有两个，一个是基于 Fcitx 的 fcitx-rime，既支持 Fcitx 4，也支持新开发的 Fcitx 5。但缺点是 <strong> 无法同步输入法的用户数据</strong>。另一个是基于的 Ibus 的 ibus-rime，可以同步输入法的用户数据。以下以 Ubuntu 环境为例，配置 ibus 和 ibus-rime。</p>\n<p>安装十分简单，ibus 已包含于官方源中：</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo apt install ibus ibus-rime</span><br></pre></td></tr></table></figure>\n\n<p><img src=\"/2021/06/19/011-rime-1-intro/upload_379b6906a280b9b2af1504f6823f7c44.png\"></p>\n<p>安装完毕后重启系统，打开设置 - 区域与语言 - 输入源 - 加号（+），在弹出的窗口中选择汉语（中国）- 中文（Rime），点击添加。</p>\n<p><img src=\"/2021/06/19/011-rime-1-intro/upload_b492eb51adaef672ef649a98e2f42575.png\"></p>\n<p>随后在任务栏右上角切换输入法即可激活 ibus-rime。</p>\n<p>当然你也有可能遇到 ibus 在某些应用程序中不可用的问题，一般只要在 <code>~/.bashrc</code> 中加入如下的设置环境变量命令即可。</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">export</span> GTK_IM_MODULE=ibus</span><br><span class=\"line\"><span class=\"built_in\">export</span> XMODIFIERS=@im=ibus</span><br><span class=\"line\"><span class=\"built_in\">export</span> QT_IM_MODULE=ibus</span><br></pre></td></tr></table></figure>\n\n<p>注意：有些发行版的 ibus-rime 在安装时会附带依赖 librime-data，其中包含了 rime 默认的输入方案，如朙月拼音、仓颉、五笔等，可“开箱即用”。但由于不是所有发行版都有这种依赖，后文的基本配置环节将建立在无默认输入方案的基础之上。</p>\n<p>对于 ibus-rime 来说，三个重要路径如下：</p>\n<ul>\n<li>默认数据路径：<code>/usr/share/rime-data</code></li>\n<li>用户数据路径：<code>~/.config/ibus/rime</code></li>\n<li>同步路径：<code>~/.config/ibus/rime/sync/$ 安装 ID</code></li>\n</ul>\n<h3 id=\"Android-Trime\"><a href=\"#Android-Trime\" class=\"headerlink\" title=\"Android - Trime\"></a>Android - Trime</h3><p>至对应的 GitHub Repo 或 Google Play 上搜索“同文輸入法”下载安装即可。随后在 Android 的设置 - 语言与输入法 - 输入法管理中启用输入法即可。</p>\n<p>同文输入法同样也附带了 rime 的默认输入方案，如果你对输入方案和词库没有要求的话，同样可以“开箱即用”。</p>\n<p>对于 Trime 来说，三个重要路径如下：</p>\n<ul>\n<li>默认数据路径：<code>/sdcard/rime</code></li>\n<li>用户数据路径：默认情况下与系统数据一致</li>\n<li>同步路径：<code>/sdcard/rime/sync/$ 安装 ID</code></li>\n</ul>\n<h2 id=\"Rime 默认配置文件的简单介绍\"><a href=\"#Rime 默认配置文件的简单介绍\" class=\"headerlink\" title=\"Rime 默认配置文件的简单介绍\"></a>Rime 默认配置文件的简单介绍 </h2><h3 id=\"默认数据\"><a href=\"# 默认数据\" class=\"headerlink\" title=\"默认数据\"></a> 默认数据 </h3><p> 这里以小狼毫为例，简单来看一下 rime 默认附带的配置文件都有什么。默认数据的存放位置是安装目录下的 <code>data</code> 文件夹。</p>\n<p><img src=\"/2021/06/19/011-rime-1-intro/upload_08dc842946cea38ed7636569ba08aab7.png\"></p>\n<p>从上到下依次进行介绍：</p>\n<ul>\n<li><code>opencc</code>：开放中文转换（OpenCC）库需要的文件。一般也称 OpenCC“滤镜”。存放着滤镜的配置文件（json）和滤镜本体（ocd 或 ocd2）</li>\n<li><code>preview</code>：皮肤的预览图，应为小狼毫特有的文件夹。</li>\n<li><code>*.sechma.yaml</code>：输入方案的配置文件，yaml 格式。对输入法的行为进行了定义。图中涵盖了这些默认方案：<ul>\n<li><code>bopomofo</code>：注音输入法。</li>\n<li><code>bopomofo_express</code>：注音输入法的快打模式。快打模式会对输入法行为进行调整，如自动上屏（即自动将唯一匹配的候选词进行输出）、特殊键位（如大写锁定键作为候选词的切换键）等。</li>\n<li><code>bopomofo_tw</code>：为台湾正体优化的注音输入法。实际上就是默认启用了注音输入法中加载的台湾字形滤镜。</li>\n<li><code>cangjie5</code>：第五代仓颉输入法。</li>\n<li><code>cangjie5_express</code>：仓颉输入法的快打模式。</li>\n<li><code>luna_pinyin</code>：朙月拼音。这会是我们后续进行定制的基础输入方案。</li>\n<li><code>luna_pinyin_fluency</code>：朙月拼音语句流模式。空格作为分词，一次可打多个词。</li>\n<li><code>luna_pinyin_simp</code>：朙月拼音的中文简体模式。</li>\n<li><code>luna_pinyin_tw</code>：朙月拼音的台湾正体模式。</li>\n<li><code>luna_quanpin</code>：全拼输入法。一般作为调试用途。</li>\n<li><code>stroke</code>：五笔输入法。</li>\n<li><code>terra_pinyin</code>：地球拼音输入法。</li>\n</ul>\n</li>\n<li><code>*.dict.yaml</code>：对应输入方案的输入法词库。“候选词”中的大部分来源于此。</li>\n<li><code>default.yaml</code>：主配置文件，涵盖包括输入法方案的禁用和启用、候选词个数、键位绑定等配置。</li>\n<li><code>essay.txt</code>：“八股文”，预设词汇表和语言模型。</li>\n<li><code>weasel.yaml</code>：输入法前端配置文件，包含了与前端相关的配置，如界面字体、界面颜色等。不同的前端配置文件名称不同（也可能没有该配置文件），如同文输入法的前端配置文件为<code>trime.yaml</code>。</li>\n<li><code>pinyin.yaml</code>：拼音输入法的模糊音配置。</li>\n<li><code>punctuation.yaml</code>：定义了基本的全角符号和半角符号。</li>\n<li><code>symbol.yaml</code>：定义了几乎所有常见的符号，除标点外还包括序号、上下标、希腊字母、片假名等。</li>\n<li><code>key_bindings.yaml</code>：额外的快捷键定义。</li>\n<li><code>zhuyin.yaml</code>：将拼音码表与注音码表相互转换。这样输入注音时就可从拼音词库中查词。是输入方案 <code>bopomofo</code> 的依赖项——不难发现 <code>bopomofo</code> 并没有自己的词库，而是与 <code>terra_pinyin</code> 共用词库。</li>\n</ul>\n<h3 id=\"默认用户数据\"><a href=\"# 默认用户数据\" class=\"headerlink\" title=\"默认用户数据\"></a>默认用户数据 </h3><p> 同样以小狼毫为例，简单看一下默认的用户数据都包括些什么。用户数据存储于安装时指定的用户资料夹位置下。如果你还没有开始使用小狼毫打字，目录下的文件是这样的：</p>\n<p><img src=\"/2021/06/19/011-rime-1-intro/upload_c7153462d88e42edc7651edaa88b321f.png\"></p>\n<p>如果你已经用小狼毫打过字，并触发过用户资料同步，那么目录下的文件看起来像这样：</p>\n<p><img src=\"/2021/06/19/011-rime-1-intro/upload_d77256a16bf38825064a60e48b4e35b3.png\"></p>\n<p>依次进行介绍：</p>\n<ul>\n<li><code>installation.yaml</code>：保存了“前端”与“后端”的安装信息，如“前端”名称、librime 版本号、<strong>安装 ID</strong>等。</li>\n<li><code>user.yaml</code>：存放用户变量，如最后一次同步时间的时间戳等。</li>\n<li><code>sync</code>：是默认的用户数据同步文件夹。</li>\n<li><code>*.userdb</code>：是对应的输入方案的词频 / 排序 / 个人词典数据库。</li>\n<li><code>build</code>：存放词库与输入方案编译后的 yaml 文件和二进制文件。</li>\n<li><code>*.schema.yaml</code>、<code>*.dict.yaml</code>等：输入法的输入方案及其对应的词库。<strong>相同名称的输入方案 / 词库配置会替代默认数据目录下的输入方案 / 词库配置</strong>，也即用户数据的优先级高于默认数据。</li>\n</ul>\n<p>如果你触发过同步，可以在默认的同步文件夹下看到同步后的文件。</p>\n<p><img src=\"/2021/06/19/011-rime-1-intro/Snipaste_2021-08-09_16-15-33.png\"></p>\n<p>依次进行介绍：</p>\n<ul>\n<li><code>user.yaml</code>、<code>installation.yaml</code>、<code>*.schema.yaml</code>、<code>*.dict.yaml</code>等：与 <strong> 用户数据文件夹 </strong> 下的内容一致。<strong>仅在默认数据目录中而不在用户数据目录中的文件不会被同步</strong>。</li>\n<li><code>*.userdb.txt</code>：输入方案的数据库的导出文件，按特定格式明文保存。这也是后续构建个人词库的词条来源。</li>\n</ul>\n<p><img src=\"/2021/06/19/011-rime-1-intro/Snipaste_2021-08-10_00-59-35.png\"></p>\n<p>对目录结构和文件作用有了基本了解之后，我们就可以着手定制自己的输入方案了。</p>\n","content_text":"图源：@爱卿 《夏》 82079855 什么是 Rime？RIME，官方中文名称为“中州韻”（即“中州韵”，中原之韵），是一款开源的轻量的跨平台输入法库，由佛振等人开发。源代码现托管在 Github 上：rime/librime。Rime 具有很强的扩展性和可定制性——你可以使用 Lua 编写它的插件 ，也可以通过自定义配置文件实现自己研发的、更加高效的 汉字输入方案 ，或者实现 多语言混合输入 ，又或者你只是想在各个平台上获得 统一的文字输入体验。这一特性使得强大的 Rime 在使用上拥有无限的可能性。本文是 Rime 系列的第一篇，主要记录 Rime 在各个平台下的安装，及其基础的使用方法。 如何安装 Rime？Librime 是一个开源的输入法库。库像是一种”后端“，不能直接用于文字输入。需要和配套的“前端”（一说“发行版”）一起使用。“前端”也已有不少实现，列举使用人数较多的输入法“前端”如下： rime/squirrel，中文名为“鼠须管”，macOS 下的输入法前端； rime/weasel，中文名为“小狼毫”，Windows 下的输入法前端； osfans/trime，中文名为“同文输入法”，Android 下的输入法前端； jimmy54/iRime，中文名为“iRime 输入法”，iOS 下的输入法前端，注意有应用内购付费，而且有人反映其并未严格按照 Rime 前端统一的规范加载配置文件； rime/ibus-rime，Linux 下的输入法前端，基于 IBus； fcitx-rime，Linux 下的输入法前端，基于 Fcitx 或者你也可以利用 librime，编写自己的输入法前端。 Windows - WeaselWeasel 可以直接在 Rime 的官网下载安装，也可以手动编译安装。截止本文写作之时，Rime 官方发布的稳定版本为 0.14.3，采用 librime 1.5.3 版本，更新于 2019 年 6 月 22 日。而 librime 的最新版本已迭代至了 1.7.2，修复了不少错误并且向后兼容。因此强烈推荐手动编译新版本并安装。 编译所需环境： Visual Studio 2017 Boost 1.69.0 CMake NSIS Git、7z、Wget for Windows 等常见工具 下面简单叙述步骤。 第一步：Clone 项目，下载并更新子模块为最新。 123git clone --recursive https://github.com/rime/weasel.gitcd weasel\\git submodule update --remote --recursive 第二步：修正 NSIS 配置文件错误。找到output\\install.nsi，修改第 159 行的： 1File &quot;data\\opencc\\*.ocd&quot; 为： 1File &quot;data\\opencc\\*.ocd2&quot; 这是因为新版本的 opencc 使用 ocd2 作为字典格式，而不是老版本的 ocd 格式。 第三步：设置环境变量。包括编译器版本、工具集、Boost 位置、librime 编译成品的版本号（可从 librime 的 Release 页 查询）、下载链接等。根据实际情况和版本需要进行修改。 如果你不想通过命令行下载 librime，也可使用浏览器下载后，参照第四步所述命令手动将所需文件放置于指定位置。 1234567set BOOST_ROOT=C:\\Libraries\\boost_1_69_0set CMAKE_GENERATOR=&quot;Visual Studio 15 2017&quot;set PLATFORM_TOOLSET=v141_xpset rime_version=1.7.3set rime_variant=rime-with-pluginsset download_archive=%rime_variant%-%rime_version%-win32.zipset WEASEL_BUILD=20210309 推荐下载支持 Lua 插件扩展的 rime-with-plugin 版本。 第四步：下载编译好的 librime 并复制文件。 1234567wget https://github.com/rime/librime/releases/download/%rime_version%/%download_archive%7z x %download_archive% * -y -olibrimecopy /Y librime\\dist\\include\\rime_*.h include\\copy /Y librime\\dist\\lib\\rime.lib lib\\copy /Y librime\\dist\\lib\\rime.dll output\\if not exist output\\data\\opencc mkdir output\\data\\opencccopy /Y librime\\thirdparty\\share\\opencc\\*.* output\\data\\opencc\\ 第五步：编译 Boost 环境。直接使用为 AppVeyor 编写的编译脚本即可。 1.\\appveyor_build_boost.bat 第六步：编译主程序。 1.\\build.bat data hant weasel installer 随后在 output 文件夹中即可找到编译完成的安装文件。双击进行安装即可。 安装时会弹出设置选项： 用户资料夹即为下文提到的“用户资料路径”，如果你想直接开始使用，选择默认方案为“中文（简体）”就可以了。 安装完成后，需要留意以下三个路径： 默认数据路径：默认为C:\\Program Files (x86)\\Rime\\weasel-$ 版本号 用户数据路径：默认为C:\\Users\\$ 用户名 \\AppData\\Roaming\\Rime 同步路径：默认为C:\\Users\\$ 用户名 \\AppData\\Roaming\\Rime\\sync\\$ 安装 ID 这两个路径对后续 Rime 的配置有很大用处。 Linux - Ibus-rimeLinux 下的前端有两个，一个是基于 Fcitx 的 fcitx-rime，既支持 Fcitx 4，也支持新开发的 Fcitx 5。但缺点是 无法同步输入法的用户数据。另一个是基于的 Ibus 的 ibus-rime，可以同步输入法的用户数据。以下以 Ubuntu 环境为例，配置 ibus 和 ibus-rime。 安装十分简单，ibus 已包含于官方源中： 1sudo apt install ibus ibus-rime 安装完毕后重启系统，打开设置 - 区域与语言 - 输入源 - 加号（+），在弹出的窗口中选择汉语（中国）- 中文（Rime），点击添加。 随后在任务栏右上角切换输入法即可激活 ibus-rime。 当然你也有可能遇到 ibus 在某些应用程序中不可用的问题，一般只要在 ~/.bashrc 中加入如下的设置环境变量命令即可。 123export GTK_IM_MODULE=ibusexport XMODIFIERS=@im=ibusexport QT_IM_MODULE=ibus 注意：有些发行版的 ibus-rime 在安装时会附带依赖 librime-data，其中包含了 rime 默认的输入方案，如朙月拼音、仓颉、五笔等，可“开箱即用”。但由于不是所有发行版都有这种依赖，后文的基本配置环节将建立在无默认输入方案的基础之上。 对于 ibus-rime 来说，三个重要路径如下： 默认数据路径：/usr/share/rime-data 用户数据路径：~/.config/ibus/rime 同步路径：~/.config/ibus/rime/sync/$ 安装 ID Android - Trime至对应的 GitHub Repo 或 Google Play 上搜索“同文輸入法”下载安装即可。随后在 Android 的设置 - 语言与输入法 - 输入法管理中启用输入法即可。 同文输入法同样也附带了 rime 的默认输入方案，如果你对输入方案和词库没有要求的话，同样可以“开箱即用”。 对于 Trime 来说，三个重要路径如下： 默认数据路径：/sdcard/rime 用户数据路径：默认情况下与系统数据一致 同步路径：/sdcard/rime/sync/$ 安装 ID Rime 默认配置文件的简单介绍 默认数据 这里以小狼毫为例，简单来看一下 rime 默认附带的配置文件都有什么。默认数据的存放位置是安装目录下的 data 文件夹。 从上到下依次进行介绍： opencc：开放中文转换（OpenCC）库需要的文件。一般也称 OpenCC“滤镜”。存放着滤镜的配置文件（json）和滤镜本体（ocd 或 ocd2） preview：皮肤的预览图，应为小狼毫特有的文件夹。 *.sechma.yaml：输入方案的配置文件，yaml 格式。对输入法的行为进行了定义。图中涵盖了这些默认方案： bopomofo：注音输入法。 bopomofo_express：注音输入法的快打模式。快打模式会对输入法行为进行调整，如自动上屏（即自动将唯一匹配的候选词进行输出）、特殊键位（如大写锁定键作为候选词的切换键）等。 bopomofo_tw：为台湾正体优化的注音输入法。实际上就是默认启用了注音输入法中加载的台湾字形滤镜。 cangjie5：第五代仓颉输入法。 cangjie5_express：仓颉输入法的快打模式。 luna_pinyin：朙月拼音。这会是我们后续进行定制的基础输入方案。 luna_pinyin_fluency：朙月拼音语句流模式。空格作为分词，一次可打多个词。 luna_pinyin_simp：朙月拼音的中文简体模式。 luna_pinyin_tw：朙月拼音的台湾正体模式。 luna_quanpin：全拼输入法。一般作为调试用途。 stroke：五笔输入法。 terra_pinyin：地球拼音输入法。 *.dict.yaml：对应输入方案的输入法词库。“候选词”中的大部分来源于此。 default.yaml：主配置文件，涵盖包括输入法方案的禁用和启用、候选词个数、键位绑定等配置。 essay.txt：“八股文”，预设词汇表和语言模型。 weasel.yaml：输入法前端配置文件，包含了与前端相关的配置，如界面字体、界面颜色等。不同的前端配置文件名称不同（也可能没有该配置文件），如同文输入法的前端配置文件为trime.yaml。 pinyin.yaml：拼音输入法的模糊音配置。 punctuation.yaml：定义了基本的全角符号和半角符号。 symbol.yaml：定义了几乎所有常见的符号，除标点外还包括序号、上下标、希腊字母、片假名等。 key_bindings.yaml：额外的快捷键定义。 zhuyin.yaml：将拼音码表与注音码表相互转换。这样输入注音时就可从拼音词库中查词。是输入方案 bopomofo 的依赖项——不难发现 bopomofo 并没有自己的词库，而是与 terra_pinyin 共用词库。 默认用户数据 同样以小狼毫为例，简单看一下默认的用户数据都包括些什么。用户数据存储于安装时指定的用户资料夹位置下。如果你还没有开始使用小狼毫打字，目录下的文件是这样的： 如果你已经用小狼毫打过字，并触发过用户资料同步，那么目录下的文件看起来像这样： 依次进行介绍： installation.yaml：保存了“前端”与“后端”的安装信息，如“前端”名称、librime 版本号、安装 ID等。 user.yaml：存放用户变量，如最后一次同步时间的时间戳等。 sync：是默认的用户数据同步文件夹。 *.userdb：是对应的输入方案的词频 / 排序 / 个人词典数据库。 build：存放词库与输入方案编译后的 yaml 文件和二进制文件。 *.schema.yaml、*.dict.yaml等：输入法的输入方案及其对应的词库。相同名称的输入方案 / 词库配置会替代默认数据目录下的输入方案 / 词库配置，也即用户数据的优先级高于默认数据。 如果你触发过同步，可以在默认的同步文件夹下看到同步后的文件。 依次进行介绍： user.yaml、installation.yaml、*.schema.yaml、*.dict.yaml等：与 用户数据文件夹 下的内容一致。仅在默认数据目录中而不在用户数据目录中的文件不会被同步。 *.userdb.txt：输入方案的数据库的导出文件，按特定格式明文保存。这也是后续构建个人词库的词条来源。 对目录结构和文件作用有了基本了解之后，我们就可以着手定制自己的输入方案了。","summary":"图源：@爱卿 《夏》 82079855 什么是 Rime？RIME，官方中文名称为“中州韻”（即“中州韵”，中原之韵），是一款开源的轻量的跨平台输入法库，由佛振等人开发。源代码现托管在 Github 上：rime/librime。Rime 具有很强的扩展性和可定制性——你可以使用 Lua 编写它的插件，也可以通过自定义配置文件实现自己研发的、更加高效的汉字输入方案，或者实现多语言混合输入，又或者你只是想在各个平台上获得统一的文字输入体验。这一特性使得强大的 Rime 在使用上拥有无限的可能性。本文是 Rime 系列的第一篇，主要记录 Rime 在各个平台下的安装，及其基础的使用方法。 如何安装 Rime？Librime 是一个开源的输入法库。库像是一种”后端“，不能直接用于文字输入。需要和配套的“前端”（一说“发行版”）一起使用。“前端”也已有不少实现，列举使用人数较多的输入法“前端”如下： rime/squirrel，中文名为“鼠须管”，macOS 下的输入法前端； rime/weasel，中文名为“小狼毫”，Windows 下的输入法前端； osfans/trime，中文名为“同文输入法”，Android 下的输入法前端； jimmy54/iRime，中文名为“iRime输入法”，iOS 下的输入法前端，注意有应用内购付费，而且有人反映其并未严格按照Rime前端统一的规范加载配置文件； rime/ibus-rime，Linux 下的输入法前端，基于 IBus； fcitx-rime，Linux 下的输入法前端，基于 Fcitx 或者你也可以利用librime，编写自己的输入法前端。 Windows - WeaselWeasel可以直接在Rime的官网下载安装，也可以手动编译安装。截止本文写作之时，Rime官方发布的稳定版本为0.14.3，采用librime 1.5.3版本，更新于2019年6月22日。而librime的最新版本已迭代至了1.7.2，修复了不少错误并且向后兼容。因此强烈推荐手动编译新版本并安装。 编译所需环境： Visual Studio 2017 Boost 1.69.0 CMake NSIS Git、7z、Wget for Windows等常见工具 下面简单叙述步骤。","date_published":"2021-06-19T10:00:00.000Z","tags":["输入法","完成编写","Rime"]},{"id":"https://www.zhouweitong.site/post/027-cmu-cg-note-1/","url":"https://www.zhouweitong.site/post/027-cmu-cg-note-1/","title":"【WIP】CMU 15-462 笔记 Part.1","content_html":"<link rel=\"stylesheet\" type=\"text&#x2F;css\" href=\"https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.5.1/katex.min.css\"><link rel=\"stylesheet\" type=\"text&#x2F;css\" href=\"https://cdn.jsdelivr.net/npm/hexo-tag-hint@0.3.1/dist/hexo-tag-hint.min.css\"><p>图片来源：@Lifeline    <a href=\"https://www.pixiv.net/artworks/88401620\">88401620</a></p>\n<p><strong>增补（感谢 @oyiadin）：本系列笔记将添加《Games 101：现代计算机图形学入门》、《Games 102：几何建模与处理》、“龙书”（《Introduction to 3D Game Programming with DirectX 12》）三个额外来源的笔记。大段的非 CMU 课程的笔记会在显著位置标识。</strong></p>\n<h2 id=\"Lecture-1\"><a href=\"#Lecture-1\" class=\"headerlink\" title=\"Lecture 1\"></a>Lecture 1</h2><h3 id=\"什么是计算机图形学\"><a href=\"# 什么是计算机图形学\" class=\"headerlink\" title=\"什么是计算机图形学\"></a>什么是计算机图形学 </h3><p> 计算机图形学：利用计算机合成视觉信息或利用计算机合成 / 操控感官信息的学科。</p>\n<h3 id=\"计算机图形学的应用\"><a href=\"# 计算机图形学的应用\" class=\"headerlink\" title=\"计算机图形学的应用\"></a>计算机图形学的应用</h3><ul>\n<li><p>影视</p>\n</li>\n<li><p>动画</p>\n</li>\n<li><p>游戏</p>\n</li>\n<li><p>数据可视化</p>\n</li>\n<li><p>工业设计，平面设计</p>\n</li>\n<li><p>数字绘画</p>\n</li>\n<li><p>虚拟现实</p>\n<blockquote>\n<p>相同的内容后续整理 VR 课笔记时不再赘述。</p>\n</blockquote>\n<ul>\n<li><p>虚拟现实（VR）：指所看到的一切均为虚拟的，比如虚拟现实游戏、虚拟现实视频等。</p>\n</li>\n<li><p>增强现实（AR）：指看到的是真实的现实 + 虚拟的、对当前现实进行分析处理或修改等生成的虚拟事物，比如 Apple ARkit。</p>\n</li>\n<li><p>混合现实（MR）：VR + AR，使用类似 VR 的手段，达到 AR 这种结合当前现实与虚拟事物的效果，比如 Hololens。</p>\n</li>\n</ul>\n</li>\n<li><p>制造业（3D 打印）</p>\n</li>\n<li><p>模拟</p>\n</li>\n<li><p>排版与字体设计</p>\n<ul>\n<li><p>“The Quick Brown Fox Jumps Over The Lazy Dog”：一句有意义的英文句子，内含全部的 26 个英文字母，常用来对字体（字形、字号、间距等）进行测试。</p>\n</li>\n<li><p>“Lorem ipsum dolor sit amet, consectetur adipisicing elit.”：又叫“乱数假文”或者“哑元文本”。主要的目的为测试文章或文字在不同字型、版型下看起来的效果。更多资料请查阅：<a href=\"https://cn.lipsum.com/\">https://cn.lipsum.com/</a>。</p>\n</li>\n</ul>\n</li>\n<li><p>……</p>\n</li>\n</ul>\n<h3 id=\"计算机图形学与计算机视觉的区别\"><a href=\"# 计算机图形学与计算机视觉的区别\" class=\"headerlink\" title=\"计算机图形学与计算机视觉的区别\"></a>计算机图形学与计算机视觉的区别 </h3><p> 计算机图形学：将数据转化为图形。也就是“画出来”。</p>\n<p>计算机视觉：将图形转化为数据。也就是“看到”。</p>\n<h3 id=\"计算机图形学需要哪些基础\"><a href=\"# 计算机图形学需要哪些基础\" class=\"headerlink\" title=\"计算机图形学需要哪些基础\"></a>计算机图形学需要哪些基础</h3><ul>\n<li><p>表示方法（编码）</p>\n</li>\n<li><p>采样与混叠</p>\n</li>\n<li><p>数学方法（表示动态和三位形体）</p>\n</li>\n<li><p>光线</p>\n</li>\n<li><p>透视</p>\n</li>\n<li><p>……</p>\n</li>\n</ul>\n<h3 id=\"对正方体建个模？\"><a href=\"# 对正方体建个模？\" class=\"headerlink\" title=\"对正方体建个模？\"></a>对正方体建个模？</h3><ul>\n<li><p>如何表示</p>\n<ul>\n<li><p>顶点：利用坐标</p>\n</li>\n<li><p>边：利用边的两个顶点唯一确定</p>\n</li>\n</ul>\n</li>\n<li><p>如何绘制</p>\n<ul>\n<li><p>三维图形转化为二维图形：小孔成像模型</p>\n<p>设相机坐标为 $(a,b,c)$ ，待确定点的坐标为 $(x,y,z)$ 。要得到该点在二维平面上的坐标，可进行如下算法步骤：</p>\n<ol>\n<li><p>$(x,y,z)$ 与 $(a,b,c)$ 相减，得到原三维点与摄像机的相对位置；</p>\n</li>\n<li><p>将其中的 $(x,y)$ 与 $z$ 相除，得到 $(\\frac{x}{z},\\frac{y}{z})$，即是所求的 $(u,v)$。</p>\n</li>\n</ol>\n</li>\n<li><p>连线。这就要细说到电脑如何绘制直线。</p>\n</li>\n</ul>\n</li>\n</ul>\n<span id=\"more\"></span>\n\n<h3 id=\"计算机怎么划线？\"><a href=\"# 计算机怎么划线？\" class=\"headerlink\" title=\"计算机怎么划线？\"></a>计算机怎么划线？</h3><p>先得知道计算机怎么显示图像：“光栅显示器”。</p>\n<p>特点：</p>\n<ul>\n<li><p>图像表示为由 <strong> 像素 </strong> 组成的二维网格。</p>\n</li>\n<li><p>每个像素可拥有不同的颜色值。</p>\n</li>\n</ul>\n<h4 id=\"光栅化\"><a href=\"# 光栅化\" class=\"headerlink\" title=\"光栅化\"></a>光栅化 </h4><p> 将连续的物体转换为离散的像素在光栅网格上的表示（即由栅格组成的图像）的过程。也即把顶点数据转换为片元的过程。</p>\n<h4 id=\"怎么光栅化？（简单讨论无粗细的直线）\"><a href=\"# 怎么光栅化？（简单讨论无粗细的直线）\" class=\"headerlink\" title=\"怎么光栅化？（简单讨论无粗细的直线）\"></a>怎么光栅化？（简单讨论无粗细的直线）</h4><ul>\n<li><p>直接的想法：只要原始的连续物体触及了某个像素，该像素就应该显示。缺点：误差大。</p>\n</li>\n<li><p>在部分图形 API 中的实现：菱形测试区域法。</p>\n</li>\n<li><p>……</p>\n</li>\n</ul>\n<p>资料：\n<a href=\"https://docs.microsoft.com/zh-cn/windows/uwp/graphics-concepts/rasterization-rules\">https://docs.microsoft.com/zh-cn/windows/uwp/graphics-concepts/rasterization-rules</a></p>\n<p>不一定是最优解：看需求。通过需求挑选不同的算法。</p>\n<p>除了误差（锯齿），覆盖率也是衡量光栅化效果的重要指标之一。</p>\n<h4 id=\"怎么找到对应的栅格（像素）？\"><a href=\"# 怎么找到对应的栅格（像素）？\" class=\"headerlink\" title=\"怎么找到对应的栅格（像素）？\"></a>怎么找到对应的栅格（像素）？</h4><ul>\n<li><p>暴力方法：遍历每一个像素，判断是否满足显示要求，满足就点亮进行显示。缺点：速度极慢。</p>\n</li>\n<li><p>“增值行光栅化”：简单的 <strong> 演示用 </strong> 自定义算法，利用直线的斜率，确定哪些像素用于显示。</p>\n<p>  设有一直线，起点为 $(u_1,v_1)$，终点为 $(u_2,v_2)$。假设有 $u_1 &lt; u_2, v_1 &lt; v_2$ 且 $0&lt;s&lt;1$。可依据如下过程寻找像素（伪代码）：</p>\n  <figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">p = (u, v);</span><br><span class=\"line\">v = v1;</span><br><span class=\"line\"><span class=\"keyword\">for</span>(u = u1; u &lt;= u2; u++) &#123;</span><br><span class=\"line\">    v += s;</span><br><span class=\"line\">    draw(u, round(v));</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></li>\n</ul>\n<p><img src=\"/2021/03/30/027-cmu-cg-note-1/image-20210411150846062.png\" alt=\"image-20210411150846062\"></p>\n<p>以上是一个虽简单但完整的 CG 流程——从表示，到计算，到光栅化，再到显示。不过现实的 CG 环境要远远比这复杂。我们没有提到一些对图像（渲染）的真实感至关重要的知识和算法，譬如：</p>\n<ul>\n<li><p>几何体，尤其是复杂几何体</p>\n</li>\n<li><p>材质，透明半透明或不透明</p>\n</li>\n<li><p>光线，照明</p>\n</li>\n<li><p>摄像机</p>\n</li>\n<li><p>运动</p>\n</li>\n<li><p>……</p>\n</li>\n</ul>\n<h3 id=\"Games101-L1：课程四大部分\"><a href=\"#Games101-L1：课程四大部分\" class=\"headerlink\" title=\"Games101 - L1：课程四大部分\"></a>Games101 - L1：课程四大部分 </h3><p> 常见图形学 API：OpenGL，（Vulkan），DirectX</p>\n<ul>\n<li><p>光栅化</p>\n<ul>\n<li><p>将几何基元投影至屏幕上，将投影后的几何基元拆分为“像素”</p>\n</li>\n<li><p>（来源：<a href=\"https://vispy.org/getting_started/modern-gl.html\">https://vispy.org/getting_started/modern-gl.html</a>）<a href=\"https://max.book118.com/html/2016/1123/64908259.shtm\">透视投影 </a> 与<a href=\"https://en.wikipedia.org/wiki/Orthographic_projection\">平行投影</a>。</p>\n</li>\n</ul>\n</li>\n<li><p>光线追踪</p>\n<ul>\n<li><p>从相机射出光线（采样视线）打到每个像素上。</p>\n</li>\n<li><p>计算交叉（intersection）和遮挡（shading）。</p>\n</li>\n<li><p>继续弹射（bounce）光线，直到回归光源</p>\n</li>\n<li><p>参考 <a href=\"http://blog.sina.com.cn/s/blog_15f7fa13f0102wg8c.html\">http://blog.sina.com.cn/s/blog_15f7fa13f0102wg8c.html</a> 和 <a href=\"https://en.wikipedia.org/wiki/Ray_tracing_(graphics)\">https://en.wikipedia.org/wiki/Ray_tracing_(graphics)</a>。</p>\n</li>\n</ul>\n</li>\n<li><p>曲线与网格</p>\n<ul>\n<li><p>计算机图形学中表示几何体的方法。</p>\n</li>\n<li><p><a href=\"https://en.wikipedia.org/wiki/B%C3%A9zier_curve\">贝塞尔曲线</a></p>\n</li>\n<li><p><a href=\"https://en.wikipedia.org/wiki/Catmull%E2%80%93Clark_subdivision_surface\">Catmull-Clark 细分曲面</a>，参考<a href=\"https://blog.csdn.net/McQueen_LT/article/details/106102609\">https://blog.csdn.net/McQueen_LT/article/details/106102609</a></p>\n</li>\n<li><p>Games 102</p>\n</li>\n</ul>\n</li>\n<li><p>动画与模拟</p>\n<ul>\n<li>关键帧（K 帧）动画</li>\n<li>弹簧质点（Mass Spring）系统模型，参见：<a href=\"https://zhuanlan.zhihu.com/p/79756413\">https://zhuanlan.zhihu.com/p/79756413</a></li>\n</ul>\n</li>\n</ul>\n<h3 id=\"Games-101-L2：课程需求\"><a href=\"#Games-101-L2：课程需求\" class=\"headerlink\" title=\"Games 101 - L2：课程需求\"></a>Games 101 - L2：课程需求 </h3><h2 id=\"Lecture-2\"><a href=\"#Lecture-2\" class=\"headerlink\" title=\"Lecture 2\"></a>Lecture 2</h2><p> 对线性代数的复习课。只记重点。</p>\n<ul>\n<li><p>对向量进行处理时注意坐标系，除了是直角坐标系还是极坐标系外还要注意坐标系的原点。</p>\n</li>\n<li><p>向量基本性质：</p>\n</li>\n</ul>\n<p><img src=\"/2021/03/30/027-cmu-cg-note-1/image-20210411150910886.png\" alt=\"image-20210411150910886\"></p>\n<ul>\n<li><p>提示要有探究精神，不要一味的接受“定理”和“定义”，要去思考为什么存在这个定理，这个定理在什么情况下对什么适用，等。</p>\n</li>\n<li><p>向量可以看成一种“函数”，即矩阵类比函数的观点。</p>\n</li>\n<li><p>向量的模：也叫向量的“长度”。具有很多性质。</p>\n<ul>\n<li><p>非负性</p>\n</li>\n<li><p>连续性</p>\n</li>\n</ul>\n</li>\n</ul>\n<p><img src=\"/2021/03/30/027-cmu-cg-note-1/image-20210411150926529.png\" alt=\"image-20210411150926529\"></p>\n","content_text":"图片来源：@Lifeline 88401620 增补（感谢 @oyiadin）：本系列笔记将添加《Games 101：现代计算机图形学入门》、《Games 102：几何建模与处理》、“龙书”（《Introduction to 3D Game Programming with DirectX 12》）三个额外来源的笔记。大段的非 CMU 课程的笔记会在显著位置标识。 Lecture 1什么是计算机图形学 计算机图形学：利用计算机合成视觉信息或利用计算机合成 / 操控感官信息的学科。 计算机图形学的应用 影视 动画 游戏 数据可视化 工业设计，平面设计 数字绘画 虚拟现实 相同的内容后续整理 VR 课笔记时不再赘述。 虚拟现实（VR）：指所看到的一切均为虚拟的，比如虚拟现实游戏、虚拟现实视频等。 增强现实（AR）：指看到的是真实的现实 + 虚拟的、对当前现实进行分析处理或修改等生成的虚拟事物，比如 Apple ARkit。 混合现实（MR）：VR + AR，使用类似 VR 的手段，达到 AR 这种结合当前现实与虚拟事物的效果，比如 Hololens。 制造业（3D 打印） 模拟 排版与字体设计 “The Quick Brown Fox Jumps Over The Lazy Dog”：一句有意义的英文句子，内含全部的 26 个英文字母，常用来对字体（字形、字号、间距等）进行测试。 “Lorem ipsum dolor sit amet, consectetur adipisicing elit.”：又叫“乱数假文”或者“哑元文本”。主要的目的为测试文章或文字在不同字型、版型下看起来的效果。更多资料请查阅：https://cn.lipsum.com/。 …… 计算机图形学与计算机视觉的区别 计算机图形学：将数据转化为图形。也就是“画出来”。 计算机视觉：将图形转化为数据。也就是“看到”。 计算机图形学需要哪些基础 表示方法（编码） 采样与混叠 数学方法（表示动态和三位形体） 光线 透视 …… 对正方体建个模？ 如何表示 顶点：利用坐标 边：利用边的两个顶点唯一确定 如何绘制 三维图形转化为二维图形：小孔成像模型 设相机坐标为 $(a,b,c)$ ，待确定点的坐标为 $(x,y,z)$ 。要得到该点在二维平面上的坐标，可进行如下算法步骤： $(x,y,z)$ 与 $(a,b,c)$ 相减，得到原三维点与摄像机的相对位置； 将其中的 $(x,y)$ 与 $z$ 相除，得到 $(\\frac{x}{z},\\frac{y}{z})$，即是所求的 $(u,v)$。 连线。这就要细说到电脑如何绘制直线。 计算机怎么划线？先得知道计算机怎么显示图像：“光栅显示器”。 特点： 图像表示为由 像素 组成的二维网格。 每个像素可拥有不同的颜色值。 光栅化 将连续的物体转换为离散的像素在光栅网格上的表示（即由栅格组成的图像）的过程。也即把顶点数据转换为片元的过程。 怎么光栅化？（简单讨论无粗细的直线） 直接的想法：只要原始的连续物体触及了某个像素，该像素就应该显示。缺点：误差大。 在部分图形 API 中的实现：菱形测试区域法。 …… 资料： https://docs.microsoft.com/zh-cn/windows/uwp/graphics-concepts/rasterization-rules 不一定是最优解：看需求。通过需求挑选不同的算法。 除了误差（锯齿），覆盖率也是衡量光栅化效果的重要指标之一。 怎么找到对应的栅格（像素）？ 暴力方法：遍历每一个像素，判断是否满足显示要求，满足就点亮进行显示。缺点：速度极慢。 “增值行光栅化”：简单的 演示用 自定义算法，利用直线的斜率，确定哪些像素用于显示。 设有一直线，起点为 $(u_1,v_1)$，终点为 $(u_2,v_2)$。假设有 $u_1 &lt; u_2, v_1 &lt; v_2$ 且 $0&lt;s&lt;1$。可依据如下过程寻找像素（伪代码）： 123456p = (u, v);v = v1;for(u = u1; u &lt;= u2; u++) &#123; v += s; draw(u, round(v));&#125; 以上是一个虽简单但完整的 CG 流程——从表示，到计算，到光栅化，再到显示。不过现实的 CG 环境要远远比这复杂。我们没有提到一些对图像（渲染）的真实感至关重要的知识和算法，譬如： 几何体，尤其是复杂几何体 材质，透明半透明或不透明 光线，照明 摄像机 运动 …… Games101 - L1：课程四大部分 常见图形学 API：OpenGL，（Vulkan），DirectX 光栅化 将几何基元投影至屏幕上，将投影后的几何基元拆分为“像素” （来源：https://vispy.org/getting_started/modern-gl.html）透视投影 与平行投影。 光线追踪 从相机射出光线（采样视线）打到每个像素上。 计算交叉（intersection）和遮挡（shading）。 继续弹射（bounce）光线，直到回归光源 参考 http://blog.sina.com.cn/s/blog_15f7fa13f0102wg8c.html 和 https://en.wikipedia.org/wiki/Ray_tracing_(graphics)。 曲线与网格 计算机图形学中表示几何体的方法。 贝塞尔曲线 Catmull-Clark 细分曲面，参考https://blog.csdn.net/McQueen_LT/article/details/106102609 Games 102 动画与模拟 关键帧（K 帧）动画 弹簧质点（Mass Spring）系统模型，参见：https://zhuanlan.zhihu.com/p/79756413 Games 101 - L2：课程需求 Lecture 2 对线性代数的复习课。只记重点。 对向量进行处理时注意坐标系，除了是直角坐标系还是极坐标系外还要注意坐标系的原点。 向量基本性质： 提示要有探究精神，不要一味的接受“定理”和“定义”，要去思考为什么存在这个定理，这个定理在什么情况下对什么适用，等。 向量可以看成一种“函数”，即矩阵类比函数的观点。 向量的模：也叫向量的“长度”。具有很多性质。 非负性 连续性","summary":"图片来源：@Lifeline 88401620 增补（感谢@oyiadin）：本系列笔记将添加《Games 101：现代计算机图形学入门》、《Games 102：几何建模与处理》、“龙书”（《Introduction to 3D Game Programming with DirectX 12》）三个额外来源的笔记。大段的非CMU课程的笔记会在显著位置标识。 Lecture 1什么是计算机图形学计算机图形学：利用计算机合成视觉信息或利用计算机合成/操控感官信息的学科。 计算机图形学的应用 影视 动画 游戏 数据可视化 工业设计，平面设计 数字绘画 虚拟现实 相同的内容后续整理VR课笔记时不再赘述。 虚拟现实（VR）：指所看到的一切均为虚拟的，比如虚拟现实游戏、虚拟现实视频等。 增强现实（AR）：指看到的是真实的现实 + 虚拟的、对当前现实进行分析处理或修改等生成的虚拟事物，比如Apple ARkit。 混合现实（MR）：VR + AR，使用类似VR的手段，达到AR这种结合当前现实与虚拟事物的效果，比如Hololens。 制造业（3D打印） 模拟 排版与字体设计 “The Quick Brown Fox Jumps Over The Lazy Dog”：一句有意义的英文句子，内含全部的26个英文字母，常用来对字体（字形、字号、间距等）进行测试。 “Lorem ipsum dolor sit amet, consectetur adipisicing elit.”：又叫“乱数假文”或者“哑元文本”。主要的目的为测试文章或文字在不同字型、版型下看起来的效果。更多资料请查阅：https://cn.lipsum.com/。 …… 计算机图形学与计算机视觉的区别计算机图形学：将数据转化为图形。也就是“画出来”。 计算机视觉：将图形转化为数据。也就是“看到”。 计算机图形学需要哪些基础 表示方法（编码） 采样与混叠 数学方法（表示动态和三位形体） 光线 透视 …… 对正方体建个模？ 如何表示 顶点：利用坐标 边：利用边的两个顶点唯一确定 如何绘制 三维图形转化为二维图形：小孔成像模型 设相机坐标为 $(a,b,c)$ ，待确定点的坐标为 $(x,y,z)$ 。要得到该点在二维平面上的坐标，可进行如下算法步骤： $(x,y,z)$ 与 $(a,b,c)$ 相减，得到原三维点与摄像机的相对位置； 将其中的 $(x,y)$ 与 $z$ 相除，得到 $(\\frac{x}{z},\\frac{y}{z})$，即是所求的 $(u,v)$。 连线。这就要细说到电脑如何绘制直线。","date_published":"2021-03-30T05:00:00.000Z","tags":["CG","笔记","WIP","CG"]},{"id":"https://www.zhouweitong.site/post/020-asus-c302-linux-installation/","url":"https://www.zhouweitong.site/post/020-asus-c302-linux-installation/","title":"ASUS C302CA Chromebook 安装 Linux 和 Windows","content_html":"<link rel=\"stylesheet\" type=\"text&#x2F;css\" href=\"https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.5.1/katex.min.css\"><link rel=\"stylesheet\" type=\"text&#x2F;css\" href=\"https://cdn.jsdelivr.net/npm/hexo-tag-hint@0.3.1/dist/hexo-tag-hint.min.css\"><p>图源：@山桂贰    <a href=\"https://www.pixiv.net/member_illust.php?mode=medium&illust_id=87141455\">87141455</a></p>\n<p>最近在咸鱼上淘到了一个二手的华硕 Chromebook（具体型号是 ASUS C302CA）。四核 M3-6Y30 + 8G 运行内存 + 32G eMMC 存储 + 12.5 寸触摸屏，虽然机身有少量磕碰，笔记本的转折铰链也有问题，但 800 元的价格着实实惠。</p>\n<p>机器寄过来的时候依然是原装系统（Power Wash 过的 Chrome OS）。写个文章记录一将 OS 从 Chrome OS 换成 Manjaro 和 Windows 10 的过程。</p>\n<h2 id=\"拆写保护（WP）螺丝\"><a href=\"# 拆写保护（WP）螺丝\" class=\"headerlink\" title=\"拆写保护（WP）螺丝\"></a>拆写保护（WP）螺丝</h2><p>Chromebook 的 BIOS 都是为了配合 Chrome OS 而特殊定做的，因此无法用来启动其他操作系统，没有 BIOS 设置界面，也无法升级 BIOS。但是可能是出于修理和防止可能的 BIOS 紧急固件更新，制造商仍然允许使用者解除 BIOS 的写入保护。常见的保护方式在 <a href=\"https://dev.chromium.org/chromium-os/firmware-porting-guide/firmware-ec-write-protection\">Chromium Projects Wiki</a> 里有详细说明：</p>\n<blockquote>\n<p><strong>Application Processor (AP) Firmware</strong></p>\n<p>AP firmware (also known as “SOC firmware”, “host firmware”, “main firmware” or even “BIOS”) typically resides on a SPI ROM. Protection registers on the SPI ROM are programmed to protect the read-only region, and these registers normally cannot be modified while the SPI ROM WP (write protect) pin is asserted. This pin is asserted through various physical means (see below), but with effort, users can unprotect devices they own.</p>\n<p><strong>Embedded Controller (EC) Firmware</strong></p>\n<p>The Chrome OS Embedded Controller (EC) typically has a WP input pin driven by the same hardware that generates SOC firmware write protect. While this pin is asserted, certain debug features (eg. arbitrary I2C access through host commands) are locked out. Some ECs load code from external storage, and for these ECs, RO protection works similar to SOC firmware RO protection (WP pin is asserted to EC SPI ROM). Other ECs use internal flash, and these ECs emulate SPI ROM protection registers, disabling write access to certain regions while the WP pin is asserted.</p>\n</blockquote>\n<span id=\"more\"></span>\n\n<p>解除写保护的操作在 Wiki 里同样有说明：</p>\n<blockquote>\n<p><strong>Methods of Asserting Write Protect</strong></p>\n<p>Throughout the history of Chrome OS devices, three main methods have been implemented for asserting (and removing) write protect:</p>\n<ul>\n<li>Switch - a toggle switch asserts WP to the SOC firmware SPI ROM and EC. WP can be deasserted by disassembling the device and flipping the switch.</li>\n<li>Screw - a screw shorts a pad on the PCB. While this screw is inserted, WP is asserted. WP can be deasserted by disassembling the device and removing this special screw.</li>\n<li>cr50 - a special security chip asserts the WP signal. While a battery is present on the device, the WP signal will be asserted. Disassembling the device and physically disconnecting the battery causes WP to be deasserted.</li>\n</ul>\n<p>More information about which protection method is used for a particular device, and where to locate the switch / screw, is available on the developer info page.</p>\n</blockquote>\n<p>ASUS C302CA 这个型号的超极本使用的是”Screw（螺丝）“方法，因此我们需要拆开后盖，拧下主板上的 BIOS 写保护螺丝。注意在拆卸背板的时候，有两颗螺丝藏在上侧脚垫下，需要先用工具去除脚垫再拆卸这两颗螺丝。下侧的两个脚垫下没有螺丝。如图所示，图片来源请 <a href=\"https://www.lafaspot.com/2017/03/asus-c302-internal-teardown-model-is-32.html\"> 点击此处</a>。</p>\n<img src=\"/2021/03/29/020-asus-c302-linux-installation/001.jpg\" class=\"\">\n\n<p>随后移除后盖，就能看到主板和电池。在主板上由小条黑布覆盖的螺丝即为写保护螺丝，小心拧下即可。位置见下图白色圈内，图片来源请 <a href=\"https://www.reddit.com/r/chromeos/comments/66dhgb/asus_flip_c302ca_write_protect_screw/\"> 点击此处</a>。</p>\n<img src=\"/2021/03/29/020-asus-c302-linux-installation/002.jpg\" class=\"\">\n\n<img src=\"/2021/03/29/020-asus-c302-linux-installation/003.jpg\" class=\"\">\n\n<img src=\"/2021/03/29/020-asus-c302-linux-installation/004.jpg\" class=\"\">\n\n<p>拧下保护螺丝后，将后盖放回拧好。之后进入 Chrome OS 开发者模式。</p>\n<h2 id=\"进入开发者模式\"><a href=\"# 进入开发者模式\" class=\"headerlink\" title=\"进入开发者模式\"></a>进入开发者模式 </h2><p> 按住键盘上的 Esc 和“刷新”键不动，然后按下电源键。这样 Chromebook 会进入“恢复”模式——有点像安卓手机上的 Recovery。</p>\n<blockquote>\n<p>此步骤开始，由于真实操作时没有保留图片，因此借用来源于网络的图片说明操作步骤。</p>\n</blockquote>\n<img src=\"/2021/03/29/020-asus-c302-linux-installation/005.png\" class=\"\">\n\n<p>同时按下键盘上的 Ctrl 键和 D 键，提示如下：</p>\n<img src=\"/2021/03/29/020-asus-c302-linux-installation/006.png\" class=\"\">\n\n<p>按下 Enter，系统重启：</p>\n<img src=\"/2021/03/29/020-asus-c302-linux-installation/007.png\" class=\"\">\n\n<p>这个时候应该会伴有一声 BIOS 提示音。这个提示音使用原版 BIOS 时是无法关闭的。为了安装其他操作系统和屏蔽该提示音，必须刷新 BIOS。</p>\n<p>随后等待 Chrome OS 重置即可。你需要重新配置和登录 Chrome OS 以启动 Shell。</p>\n<img src=\"/2021/03/29/020-asus-c302-linux-installation/008.png\" class=\"\">\n\n<h2 id=\"更换 BIOS 固件\"><a href=\"# 更换 BIOS 固件\" class=\"headerlink\" title=\"更换 BIOS 固件\"></a>更换 BIOS 固件 </h2><p> 使用到的是第三方维护的 BIOS，MrChromebox.tech。\n可到这里（<a href=\"https://mrchromebox.tech/#devices\">https://mrchromebox.tech/#devices</a>）查询你的 Chromebook 有没有适配。</p>\n<p>你需要准备：一个空的 U 盘</p>\n<p>下面开始操作。首先开机登录已处于开发者模式的 Chrome OS。按下组合键：<code>Ctrl + Alt + F2</code>。浏览器会打开新标签页，启动 crosh。</p>\n<img src=\"/2021/03/29/020-asus-c302-linux-installation/009.png\" class=\"\">\n\n<p>输入命令<code>shell</code>，回车，会启动真实的 Linux Shell。</p>\n<img src=\"/2021/03/29/020-asus-c302-linux-installation/010.png\" class=\"\">\n\n<p>插入空 U 盘，确保其已经挂载，随后在 Shell 内输入如下命令：</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">cd</span></span><br><span class=\"line\">curl -LO mrchromebox.tech/firmware-util.sh</span><br><span class=\"line\">sudo install -Dt /usr/<span class=\"built_in\">local</span>/bin -m 755 firmware-util.sh</span><br><span class=\"line\">sudo firmware-util.sh</span><br></pre></td></tr></table></figure>\n\n<p>成功下载并启动脚本后，有如下界面：</p>\n<img src=\"/2021/03/29/020-asus-c302-linux-installation/011.png\" class=\"\">\n\n<p>选择第一个选项（注：标识了“Full ROM”的选项），按照提示备份 BIOS 和刷入 BIOS，重启，即可。</p>\n<h2 id=\"安装操作系统\"><a href=\"# 安装操作系统\" class=\"headerlink\" title=\"安装操作系统\"></a>安装操作系统 </h2><p> 与正常电脑安装操作系统无异。需要注意以下几点：</p>\n<ul>\n<li><p>只支持 UEFI 启动。因此诸如 Windows 7 或 Tiny Core Linux 之类的操作系统是不行的。</p>\n</li>\n<li><p>制作可启动 U 盘：Windows 系列推荐使用 Windows PE（如 <a href=\"https://www.itsk.com/forum.php?mod=viewthread&tid=415848\"> 优启通</a>），Linux 系列推荐使用<a href=\"https://rufus.akeo.ie/\">Rufus</a>。</p>\n</li>\n<li><p>需要先使用分区工具，删除 Chromebook 的 eMMC 上所有分区后再进行安装。</p>\n</li>\n<li><p>对于 C302，Linux 下驱动基本完美。Win 下驱动稍微复杂：</p>\n<ul>\n<li><p>准备有线鼠标，通过扩展坞连接到 Chromebook，临时代替触摸板。</p>\n</li>\n<li><p>链接 WiFi，然后下载安装<a href=\"https://www.iobit.com/en/driver-booster.php\">DriverBooster</a>，可检测绝大多数驱动程序。将所有可更新的驱动程序更新至最新版本。</p>\n</li>\n<li><p>到这里（<a href=\"https://github.com/coolstar/driverinstallers/tree/master/crostouchpad\">https://github.com/coolstar/driverinstallers/tree/master/crostouchpad</a>），下载安装 4.1 版本驱动。</p>\n</li>\n<li><p>触摸板可以使用。触摸屏目前无解。</p>\n</li>\n</ul>\n</li>\n<li><p>Windows 和主流 Linux 下声卡问题目前无解，可用外置 USB 声卡或蓝牙耳机代替。如果你迫切需要使用 Chromebook 的内置扬声器，请安装<a href=\"https://galliumos.org/\">GalliumOS</a>。</p>\n</li>\n<li><p>内置 eMMC 存储空间较小。可通过 SD 卡槽插入 SD 卡（推荐 Class10 或更高），结合软链接（<a href=\"https://man7.org/linux/man-pages/man1/ln.1.html\">Linux</a>、<a href=\"https://schinagl.priv.at/nt/hardlinkshellext/linkshellextension.html\">Windows</a>均可）的方式保留存储空间。</p>\n</li>\n<li><p>Windows 安装时推荐启用 Compact 压缩。</p>\n</li>\n</ul>\n","content_text":"图源：@山桂贰 87141455 最近在咸鱼上淘到了一个二手的华硕 Chromebook（具体型号是 ASUS C302CA）。四核 M3-6Y30 + 8G 运行内存 + 32G eMMC 存储 + 12.5 寸触摸屏，虽然机身有少量磕碰，笔记本的转折铰链也有问题，但 800 元的价格着实实惠。 机器寄过来的时候依然是原装系统（Power Wash 过的 Chrome OS）。写个文章记录一将 OS 从 Chrome OS 换成 Manjaro 和 Windows 10 的过程。 拆写保护（WP）螺丝Chromebook 的 BIOS 都是为了配合 Chrome OS 而特殊定做的，因此无法用来启动其他操作系统，没有 BIOS 设置界面，也无法升级 BIOS。但是可能是出于修理和防止可能的 BIOS 紧急固件更新，制造商仍然允许使用者解除 BIOS 的写入保护。常见的保护方式在 Chromium Projects Wiki 里有详细说明： Application Processor (AP) Firmware AP firmware (also known as “SOC firmware”, “host firmware”, “main firmware” or even “BIOS”) typically resides on a SPI ROM. Protection registers on the SPI ROM are programmed to protect the read-only region, and these registers normally cannot be modified while the SPI ROM WP (write protect) pin is asserted. This pin is asserted through various physical means (see below), but with effort, users can unprotect devices they own. Embedded Controller (EC) Firmware The Chrome OS Embedded Controller (EC) typically has a WP input pin driven by the same hardware that generates SOC firmware write protect. While this pin is asserted, certain debug features (eg. arbitrary I2C access through host commands) are locked out. Some ECs load code from external storage, and for these ECs, RO protection works similar to SOC firmware RO protection (WP pin is asserted to EC SPI ROM). Other ECs use internal flash, and these ECs emulate SPI ROM protection registers, disabling write access to certain regions while the WP pin is asserted. 解除写保护的操作在 Wiki 里同样有说明： Methods of Asserting Write Protect Throughout the history of Chrome OS devices, three main methods have been implemented for asserting (and removing) write protect: Switch - a toggle switch asserts WP to the SOC firmware SPI ROM and EC. WP can be deasserted by disassembling the device and flipping the switch. Screw - a screw shorts a pad on the PCB. While this screw is inserted, WP is asserted. WP can be deasserted by disassembling the device and removing this special screw. cr50 - a special security chip asserts the WP signal. While a battery is present on the device, the WP signal will be asserted. Disassembling the device and physically disconnecting the battery causes WP to be deasserted. More information about which protection method is used for a particular device, and where to locate the switch / screw, is available on the developer info page. ASUS C302CA 这个型号的超极本使用的是”Screw（螺丝）“方法，因此我们需要拆开后盖，拧下主板上的 BIOS 写保护螺丝。注意在拆卸背板的时候，有两颗螺丝藏在上侧脚垫下，需要先用工具去除脚垫再拆卸这两颗螺丝。下侧的两个脚垫下没有螺丝。如图所示，图片来源请 点击此处。 随后移除后盖，就能看到主板和电池。在主板上由小条黑布覆盖的螺丝即为写保护螺丝，小心拧下即可。位置见下图白色圈内，图片来源请 点击此处。 拧下保护螺丝后，将后盖放回拧好。之后进入 Chrome OS 开发者模式。 进入开发者模式 按住键盘上的 Esc 和“刷新”键不动，然后按下电源键。这样 Chromebook 会进入“恢复”模式——有点像安卓手机上的 Recovery。 此步骤开始，由于真实操作时没有保留图片，因此借用来源于网络的图片说明操作步骤。 同时按下键盘上的 Ctrl 键和 D 键，提示如下： 按下 Enter，系统重启： 这个时候应该会伴有一声 BIOS 提示音。这个提示音使用原版 BIOS 时是无法关闭的。为了安装其他操作系统和屏蔽该提示音，必须刷新 BIOS。 随后等待 Chrome OS 重置即可。你需要重新配置和登录 Chrome OS 以启动 Shell。 更换 BIOS 固件 使用到的是第三方维护的 BIOS，MrChromebox.tech。 可到这里（https://mrchromebox.tech/#devices）查询你的 Chromebook 有没有适配。 你需要准备：一个空的 U 盘 下面开始操作。首先开机登录已处于开发者模式的 Chrome OS。按下组合键：Ctrl + Alt + F2。浏览器会打开新标签页，启动 crosh。 输入命令shell，回车，会启动真实的 Linux Shell。 插入空 U 盘，确保其已经挂载，随后在 Shell 内输入如下命令： 1234cdcurl -LO mrchromebox.tech/firmware-util.shsudo install -Dt /usr/local/bin -m 755 firmware-util.shsudo firmware-util.sh 成功下载并启动脚本后，有如下界面： 选择第一个选项（注：标识了“Full ROM”的选项），按照提示备份 BIOS 和刷入 BIOS，重启，即可。 安装操作系统 与正常电脑安装操作系统无异。需要注意以下几点： 只支持 UEFI 启动。因此诸如 Windows 7 或 Tiny Core Linux 之类的操作系统是不行的。 制作可启动 U 盘：Windows 系列推荐使用 Windows PE（如 优启通），Linux 系列推荐使用Rufus。 需要先使用分区工具，删除 Chromebook 的 eMMC 上所有分区后再进行安装。 对于 C302，Linux 下驱动基本完美。Win 下驱动稍微复杂： 准备有线鼠标，通过扩展坞连接到 Chromebook，临时代替触摸板。 链接 WiFi，然后下载安装DriverBooster，可检测绝大多数驱动程序。将所有可更新的驱动程序更新至最新版本。 到这里（https://github.com/coolstar/driverinstallers/tree/master/crostouchpad），下载安装 4.1 版本驱动。 触摸板可以使用。触摸屏目前无解。 Windows 和主流 Linux 下声卡问题目前无解，可用外置 USB 声卡或蓝牙耳机代替。如果你迫切需要使用 Chromebook 的内置扬声器，请安装GalliumOS。 内置 eMMC 存储空间较小。可通过 SD 卡槽插入 SD 卡（推荐 Class10 或更高），结合软链接（Linux、Windows均可）的方式保留存储空间。 Windows 安装时推荐启用 Compact 压缩。","summary":"图源：@山桂贰 87141455 最近在咸鱼上淘到了一个二手的华硕 Chromebook（具体型号是 ASUS C302CA）。四核 M3-6Y30 + 8G 运行内存+ 32G eMMC 存储 + 12.5 寸触摸屏，虽然机身有少量磕碰，笔记本的转折铰链也有问题，但 800 元的价格着实实惠。 机器寄过来的时候依然是原装系统（Power Wash 过的 Chrome OS）。写个文章记录一将 OS 从 Chrome OS 换成 Manjaro 和 Windows 10 的过程。 拆写保护（WP）螺丝Chromebook 的 BIOS 都是为了配合 Chrome OS 而特殊定做的，因此无法用来启动其他操作系统，没有 BIOS 设置界面，也无法升级 BIOS。但是可能是出于修理和防止可能的 BIOS 紧急固件更新，制造商仍然允许使用者解除 BIOS 的写入保护。常见的保护方式在 Chromium Projects Wiki 里有详细说明： Application Processor (AP) Firmware AP firmware (also known as “SOC firmware”, “host firmware”, “main firmware” or even “BIOS”) typically resides on a SPI ROM. Protection registers on the SPI ROM are programmed to protect the read-only region, and these registers normally cannot be modified while the SPI ROM WP (write protect) pin is asserted. This pin is asserted through various physical means (see below), but with effort, users can unprotect devices they own. Embedded Controller (EC) Firmware The Chrome OS Embedded Controller (EC) typically has a WP input pin driven by the same hardware that generates SOC firmware write protect. While this pin is asserted, certain debug features (eg. arbitrary I2C access through host commands) are locked out. Some ECs load code from external storage, and for these ECs, RO protection works similar to SOC firmware RO protection (WP pin is asserted to EC SPI ROM). Other ECs use internal flash, and these ECs emulate SPI ROM protection registers, disabling write access to certain regions while the WP pin is asserted.","date_published":"2021-03-29T08:30:00.000Z","tags":["自由探索","完成编写","搞机玩家"]},{"id":"https://www.zhouweitong.site/post/029-cmu-csapp-note-1/","url":"https://www.zhouweitong.site/post/029-cmu-csapp-note-1/","title":"【WIP】CMU 15-213 笔记 Part.1","content_html":"<link rel=\"stylesheet\" type=\"text&#x2F;css\" href=\"https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.5.1/katex.min.css\"><link rel=\"stylesheet\" type=\"text&#x2F;css\" href=\"https://cdn.jsdelivr.net/npm/hexo-tag-hint@0.3.1/dist/hexo-tag-hint.min.css\"><h2 id=\"Lecture-1\"><a href=\"#Lecture-1\" class=\"headerlink\" title=\"Lecture 1\"></a>Lecture 1</h2><h3 id=\"实验\"><a href=\"# 实验\" class=\"headerlink\" title=\"实验\"></a>实验</h3><p>Lab1：数据实验，用位运算方式实现计算器</p>\n<p>Lab2：炸弹实验，学会 GDB</p>\n<p>Lab3：攻击实验，代码注入和 ROP</p>\n<p>Lab4：缓存实验，写个缓存模拟器并优化</p>\n<p>Lab5：Shell 实验，写一个完整的 Linux Shell</p>\n<p>Lab6：Malloc 实验，写自己的 Malloc 库</p>\n<p>Lab7：代理实验，写自己的 Web Proxy</p>\n<h2 id=\"Lecture-2\"><a href=\"#Lecture-2\" class=\"headerlink\" title=\"Lecture 2\"></a>Lecture 2</h2><blockquote>\n<p>比特、字节和整数</p>\n</blockquote>\n<ul>\n<li><p>long double 数据类型：在传统的 32 位架构或 64 位架构中是没有的。但在 x86-64 架构中占 10 或 16 字节（内存对齐）。</p>\n</li>\n<li><p>32 位架构的指针为 32 位（4 字节），64 位架构的指针为 64 位（8 字节）。</p>\n</li>\n<li><p>布尔代数：和 或 非 异或</p>\n</li>\n<li><p>位运算符 &amp; | ~ ^，逻辑运算符 &amp;&amp; || !</p>\n</li>\n<li><p>逻辑运算的短路特性</p>\n</li>\n<li><p>逻辑位移和算数位移：</p>\n<ul>\n<li>在位移运算符之前的数（比如 $x&lt;&lt;y$ 中的 $x$）是无符号数的话，位移运算对应的汇编指令为逻辑位移。若是有符号数，该运算对应的汇编指令是算数位移。</li>\n<li>对于左移：二者都是在右侧补 0。</li>\n<li>对于右移：逻辑位移补 0，算数位移补最高有效位（符号位）。如：令 $x=10100000_{(2)}$，右移 3 位，逻辑位移结果 $x&gt;&gt;3=00010100_{(2)}$，算数位移结果 $x&gt;&gt;3=11110100_{(2)}$。</li>\n</ul>\n</li>\n<li><p>位移数小于 0（即 $x&lt;&lt;y$ 中的 $y$ 小于 0）或大于数据类型占用的长度（如 char 类型中 y 大于 8）是未定义的操作。结果和编译情况依编译器和架构变化。</p>\n</li>\n<li><p>正数原码转十进制：求 2 的幂次加和即可。</p>\n</li>\n</ul>\n<p>$$\n    B2U(X) = \\sum^{w-1}_{i=0}{x_i \\cdot 2^i}\n$$</p>\n<ul>\n<li>补码转十进制：注意符号位。也可写成公式。</li>\n</ul>\n<p>$$\n    B2T(X) = -x_{w-1} \\cdot 2^{w-1} + \\sum^{w-2}_{i=0}{x_i \\cdot 2^i}\n$$</p>\n<ul>\n<li>补码计算举例：将补码 $101101_{(2)}$ 化为十进制。</li>\n</ul>\n<p>$$\n    依据公式，\\\\\n    101101_{2} = 2^{0} \\cdot 1 + 2^{1} \\cdot 0 + 2^{2} \\cdot 1 + 2^{3} \\cdot 1 + 2^{4} \\cdot 0 + 2^{5} \\cdot (-1) \\\\\n    = 1 + 0 + 4 + 8 + 0 - 32 = -19\n$$</p>\n<ul>\n<li>无符号数最大值 $2^w - 1$，最小值 $0$。有符号数最大值 $2^{w-1} - 1$，最小值 $-2^{w-1}$。</li>\n</ul>\n<span id=\"more\"></span>\n\n<ul>\n<li>补码对数的映射具有“对称性”。</li>\n</ul>\n<p><img src=\"/2021/03/20/029-cmu-csapp-note-1/image-20210411163333866.png\" alt=\"image-20210411163333866\"></p>\n<ul>\n<li>补码与原码（无符号位）间的转化。</li>\n</ul>\n<p><img src=\"/2021/03/20/029-cmu-csapp-note-1/image-20210411163354037.png\" alt=\"image-20210411163354037\"></p>\n<ul>\n<li>C 语言上二者的互相转化。</li>\n</ul>\n<figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">tx = (<span class=\"keyword\">int</span>) ux;</span><br><span class=\"line\">uy = (<span class=\"keyword\">unsigned</span>) ty; <span class=\"comment\">// unsigned 等价于 unsigned int</span></span><br></pre></td></tr></table></figure>\n\n<ul>\n<li><p>有符号数与无符号数进行操作时（例如，有符号数与无符号数相加），有符号数会被隐式转换为无符号数。</p>\n</li>\n<li><p>注意在有条件限定的情况下，下列运算的运算结果：</p>\n</li>\n</ul>\n<p><img src=\"/2021/03/20/029-cmu-csapp-note-1/image-20210411163406261.png\" alt=\"image-20210411163406261\"></p>\n<ul>\n<li>一个 C 编程中的典型错误：</li>\n</ul>\n<figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">int</span> a[<span class=\"number\">250</span>] = &#123;<span class=\"number\">0</span>&#125;;</span><br><span class=\"line\"><span class=\"keyword\">unsigned</span> <span class=\"keyword\">int</span> i; <span class=\"comment\">// 注意是无符号整型 </span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">for</span>(i = <span class=\"number\">249</span>; i &gt;= <span class=\"number\">0</span>; i--) &#123;</span><br><span class=\"line\">    a[i] = <span class=\"number\">5</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/*</span></span><br><span class=\"line\"><span class=\"comment\"> 运行的结果为：遍历数组 a，每个元素均赋值为 5 后，访问非法下标。</span></span><br><span class=\"line\"><span class=\"comment\">由于 i 是无符号的数，i=0 时 for 循环进行后，i--，导致 i 溢出为 4294967295。</span></span><br><span class=\"line\"><span class=\"comment\">*/</span></span><br></pre></td></tr></table></figure>\n\n<ul>\n<li><p>符号扩展：对有符号整数的类型转换是通过左侧截断和左侧补最高有效位（符号位）实现的。</p>\n<p>  例子：设 6 位整数 a 的十进制值为 10，则其二进制位为 $001010$。将其扩展为 10 位整数，二进制位为 $0000001010$。</p>\n<p>  设 6 位整数的十进制值为 -10，则其二进制位（补码）为 $110110$。将其扩展为 10 位整数，二进制位为 $1111110110$。</p>\n</li>\n<li><p>原码取 2 的幂次模：相当于从右边截断。</p>\n<p>  例子：数字 10 对 4 取模。通过十进制计算，$10=4*2+2$，得取模结果为 2。</p>\n<p>  从原码的角度来看，10 的原码为 $1010_{(2)}$。对 4 取模，即对 $2^2$ 取模。从右向左保留两位后截断即可，结果即为 $10_{(2)}$，转化为 10 进制为 2。</p>\n</li>\n</ul>\n<h2 id=\"Lecture-3\"><a href=\"#Lecture-3\" class=\"headerlink\" title=\"Lecture 3\"></a>Lecture 3</h2>","content_text":"Lecture 1实验Lab1：数据实验，用位运算方式实现计算器 Lab2：炸弹实验，学会 GDB Lab3：攻击实验，代码注入和 ROP Lab4：缓存实验，写个缓存模拟器并优化 Lab5：Shell 实验，写一个完整的 Linux Shell Lab6：Malloc 实验，写自己的 Malloc 库 Lab7：代理实验，写自己的 Web Proxy Lecture 2 比特、字节和整数 long double 数据类型：在传统的 32 位架构或 64 位架构中是没有的。但在 x86-64 架构中占 10 或 16 字节（内存对齐）。 32 位架构的指针为 32 位（4 字节），64 位架构的指针为 64 位（8 字节）。 布尔代数：和 或 非 异或 位运算符 &amp; | ~ ^，逻辑运算符 &amp;&amp; || ! 逻辑运算的短路特性 逻辑位移和算数位移： 在位移运算符之前的数（比如 $x&lt;&lt;y$ 中的 $x$）是无符号数的话，位移运算对应的汇编指令为逻辑位移。若是有符号数，该运算对应的汇编指令是算数位移。 对于左移：二者都是在右侧补 0。 对于右移：逻辑位移补 0，算数位移补最高有效位（符号位）。如：令 $x=10100000_{(2)}$，右移 3 位，逻辑位移结果 $x&gt;&gt;3=00010100_{(2)}$，算数位移结果 $x&gt;&gt;3=11110100_{(2)}$。 位移数小于 0（即 $x&lt;&lt;y$ 中的 $y$ 小于 0）或大于数据类型占用的长度（如 char 类型中 y 大于 8）是未定义的操作。结果和编译情况依编译器和架构变化。 正数原码转十进制：求 2 的幂次加和即可。 $$ B2U(X) = \\sum^{w-1}_{i=0}{x_i \\cdot 2^i} $$ 补码转十进制：注意符号位。也可写成公式。 $$ B2T(X) = -x_{w-1} \\cdot 2^{w-1} + \\sum^{w-2}_{i=0}{x_i \\cdot 2^i} $$ 补码计算举例：将补码 $101101_{(2)}$ 化为十进制。 $$ 依据公式，\\\\ 101101_{2} = 2^{0} \\cdot 1 + 2^{1} \\cdot 0 + 2^{2} \\cdot 1 + 2^{3} \\cdot 1 + 2^{4} \\cdot 0 + 2^{5} \\cdot (-1) \\\\ = 1 + 0 + 4 + 8 + 0 - 32 = -19 $$ 无符号数最大值 $2^w - 1$，最小值 $0$。有符号数最大值 $2^{w-1} - 1$，最小值 $-2^{w-1}$。 补码对数的映射具有“对称性”。 补码与原码（无符号位）间的转化。 C 语言上二者的互相转化。 12tx = (int) ux;uy = (unsigned) ty; // unsigned 等价于 unsigned int 有符号数与无符号数进行操作时（例如，有符号数与无符号数相加），有符号数会被隐式转换为无符号数。 注意在有条件限定的情况下，下列运算的运算结果： 一个 C 编程中的典型错误： 1234567891011int a[250] = &#123;0&#125;;unsigned int i; // 注意是无符号整型 for(i = 249; i &gt;= 0; i--) &#123; a[i] = 5;&#125;/* 运行的结果为：遍历数组 a，每个元素均赋值为 5 后，访问非法下标。由于 i 是无符号的数，i=0 时 for 循环进行后，i--，导致 i 溢出为 4294967295。*/ 符号扩展：对有符号整数的类型转换是通过左侧截断和左侧补最高有效位（符号位）实现的。 例子：设 6 位整数 a 的十进制值为 10，则其二进制位为 $001010$。将其扩展为 10 位整数，二进制位为 $0000001010$。 设 6 位整数的十进制值为 -10，则其二进制位（补码）为 $110110$。将其扩展为 10 位整数，二进制位为 $1111110110$。 原码取 2 的幂次模：相当于从右边截断。 例子：数字 10 对 4 取模。通过十进制计算，$10=4*2+2$，得取模结果为 2。 从原码的角度来看，10 的原码为 $1010_{(2)}$。对 4 取模，即对 $2^2$ 取模。从右向左保留两位后截断即可，结果即为 $10_{(2)}$，转化为 10 进制为 2。 Lecture 3","summary":"Lecture 1实验Lab1：数据实验，用位运算方式实现计算器 Lab2：炸弹实验，学会GDB Lab3：攻击实验，代码注入和ROP Lab4：缓存实验，写个缓存模拟器并优化 Lab5：Shell实验，写一个完整的Linux Shell Lab6：Malloc实验，写自己的Malloc库 Lab7：代理实验，写自己的Web Proxy Lecture 2 比特、字节和整数 long double数据类型：在传统的32位架构或64位架构中是没有的。但在x86-64架构中占10或16字节（内存对齐）。 32位架构的指针为32位（4字节），64位架构的指针为64位（8字节）。 布尔代数：和 或 非 异或 位运算符 &amp; | ~ ^，逻辑运算符 &amp;&amp; || ! 逻辑运算的短路特性 逻辑位移和算数位移： 在位移运算符之前的数（比如$x&lt;&lt;y$中的$x$）是无符号数的话，位移运算对应的汇编指令为逻辑位移。若是有符号数，该运算对应的汇编指令是算数位移。 对于左移：二者都是在右侧补0。 对于右移：逻辑位移补0，算数位移补最高有效位（符号位）。如：令$x=10100000_{(2)}$，右移3位，逻辑位移结果$x&gt;&gt;3=00010100_{(2)}$，算数位移结果$x&gt;&gt;3=11110100_{(2)}$。 位移数小于0（即$x&lt;&lt;y$中的$y$小于0）或大于数据类型占用的长度（如char类型中y大于8）是未定义的操作。结果和编译情况依编译器和架构变化。 正数原码转十进制：求2的幂次加和即可。 $$ B2U(X) = \\sum^{w-1}_{i=0}{x_i \\cdot 2^i} $$ 补码转十进制：注意符号位。也可写成公式。 $$ B2T(X) = -x_{w-1} \\cdot 2^{w-1} + \\sum^{w-2}_{i=0}{x_i \\cdot 2^i} $$ 补码计算举例：将补码$101101_{(2)}$化为十进制。 $$ 依据公式，\\\\ 101101_{2} = 2^{0} \\cdot 1 + 2^{1} \\cdot 0 + 2^{2} \\cdot 1 + 2^{3} \\cdot 1 + 2^{4} \\cdot 0 + 2^{5} \\cdot (-1) \\\\ = 1 + 0 + 4 + 8 + 0 - 32 = -19 $$ 无符号数最大值$2^w - 1$，最小值$0$。有符号数最大值$2^{w-1} - 1$，最小值$-2^{w-1}$。","date_published":"2021-03-20T06:00:00.000Z","tags":["开发与代码","笔记","WIP","CSAPP"]},{"id":"https://www.zhouweitong.site/post/015-unpack-tricolour-lovestory/","url":"https://www.zhouweitong.site/post/015-unpack-tricolour-lovestory/","title":"【WIP】解包《三色Δ绘恋》，与 Kirikiri 初探","content_html":"<link rel=\"stylesheet\" type=\"text&#x2F;css\" href=\"https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.5.1/katex.min.css\"><link rel=\"stylesheet\" type=\"text&#x2F;css\" href=\"https://cdn.jsdelivr.net/npm/hexo-tag-hint@0.3.1/dist/hexo-tag-hint.min.css\"><p>图源：《三色Δ绘恋》内附 圣诞节特别篇 “圣夜钟音” 主题桌面壁纸</p>\n<p>舍友买了一份《三色Δ绘恋》，其中的立绘和音乐水准相当不错。某天于是突发奇想，从舍友那里拷贝了份游戏的文件，打算把里面的立绘和音频提取出来。</p>\n<p><img src=\"/2019/10/07/015-unpack-tricolour-lovestory/image-20210411162311645.png\" alt=\"image-20210411162311645\"></p>\n<p>于是开始操作。</p>\n<h2 id=\"确定引擎，准备工具\"><a href=\"# 确定引擎，准备工具\" class=\"headerlink\" title=\"确定引擎，准备工具\"></a>确定引擎，准备工具 </h2><p> 整体的文件结构相当清晰，显然 TricolourLovestory_chs.exe 是中文版本的主程序，TricolourLovestory_chs.cf 是中文版本的启动配置文件，steam_api.dll 是连接 Steam 进行软件正版验证、存档上传等功能的插件，其他的 xp3 文件就是我们要找的资源包了。所以针对此文件格式，寻找对应的工具，进行解包。</p>\n<p>经过 Google 和 Github 的多方搜索，找到了两个最为常用的工具，<a href=\"https://github.com/lioncash/ExtractData\">ExtractData</a> 与 <a href=\"https://github.com/xmoeproject/KrkrExtract\">KrkrExtract</a>。前者可以对资源包内的文件进行提取，后者可以对资源包内的文件进行提取、修改和删除。这里我们使用普适性更强的 ExtractData 进行提取操作。</p>\n<span id=\"more\"></span>\n\n<h2 id=\"无脑提取\"><a href=\"# 无脑提取\" class=\"headerlink\" title=\"无脑提取\"></a>无脑提取 </h2><p> 打开 ExtractData，再打开待分析的 xp3 文件即可。</p>\n<p><img src=\"/2019/10/07/015-unpack-tricolour-lovestory/image-20210411162342815.png\" alt=\"image-20210411162342815\"></p>\n<p>上图即是分析后的结果，在想要提取的文件上右键，“Extract Selected Range”即可提取出此文件。同时在“Quick Settings”中可以看到 ExtractData 对某些格式文件默认的转换设置（比如 JPG 转换为 PNG），如果不需要自动转换可以在解压的时候选择“Extract Selection without conversion”。</p>\n<p>xp3 类型一般都是 Kirikiri 游戏引擎的资源包类型。某些非媒体类的内容，如脚本和文本，在 Kirikiri 引擎打包资源的过程中会被 zlib 库压缩。ExtractData 也可以识别并解压。</p>\n","content_text":"图源：《三色Δ绘恋》内附 圣诞节特别篇 “圣夜钟音” 主题桌面壁纸 舍友买了一份《三色Δ绘恋》，其中的立绘和音乐水准相当不错。某天于是突发奇想，从舍友那里拷贝了份游戏的文件，打算把里面的立绘和音频提取出来。 于是开始操作。 确定引擎，准备工具 整体的文件结构相当清晰，显然 TricolourLovestory_chs.exe 是中文版本的主程序，TricolourLovestory_chs.cf 是中文版本的启动配置文件，steam_api.dll 是连接 Steam 进行软件正版验证、存档上传等功能的插件，其他的 xp3 文件就是我们要找的资源包了。所以针对此文件格式，寻找对应的工具，进行解包。 经过 Google 和 Github 的多方搜索，找到了两个最为常用的工具，ExtractData 与 KrkrExtract。前者可以对资源包内的文件进行提取，后者可以对资源包内的文件进行提取、修改和删除。这里我们使用普适性更强的 ExtractData 进行提取操作。 无脑提取 打开 ExtractData，再打开待分析的 xp3 文件即可。 上图即是分析后的结果，在想要提取的文件上右键，“Extract Selected Range”即可提取出此文件。同时在“Quick Settings”中可以看到 ExtractData 对某些格式文件默认的转换设置（比如 JPG 转换为 PNG），如果不需要自动转换可以在解压的时候选择“Extract Selection without conversion”。 xp3 类型一般都是 Kirikiri 游戏引擎的资源包类型。某些非媒体类的内容，如脚本和文本，在 Kirikiri 引擎打包资源的过程中会被 zlib 库压缩。ExtractData 也可以识别并解压。","summary":"图源：《三色Δ绘恋》内附 圣诞节特别篇 “圣夜钟音” 主题桌面壁纸 舍友买了一份《三色Δ绘恋》，其中的立绘和音乐水准相当不错。某天于是突发奇想，从舍友那里拷贝了份游戏的文件，打算把里面的立绘和音频提取出来。 于是开始操作。 确定引擎，准备工具整体的文件结构相当清晰，显然 TricolourLovestory_chs.exe 是中文版本的主程序，TricolourLovestory_chs.cf 是中文版本的启动配置文件，steam_api.dll 是连接 Steam 进行软件正版验证、存档上传等功能的插件，其他的 xp3 文件就是我们要找的资源包了。所以针对此文件格式，寻找对应的工具，进行解包。 经过 Google 和 Github 的多方搜索，找到了两个最为常用的工具，ExtractData 与 KrkrExtract。前者可以对资源包内的文件进行提取，后者可以对资源包内的文件进行提取、修改和删除。这里我们使用普适性更强的 ExtractData 进行提取操作。","date_published":"2019-10-07T08:00:00.000Z","tags":["自由探索","WIP","游戏解包"]},{"id":"https://www.zhouweitong.site/post/018-php-7-3-compile-and-ext/","url":"https://www.zhouweitong.site/post/018-php-7-3-compile-and-ext/","title":"PHP 及 PHP 插件编译","content_html":"<link rel=\"stylesheet\" type=\"text&#x2F;css\" href=\"https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.5.1/katex.min.css\"><link rel=\"stylesheet\" type=\"text&#x2F;css\" href=\"https://cdn.jsdelivr.net/npm/hexo-tag-hint@0.3.1/dist/hexo-tag-hint.min.css\"><p>图源：《明日方舟》 战场背景 2</p>\n<p>今后文章会同步更新在 <a href=\"https://blog.csdn.net/weixin_44911246\"> 我的 CSDN 博客</a>，但是还是以这个自己拿阿里云服务器搭建的网站为主的。不过 CSDN 有个好处是可以被国内的搜索引擎抓取到，嗯，省得我做搜索引擎优化了啊。</p>\n<p>如果有人只想看完整写完的文章的话，也请左拐 CSDN，或者 <a href=\"https://www.zhouweitong.site/tags/%E5%AE%8C%E6%88%90%E7%BC%96%E5%86%99/\"> 这里</a>。主站开了七牛云加速，顺便做了 Google 、 Bing 和百度等的搜索引擎收录。最近身体欠佳。原定的学习计划和博客更新计划也不出意外的咕了。没有办法。健康是第一要务。等待过后慢慢去补吧。</p>\n<h2 id=\"编译 -PHP\"><a href=\"# 编译 -PHP\" class=\"headerlink\" title=\"编译 PHP\"></a>编译 PHP</h2><h3 id=\"安装必要环境\"><a href=\"# 安装必要环境\" class=\"headerlink\" title=\"安装必要环境\"></a>安装必要环境 </h3><p> 包含编译器，和编译需要的库。所有的编译操作均在 Ubuntu 19.04 下进行。</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo apt-get update</span><br><span class=\"line\">sudo apt install -y gcc g++ cmake make libxml2-dev libbz2-dev libcurl4-gnutls-dev libzip-dev libwebp-dev libpng-dev libjpeg-dev libxpm-dev libfreetype6-dev</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"下载源码\"><a href=\"# 下载源码\" class=\"headerlink\" title=\"下载源码\"></a>下载源码 </h3><p> 你可以 clone GitHub 上的代码：</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">git <span class=\"built_in\">clone</span> https://github.com/php/php-src.git</span><br></pre></td></tr></table></figure>\n\n<p>当然也可以到 <a href=\"https://www.php.net/downloads.php\">php.net</a> 下载源码并解压：</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">wget https://www.php.net/distributions/php-7.3.7.tar.gz</span><br><span class=\"line\">tar -xvzf php-7.3.7.tar.gz</span><br><span class=\"line\">rm php-7.3.7.tar.gz</span><br><span class=\"line\"><span class=\"built_in\">cd</span> php-7.3.7/</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"开始编译\"><a href=\"# 开始编译\" class=\"headerlink\" title=\"开始编译\"></a>开始编译 </h3><p> 首先读取插件列表（插件列表没有修改的时候可跳过此步骤）：</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">./buildconf --force</span><br></pre></td></tr></table></figure>\n\n<span id=\"more\"></span>\n\n<p>然后进行基本配置：</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">mkdir phpbin</span><br><span class=\"line\">./configure \\</span><br><span class=\"line\">            --prefix=~/Document/phpbin \\ <span class=\"comment\"># 是非程序文件 install 的位置</span></span><br><span class=\"line\">            --exec-prefix=~/Document/phpbin \\ <span class=\"comment\"># 是程序文件 install 的位置</span></span><br><span class=\"line\">            --enable-fpm \\</span><br><span class=\"line\">            --enable-cli \\</span><br><span class=\"line\">            --enable-embed=shared \\</span><br><span class=\"line\">            --enable-phpdbg \\</span><br><span class=\"line\">            --enable-phpdbg-webhelper \\</span><br><span class=\"line\">            --enable-phpdbg-debug \\</span><br><span class=\"line\">            --enable-debug \\</span><br><span class=\"line\">            --enable-bcmath \\</span><br><span class=\"line\">            --enable-calendar \\</span><br><span class=\"line\">            --enable-exif \\</span><br><span class=\"line\">            --enable-ftp \\</span><br><span class=\"line\">            --enable-intl \\</span><br><span class=\"line\">            --enable-mbstring \\</span><br><span class=\"line\">            --with-curl \\</span><br><span class=\"line\">            --enable-embedded-mysqli \\</span><br><span class=\"line\">            --enable-pcntl \\</span><br><span class=\"line\">            --enable-shmop \\</span><br><span class=\"line\">            --enable-soap \\</span><br><span class=\"line\">            --enable-sockets \\</span><br><span class=\"line\">            --enable-sysvmsg \\</span><br><span class=\"line\">            --enable-sysvsem \\</span><br><span class=\"line\">            --enable-sysvshm \\</span><br><span class=\"line\">            --enable-wddx \\</span><br><span class=\"line\">            --enable-zip \\</span><br><span class=\"line\">            --with-zlib \\</span><br><span class=\"line\">            --with-zlib-dir \\</span><br><span class=\"line\">            --with-pcre-jit \\</span><br><span class=\"line\">            --with-pcre-regex \\</span><br><span class=\"line\">            --with-iconv \\</span><br><span class=\"line\">            --enable-mysqlnd \\</span><br><span class=\"line\">            --enable-pdo \\</span><br><span class=\"line\">            --enable-hash \\</span><br><span class=\"line\">            --enable-ctype \\</span><br><span class=\"line\">            --enable-json \\</span><br><span class=\"line\">            --enable-session \\</span><br><span class=\"line\">            --enable-xml \\</span><br><span class=\"line\">            --enable-libxml \\</span><br><span class=\"line\">            --enable-simplexml \\</span><br><span class=\"line\">            --enable-fileinfo \\</span><br><span class=\"line\">            --with-openssl \\</span><br><span class=\"line\">            --with-gd \\</span><br><span class=\"line\">            --with-webp-dir \\</span><br><span class=\"line\">            --with-jpeg-dir \\</span><br><span class=\"line\">            --with-png-dir \\</span><br><span class=\"line\">            --with-xpm-dir</span><br></pre></td></tr></table></figure>\n\n<p>随后手动修改 <code>Makefile</code>，手动将<code>CFLAGS_CLEAN</code> 改成如下内容：</p>\n<figure class=\"highlight makefile\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">CFLAGS_CLEAN = -I/usr/<span class=\"keyword\">include</span> -g -O0 -Wall <span class=\"variable\">$(PROF_FLAGS)</span></span><br></pre></td></tr></table></figure>\n\n<p>最后，开始多线程编译：</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">make all -j8</span><br><span class=\"line\">make install</span><br></pre></td></tr></table></figure>\n\n<p>php 程序主文件在  <code>~/Document/phpbin/bin/php</code> 处。</p>\n<h2 id=\"生成插件\"><a href=\"# 生成插件\" class=\"headerlink\" title=\"生成插件\"></a>生成插件 </h2><p> 生成插件需使用刚刚编译好的 php 可执行文件。当然你也可以额外在系统中安装一套 php（环境）以备不时之需。</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo apt install -y apache2 php7 php-xdebug mysql-server mysql-client</span><br></pre></td></tr></table></figure>\n\n<p>随后到 php 源码文件夹、ext 文件夹下，运行</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">php ./ext_skel.php --ext hello_obj</span><br></pre></td></tr></table></figure>\n\n<p>如果已知插件应用的平台的话，可以加上 <code>--onlyunix</code> 或 <code>--onlywindows</code> 避免生成其他平台的 config 文件。</p>\n<p>在 <code>config.m4</code> 文件中，注意前面的编译命令部分，如果你的插件是独立的，取消掉下面两行的注释（<code>dnl</code>）：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">PHP_ARG_ENABLE(hello_obj, whether to enable hello_obj support,</span><br><span class=\"line\">[--enable-hello_obj          Enable hello_obj support], no)</span><br></pre></td></tr></table></figure>\n\n<p>但是如果你的插件依赖了其他插件的代码（头文件等），你需要保持上面两行的注释并取消下面两行的注释：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">PHP_ARG_WITH(hello_obj, for hello_obj support,</span><br><span class=\"line\">[--with-hello_obj             Include hello_obj support])</span><br></pre></td></tr></table></figure>\n\n<p>注意，不同段的注释要保证对齐。</p>\n<h2 id=\"编译插件\"><a href=\"# 编译插件\" class=\"headerlink\" title=\"编译插件\"></a>编译插件 </h2><p> 最常见的两种方法：重新编译 php 本体和使用 phpize 单独编译插件。</p>\n<p>编译 php 本体的办法很简单，即在 <code>./configure</code> 步骤处看情况加入 <code>--enable-hello_obj</code> 或 <code>--with-hello_obj</code> 参数即可。这种情况下，当没有 php.ini 配置文件时，插件是默认启用的，利用</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">php -r <span class=\"string\">&quot;phpinfo();&quot;</span></span><br></pre></td></tr></table></figure>\n\n<p>命令可以查看 phpinfo()输出信息。</p>\n<p>用 phpize 的话，请注意使用 <strong>你编译 PHP 时 prefix 指定的目录下的 phpize（~/Document/phpbin/bin/phpize）</strong>，保证版本一致。</p>\n<p><code>cd</code>到插件源码所在的目录，运行<code>phpsize</code>，会生成编译所需文件。</p>\n<p>随后执行</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">./configure --with-php-config=&lt;php-config bin&gt;</span><br></pre></td></tr></table></figure>\n\n<p>其中 php-config bin 为 <strong>你编译 PHP 时 prefix 指定的目录下的 php-config（~/Document/phpbin/bin/php-config）</strong>。</p>\n<p>编译并安装。</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">make</span><br><span class=\"line\">make install</span><br></pre></td></tr></table></figure>\n\n<p>.so 文件会自动复制到插件文件夹。在 php.ini 中加载插件即可。</p>\n<figure class=\"highlight ini\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">extension</span>=hello_obj.so</span><br></pre></td></tr></table></figure>\n\n<p>当然，你也可以用 phpize 编译安装 Xdebug 等外置 php 插件。</p>\n","content_text":"图源：《明日方舟》 战场背景 2 今后文章会同步更新在 我的 CSDN 博客，但是还是以这个自己拿阿里云服务器搭建的网站为主的。不过 CSDN 有个好处是可以被国内的搜索引擎抓取到，嗯，省得我做搜索引擎优化了啊。 如果有人只想看完整写完的文章的话，也请左拐 CSDN，或者 这里。主站开了七牛云加速，顺便做了 Google 、 Bing 和百度等的搜索引擎收录。最近身体欠佳。原定的学习计划和博客更新计划也不出意外的咕了。没有办法。健康是第一要务。等待过后慢慢去补吧。 编译 PHP安装必要环境 包含编译器，和编译需要的库。所有的编译操作均在 Ubuntu 19.04 下进行。 12sudo apt-get updatesudo apt install -y gcc g++ cmake make libxml2-dev libbz2-dev libcurl4-gnutls-dev libzip-dev libwebp-dev libpng-dev libjpeg-dev libxpm-dev libfreetype6-dev 下载源码 你可以 clone GitHub 上的代码： 1git clone https://github.com/php/php-src.git 当然也可以到 php.net 下载源码并解压： 1234wget https://www.php.net/distributions/php-7.3.7.tar.gztar -xvzf php-7.3.7.tar.gzrm php-7.3.7.tar.gzcd php-7.3.7/ 开始编译 首先读取插件列表（插件列表没有修改的时候可跳过此步骤）： 1./buildconf --force 然后进行基本配置： 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849mkdir phpbin./configure \\ --prefix=~/Document/phpbin \\ # 是非程序文件 install 的位置 --exec-prefix=~/Document/phpbin \\ # 是程序文件 install 的位置 --enable-fpm \\ --enable-cli \\ --enable-embed=shared \\ --enable-phpdbg \\ --enable-phpdbg-webhelper \\ --enable-phpdbg-debug \\ --enable-debug \\ --enable-bcmath \\ --enable-calendar \\ --enable-exif \\ --enable-ftp \\ --enable-intl \\ --enable-mbstring \\ --with-curl \\ --enable-embedded-mysqli \\ --enable-pcntl \\ --enable-shmop \\ --enable-soap \\ --enable-sockets \\ --enable-sysvmsg \\ --enable-sysvsem \\ --enable-sysvshm \\ --enable-wddx \\ --enable-zip \\ --with-zlib \\ --with-zlib-dir \\ --with-pcre-jit \\ --with-pcre-regex \\ --with-iconv \\ --enable-mysqlnd \\ --enable-pdo \\ --enable-hash \\ --enable-ctype \\ --enable-json \\ --enable-session \\ --enable-xml \\ --enable-libxml \\ --enable-simplexml \\ --enable-fileinfo \\ --with-openssl \\ --with-gd \\ --with-webp-dir \\ --with-jpeg-dir \\ --with-png-dir \\ --with-xpm-dir 随后手动修改 Makefile，手动将CFLAGS_CLEAN 改成如下内容： 1CFLAGS_CLEAN = -I/usr/include -g -O0 -Wall $(PROF_FLAGS) 最后，开始多线程编译： 12make all -j8make install php 程序主文件在 ~/Document/phpbin/bin/php 处。 生成插件 生成插件需使用刚刚编译好的 php 可执行文件。当然你也可以额外在系统中安装一套 php（环境）以备不时之需。 1sudo apt install -y apache2 php7 php-xdebug mysql-server mysql-client 随后到 php 源码文件夹、ext 文件夹下，运行 1php ./ext_skel.php --ext hello_obj 如果已知插件应用的平台的话，可以加上 --onlyunix 或 --onlywindows 避免生成其他平台的 config 文件。 在 config.m4 文件中，注意前面的编译命令部分，如果你的插件是独立的，取消掉下面两行的注释（dnl）： 12PHP_ARG_ENABLE(hello_obj, whether to enable hello_obj support,[--enable-hello_obj Enable hello_obj support], no) 但是如果你的插件依赖了其他插件的代码（头文件等），你需要保持上面两行的注释并取消下面两行的注释： 12PHP_ARG_WITH(hello_obj, for hello_obj support,[--with-hello_obj Include hello_obj support]) 注意，不同段的注释要保证对齐。 编译插件 最常见的两种方法：重新编译 php 本体和使用 phpize 单独编译插件。 编译 php 本体的办法很简单，即在 ./configure 步骤处看情况加入 --enable-hello_obj 或 --with-hello_obj 参数即可。这种情况下，当没有 php.ini 配置文件时，插件是默认启用的，利用 1php -r &quot;phpinfo();&quot; 命令可以查看 phpinfo()输出信息。 用 phpize 的话，请注意使用 你编译 PHP 时 prefix 指定的目录下的 phpize（~/Document/phpbin/bin/phpize），保证版本一致。 cd到插件源码所在的目录，运行phpsize，会生成编译所需文件。 随后执行 1./configure --with-php-config=&lt;php-config bin&gt; 其中 php-config bin 为 你编译 PHP 时 prefix 指定的目录下的 php-config（~/Document/phpbin/bin/php-config）。 编译并安装。 12makemake install .so 文件会自动复制到插件文件夹。在 php.ini 中加载插件即可。 1extension=hello_obj.so 当然，你也可以用 phpize 编译安装 Xdebug 等外置 php 插件。","summary":"图源：《明日方舟》 战场背景2 今后文章会同步更新在我的 CSDN 博客，但是还是以这个自己拿阿里云服务器搭建的网站为主的。不过CSDN有个好处是可以被国内的搜索引擎抓取到，嗯，省得我做搜索引擎优化了啊。 如果有人只想看完整写完的文章的话，也请左拐 CSDN，或者这里。主站开了七牛云加速，顺便做了 Google 、 Bing 和百度等的搜索引擎收录。最近身体欠佳。原定的学习计划和博客更新计划也不出意外的咕了。没有办法。健康是第一要务。等待过后慢慢去补吧。 编译 PHP安装必要环境包含编译器，和编译需要的库。所有的编译操作均在 Ubuntu 19.04 下进行。 12sudo apt-get updatesudo apt install -y gcc g++ cmake make libxml2-dev libbz2-dev libcurl4-gnutls-dev libzip-dev libwebp-dev libpng-dev libjpeg-dev libxpm-dev libfreetype6-dev 下载源码你可以 clone GitHub 上的代码： 1git clone https://github.com/php/php-src.git 当然也可以到 php.net 下载源码并解压： 1234wget https://www.php.net/distributions/php-7.3.7.tar.gztar -xvzf php-7.3.7.tar.gzrm php-7.3.7.tar.gzcd php-7.3.7/ 开始编译首先读取插件列表（插件列表没有修改的时候可跳过此步骤）： 1./buildconf --force","date_published":"2019-07-23T13:30:00.000Z","tags":["开发与代码","完成编写","PHP相关"]},{"id":"https://www.zhouweitong.site/post/008-linux-windows-tricks-02/","url":"https://www.zhouweitong.site/post/008-linux-windows-tricks-02/","title":"Linux & Windows 小技巧（2）","content_html":"<link rel=\"stylesheet\" type=\"text&#x2F;css\" href=\"https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.5.1/katex.min.css\"><link rel=\"stylesheet\" type=\"text&#x2F;css\" href=\"https://cdn.jsdelivr.net/npm/hexo-tag-hint@0.3.1/dist/hexo-tag-hint.min.css\"><p>图源：《ソード・アート・オンライン（刀剑神域）》第一季第二集 CM</p>\n<p>博客一直在慢速更新…之前一直忙于各种事情，学校的课、比赛、不断接触和学习新的东西，因此没什么机会静下心来好好整理、记录我学到的东西，也就没有办法一并记下我对某些问题的理解和思考。</p>\n<p>之前一度认为，“有写博客文章的时间，还不如好好学点新的东西”。但是自从领悟到我和舍友之间记忆力和知识熟练程度的差距之后，终于肯下定决心好好写自己的博客了——我比不上他们，我真的不是那种过目不忘的人，所以只能通过不断的复习和总结才能勉强记住些东西。</p>\n<p>有人说，初学者是“什么都不会，同时自己不知道自己会什么”，稍有学识的普通人是“自己会些东西，但是自己觉得自己会的很多”，而大神则是“自己会很多东西，但是自己觉得自己学的不多而且不知道自己已经会了什么”。</p>\n<p>可能我还是初学者吧。</p>\n<h2 id=\"git-push- 反复输密码很烦？\"><a href=\"#git-push- 反复输密码很烦？\" class=\"headerlink\" title=\"git push 反复输密码很烦？\"></a>git push 反复输密码很烦？</h2><p>有的时候可能会遇到一种极端情况：假设你要编写脚本，比如：自动化运维脚本。其中涉及到一些对 git 仓库的操作，而且需要密码，比如：在自动脚本中让部署机器拉取私有仓库，或是让部署机器将构建后的代码使用某个 github 账号推送到某个 git 仓库。这个时候需要用户手动输入用户名和密码，但是我们往往不能手动输入——比如公用的 docker build machine，根本不允许用户在构建过程中进行交互。</p>\n<span id=\"more\"></span>\n\n<p>那么我们该如何将用户名和密码“固化”在 clone 的本地仓库里，免去输入用户名密码的麻烦呢？一般有两种做法：首先是手动注册一个 OAuth App，并分配权限。部署机通过此 App 对相关 Repo 进行操作。但是这样做较为复杂，而且也可能存在 Token 过期的问题。</p>\n<p>第二种则较为简便了，只要将 clone 时的链接：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">https://github.com/&lt;repo owner name&gt;/&lt;repo name&gt;.git</span><br></pre></td></tr></table></figure>\n\n<p>替换成如下的形式：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">https://&lt;your user name&gt;:&lt;your password&gt;@github.com/&lt;repo owner name&gt;/&lt;repo name&gt;.git</span><br></pre></td></tr></table></figure>\n\n<p>即可以实现全程无需输入密码对该本地分支对应的远程分支进行操作。譬如，你要拉取 <code>ObjectNF/hello-word</code> 这个仓库，用户名是 <code>guest</code>，密码是 <code>123456</code>，则链接看起来就是这个样子：</p>\n<figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">https://guest:123456@github.com/ObjectNF/hello-world.git</span><br></pre></td></tr></table></figure>\n\n<p>这种方法是不安全的，因此已被 GitHub 废弃，但仍能在某些其他基于 Git 的代码托管服务提供商（比如 Gitee，或者自建的 Gitea）上使用。</p>\n<p>以下介绍更为安全的替代方法——SSH Key。</p>\n<p>登录 GitHub，找到 Settings -&gt; SSH and GPG keys:</p>\n<p><img src=\"/2019/07/02/008-linux-windows-tricks-02/image-20210411162009437.png\" alt=\"image-20210411162009437\"></p>\n<p>随后进行密钥的生成。启动 Git Bash：</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ssh-keygen</span><br></pre></td></tr></table></figure>\n\n<p>程序会自动生成密钥并将公钥和私钥保存至<code>~/.ssh</code>。</p>\n<p>随后在 GitHub 中添加公钥。通过 <code>cat ~/.ssh/id_rsa.pub</code> 查看公钥，点击 New SSH Key，然后将命令输出粘贴到输入框里即可。</p>\n<p><img src=\"/2019/07/02/008-linux-windows-tricks-02/image-20210411162020976.png\" alt=\"image-20210411162020976\"></p>\n<h2 id=\"Linux- 下查看文件的占用情况\"><a href=\"#Linux- 下查看文件的占用情况\" class=\"headerlink\" title=\"Linux 下查看文件的占用情况\"></a>Linux 下查看文件的占用情况</h2><p><code>lsof</code> 是 List open files 的简称，作用是查看系统中进程占用的文件列表。比如，你想查看自己编写的程序使用了哪些文件，或者想要删除某个文件但却提示“文件被占用”的时候，就可以利用该程序进行查询。</p>\n<p>安装：</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo apt-get install lsof</span><br></pre></td></tr></table></figure>\n\n<p>结合 <code>grep</code> 来查找文件的占用情况：</p>\n<p><img src=\"/2019/07/02/008-linux-windows-tricks-02/image-20210411161018192.png\" alt=\"image-20210411161018192\"></p>\n<p>当然，受到 Linux 哲学（“一切皆文件”）的影响，<code>lsof</code> 工具也可以用来查看端口占用、TCP 连接等。</p>\n<p><img src=\"/2019/07/02/008-linux-windows-tricks-02/image-20210411161047195.png\" alt=\"image-20210411161047195\"></p>\n<h2 id=\"查看 -Linux-ELF- 文件详情？\"><a href=\"# 查看 -Linux-ELF- 文件详情？\" class=\"headerlink\" title=\"查看 Linux ELF 文件详情？\"></a>查看 Linux ELF 文件详情？</h2><p>前一阵子入手了一个路由器，想着在寝室放一个无线 AP。然而比较不巧的是，寝室宽带并非那种可以直接拨号的 PPPoE，而是通过闪讯客户端进行软件拨号，好像还有时间匹配和心跳响应什么的。不过多亏了万能的 GitHub，可以下载到其他大神编写的用于 OpenWRT PPPoE 的 pptd 闪讯插件。</p>\n<p>于是满心欢喜地给路由器插好线，通上电，开 SSH，照着 Repo 里面写的步骤执行。但是拨号阶段却怎么也没成功，不断提示“配置错误”。在检查完脚本、设备号、防火墙、用户名密码、配置文件和插件可执行权限都没问题的情况下，我开始怀疑起插件本身的问题来。</p>\n<p>于是查看系统日志。果然提示“Exec format error.”，即可执行文件的格式错误。那么问题来了，我怎样才能知道该 ELF 格式的各种信息呢？这就需要 <code>readelf</code> 这个工具。</p>\n<p><img src=\"/2019/07/02/008-linux-windows-tricks-02/image-20210411161105478.png\" alt=\"image-20210411161105478\"></p>\n<p>这样就能清楚地看到 ELF 格式的区别，简单方便。</p>\n","content_text":"图源：《ソード・アート・オンライン（刀剑神域）》第一季第二集 CM 博客一直在慢速更新…之前一直忙于各种事情，学校的课、比赛、不断接触和学习新的东西，因此没什么机会静下心来好好整理、记录我学到的东西，也就没有办法一并记下我对某些问题的理解和思考。 之前一度认为，“有写博客文章的时间，还不如好好学点新的东西”。但是自从领悟到我和舍友之间记忆力和知识熟练程度的差距之后，终于肯下定决心好好写自己的博客了——我比不上他们，我真的不是那种过目不忘的人，所以只能通过不断的复习和总结才能勉强记住些东西。 有人说，初学者是“什么都不会，同时自己不知道自己会什么”，稍有学识的普通人是“自己会些东西，但是自己觉得自己会的很多”，而大神则是“自己会很多东西，但是自己觉得自己学的不多而且不知道自己已经会了什么”。 可能我还是初学者吧。 git push 反复输密码很烦？有的时候可能会遇到一种极端情况：假设你要编写脚本，比如：自动化运维脚本。其中涉及到一些对 git 仓库的操作，而且需要密码，比如：在自动脚本中让部署机器拉取私有仓库，或是让部署机器将构建后的代码使用某个 github 账号推送到某个 git 仓库。这个时候需要用户手动输入用户名和密码，但是我们往往不能手动输入——比如公用的 docker build machine，根本不允许用户在构建过程中进行交互。 那么我们该如何将用户名和密码“固化”在 clone 的本地仓库里，免去输入用户名密码的麻烦呢？一般有两种做法：首先是手动注册一个 OAuth App，并分配权限。部署机通过此 App 对相关 Repo 进行操作。但是这样做较为复杂，而且也可能存在 Token 过期的问题。 第二种则较为简便了，只要将 clone 时的链接： 1https://github.com/&lt;repo owner name&gt;/&lt;repo name&gt;.git 替换成如下的形式： 1https://&lt;your user name&gt;:&lt;your password&gt;@github.com/&lt;repo owner name&gt;/&lt;repo name&gt;.git 即可以实现全程无需输入密码对该本地分支对应的远程分支进行操作。譬如，你要拉取 ObjectNF/hello-word 这个仓库，用户名是 guest，密码是 123456，则链接看起来就是这个样子： 1https://guest:123456@github.com/ObjectNF/hello-world.git 这种方法是不安全的，因此已被 GitHub 废弃，但仍能在某些其他基于 Git 的代码托管服务提供商（比如 Gitee，或者自建的 Gitea）上使用。 以下介绍更为安全的替代方法——SSH Key。 登录 GitHub，找到 Settings -&gt; SSH and GPG keys: 随后进行密钥的生成。启动 Git Bash： 1ssh-keygen 程序会自动生成密钥并将公钥和私钥保存至~/.ssh。 随后在 GitHub 中添加公钥。通过 cat ~/.ssh/id_rsa.pub 查看公钥，点击 New SSH Key，然后将命令输出粘贴到输入框里即可。 Linux 下查看文件的占用情况lsof 是 List open files 的简称，作用是查看系统中进程占用的文件列表。比如，你想查看自己编写的程序使用了哪些文件，或者想要删除某个文件但却提示“文件被占用”的时候，就可以利用该程序进行查询。 安装： 1sudo apt-get install lsof 结合 grep 来查找文件的占用情况： 当然，受到 Linux 哲学（“一切皆文件”）的影响，lsof 工具也可以用来查看端口占用、TCP 连接等。 查看 Linux ELF 文件详情？前一阵子入手了一个路由器，想着在寝室放一个无线 AP。然而比较不巧的是，寝室宽带并非那种可以直接拨号的 PPPoE，而是通过闪讯客户端进行软件拨号，好像还有时间匹配和心跳响应什么的。不过多亏了万能的 GitHub，可以下载到其他大神编写的用于 OpenWRT PPPoE 的 pptd 闪讯插件。 于是满心欢喜地给路由器插好线，通上电，开 SSH，照着 Repo 里面写的步骤执行。但是拨号阶段却怎么也没成功，不断提示“配置错误”。在检查完脚本、设备号、防火墙、用户名密码、配置文件和插件可执行权限都没问题的情况下，我开始怀疑起插件本身的问题来。 于是查看系统日志。果然提示“Exec format error.”，即可执行文件的格式错误。那么问题来了，我怎样才能知道该 ELF 格式的各种信息呢？这就需要 readelf 这个工具。 这样就能清楚地看到 ELF 格式的区别，简单方便。","summary":"图源：《ソード・アート・オンライン（刀剑神域）》第一季第二集 CM 博客一直在慢速更新…之前一直忙于各种事情，学校的课、比赛、不断接触和学习新的东西，因此没什么机会静下心来好好整理、记录我学到的东西，也就没有办法一并记下我对某些问题的理解和思考。 之前一度认为，“有写博客文章的时间，还不如好好学点新的东西”。但是自从领悟到我和舍友之间记忆力和知识熟练程度的差距之后，终于肯下定决心好好写自己的博客了——我比不上他们，我真的不是那种过目不忘的人，所以只能通过不断的复习和总结才能勉强记住些东西。 有人说，初学者是“什么都不会，同时自己不知道自己会什么”，稍有学识的普通人是“自己会些东西，但是自己觉得自己会的很多”，而大神则是“自己会很多东西，但是自己觉得自己学的不多而且不知道自己已经会了什么”。 可能我还是初学者吧。 git push 反复输密码很烦？有的时候可能会遇到一种极端情况：假设你要编写脚本，比如：自动化运维脚本。其中涉及到一些对 git 仓库的操作，而且需要密码，比如：在自动脚本中让部署机器拉取私有仓库，或是让部署机器将构建后的代码使用某个 github 账号推送到某个 git 仓库。这个时候需要用户手动输入用户名和密码，但是我们往往不能手动输入——比如公用的 docker build machine，根本不允许用户在构建过程中进行交互。","date_published":"2019-07-02T06:30:00.000Z","tags":["自由探索","完成编写","笔记","小tricks"]},{"id":"https://www.zhouweitong.site/post/006-linux-windows-tricks-01/","url":"https://www.zhouweitong.site/post/006-linux-windows-tricks-01/","title":"Linux & Windows 小技巧（1）","content_html":"<link rel=\"stylesheet\" type=\"text&#x2F;css\" href=\"https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.5.1/katex.min.css\"><link rel=\"stylesheet\" type=\"text&#x2F;css\" href=\"https://cdn.jsdelivr.net/npm/hexo-tag-hint@0.3.1/dist/hexo-tag-hint.min.css\"><p>图源：《三色绘恋》 游戏背景图</p>\n<p>最近又学到了一些零零碎碎的 Linux、Windows 命令，和一些可能今后会用得着的小技巧，怕自己忘记，所以把它们写在博客里面提醒一下自己，免得到时候再花费大量时间去百度、Google 找文章。</p>\n<h2 id=\"Linux- 下查看进程树？\"><a href=\"#Linux- 下查看进程树？\" class=\"headerlink\" title=\"Linux 下查看进程树？\"></a>Linux 下查看进程树？</h2><p>查看进程有好几种方式，<code>top</code>、<code>htop</code> 这种可视化的，还有 <code>ps</code> 这种纯文本输出的程序都可以做到。但是如果想要查看某一进程的父进程或者子进程 PID 该怎么办？可以借助另一个程序，<code>pstree</code>。参数很灵活，可以根据需要启用或关闭。程序截图如下：</p>\n<p><img src=\"/2019/06/28/006-linux-windows-tricks-01/image-20210411152055083.png\" alt=\"image-20210411152055083\"></p>\n<h2 id=\"WinHex- 的替代品？\"><a href=\"#WinHex- 的替代品？\" class=\"headerlink\" title=\"WinHex 的替代品？\"></a>WinHex 的替代品？</h2><p>WinHex 是很强大的一个二进制文件查看和编辑工具（尤其是做 CTF 杂项题的时候 :）。虽然说现在全网随便搜搜就有破解版（Cracked Version）可以用，但是多了解几个 WinHex 的替代品，有备无患。</p>\n<h3 id=\"EditPlus\"><a href=\"#EditPlus\" class=\"headerlink\" title=\"EditPlus\"></a>EditPlus</h3><p>说起来很巧，这个神器还是我在学校图书馆电脑上发现的。本来以为这东西只能编辑编辑文本，做 Notepad++ 的小弟，没想到这还能打开二进制文件查看 16 进制数据（emmm，不能编辑），而且…还支持 Windows ARM。</p>\n<p><img src=\"/2019/06/28/006-linux-windows-tricks-01/image-20210411151916081.png\" alt=\"image-20210411151916081\"></p>\n<p>打开文件之后，点击 Edit-&gt;Hex Viewer 即可查看十六进制数据。</p>\n<span id=\"more\"></span>\n\n<p><img src=\"/2019/06/28/006-linux-windows-tricks-01/image-20210411151927139.png\" alt=\"image-20210411151927139\"></p>\n<p>只不过这个并不是免费软件，但是注册码很容易搜到，<a href=\"https://blog.csdn.net/anhldd/article/details/85088715\">点击这里</a>。</p>\n<h3 id=\"GHex\"><a href=\"#GHex\" class=\"headerlink\" title=\"GHex\"></a>GHex</h3><p>上面提到的 WinHex 和 EditPlus 都仅限于 Windows 系统。Linux 和 Mac 平台下虽然可以使用 <code>Vim + 插件 </code> 或是 <code>Visual Studio Code + 插件 </code> 来实现查看（甚至是编辑）二进制数据，但是有不少使用者吐槽体验不好，设置复杂。因此多个 Linux 包管理器的软件源中包含的开源工具 GHex 便成为了首选。</p>\n<p>安装非常简单，<code>sudo apt-get install ghex</code></p>\n<p>界面展示如下：</p>\n<p><img src=\"/2019/06/28/006-linux-windows-tricks-01/image-20210411151939864.png\" alt=\"image-20210411151939864\"></p>\n<h3 id=\"010Editor\"><a href=\"#010Editor\" class=\"headerlink\" title=\"010Editor\"></a>010Editor</h3><p>010Editor 也是一款收费软件，正版价格在 130 USD （每年）左右，且不提供中文语言界面。它的特点是可以载入预定义的文件格式模板（*.bt，即 Binary Template）。现如今已有不少用户向 010Editor 贡献了常见二进制文件的格式模板，可以方便的一键下载安装。</p>\n<p><img src=\"/2019/06/28/006-linux-windows-tricks-01/image-20210411152023454.png\" alt=\"image-20210411152023454\"></p>\n<p>以 PNG 文件格式为例。安装 PNG 文件对应的文件格式模板后，加载 PNG 文件，可以看到：</p>\n<p><img src=\"/2019/06/28/006-linux-windows-tricks-01/image-20210411152036337.png\" alt=\"image-20210411152036337\"></p>\n<p>能够直接看到该文件格式各字段对应的值。双击即可对该字段的值进行修改。</p>\n<h2 id=\"怎么关掉 -Windows- 的强制驱动程序签名认证？\"><a href=\"# 怎么关掉 -Windows- 的强制驱动程序签名认证？\" class=\"headerlink\" title=\"怎么关掉 Windows 的强制驱动程序签名认证？\"></a>怎么关掉 Windows 的强制驱动程序签名认证？</h2><p>一般来说，设备的驱动程序都会内含数字签名，防止操作系统开机时加载恶意制作的，或被程序等恶意修改的驱动程序。同时，微软公司也提供了一系列的通用驱动程序和 API，方便程序员开发和使用。</p>\n<p>但是有些时候我们需要自己开发驱动，又或是需要安装些特殊的、不经由官方发布的驱动（例如某些玩机达人针对某一 Android 手机修改的 Fastboot 驱动等）时，Windows 会自动拦截安装请求。强制将文件复制到 drivers 文件夹并注册又会引起系统蓝屏。这个时候常见的操作是在开机时按 F8，选择“高级启动”菜单中的“禁用驱动程序签名强制”，然后系统便可以正常启动并加载未签名的驱动程序。</p>\n<p>但是每次开机都需要按 F8 选择，不太方便。如果能默认“允许加载无数字签名的驱动程序“进行启动的话就好了。于是翻阅 BCD 文件，发现了下面这个参数：</p>\n<p><img src=\"/2019/06/28/006-linux-windows-tricks-01/image-20210411151959773.png\" alt=\"image-20210411151959773\"></p>\n<p>上图中红色箭头标识的参数就是开启 Windows” 测试模式“的参数。当其值为 <code>Yes</code> 时，Windows 启动时自动进入测试模式，允许非官方的驱动程序的加载。而“无完整性检查”模式，允许无签名的驱动程序加载。</p>\n<p>测试模式启用时，桌面上会出现这样的水印：</p>\n<p><img src=\"/2019/06/28/006-linux-windows-tricks-01/image-20210411152011062.png\" alt=\"image-20210411152011062\"></p>\n<p>启用两种模式的命令很简单，管理员身份运行 cmd，输入如下命令即可：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">bcdedit /set testsigning on</span><br><span class=\"line\">bcdedit /set nointegritychecks on</span><br></pre></td></tr></table></figure>\n\n<p>当然，关闭的话，以此类推：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">bcdedit /set testsigning off</span><br><span class=\"line\">bcdedit /set nointegritychecks off</span><br></pre></td></tr></table></figure>\n\n<p>注：Windows ”测试模式“与 Windows ”安全模式“类似，是 Windows 自身为了某些特定目的而设计的内置模式，和 Windows 内测版、评估版的”机密模式”（就是右下角有 Microsoft Confidential 水印的内测模式）和“评估模式”（就是微软官方的 180 天测试版系统）并不相同。</p>\n","content_text":"图源：《三色绘恋》 游戏背景图 最近又学到了一些零零碎碎的 Linux、Windows 命令，和一些可能今后会用得着的小技巧，怕自己忘记，所以把它们写在博客里面提醒一下自己，免得到时候再花费大量时间去百度、Google 找文章。 Linux 下查看进程树？查看进程有好几种方式，top、htop 这种可视化的，还有 ps 这种纯文本输出的程序都可以做到。但是如果想要查看某一进程的父进程或者子进程 PID 该怎么办？可以借助另一个程序，pstree。参数很灵活，可以根据需要启用或关闭。程序截图如下： WinHex 的替代品？WinHex 是很强大的一个二进制文件查看和编辑工具（尤其是做 CTF 杂项题的时候 :）。虽然说现在全网随便搜搜就有破解版（Cracked Version）可以用，但是多了解几个 WinHex 的替代品，有备无患。 EditPlus说起来很巧，这个神器还是我在学校图书馆电脑上发现的。本来以为这东西只能编辑编辑文本，做 Notepad++ 的小弟，没想到这还能打开二进制文件查看 16 进制数据（emmm，不能编辑），而且…还支持 Windows ARM。 打开文件之后，点击 Edit-&gt;Hex Viewer 即可查看十六进制数据。 只不过这个并不是免费软件，但是注册码很容易搜到，点击这里。 GHex上面提到的 WinHex 和 EditPlus 都仅限于 Windows 系统。Linux 和 Mac 平台下虽然可以使用 Vim + 插件 或是 Visual Studio Code + 插件 来实现查看（甚至是编辑）二进制数据，但是有不少使用者吐槽体验不好，设置复杂。因此多个 Linux 包管理器的软件源中包含的开源工具 GHex 便成为了首选。 安装非常简单，sudo apt-get install ghex 界面展示如下： 010Editor010Editor 也是一款收费软件，正版价格在 130 USD （每年）左右，且不提供中文语言界面。它的特点是可以载入预定义的文件格式模板（*.bt，即 Binary Template）。现如今已有不少用户向 010Editor 贡献了常见二进制文件的格式模板，可以方便的一键下载安装。 以 PNG 文件格式为例。安装 PNG 文件对应的文件格式模板后，加载 PNG 文件，可以看到： 能够直接看到该文件格式各字段对应的值。双击即可对该字段的值进行修改。 怎么关掉 Windows 的强制驱动程序签名认证？一般来说，设备的驱动程序都会内含数字签名，防止操作系统开机时加载恶意制作的，或被程序等恶意修改的驱动程序。同时，微软公司也提供了一系列的通用驱动程序和 API，方便程序员开发和使用。 但是有些时候我们需要自己开发驱动，又或是需要安装些特殊的、不经由官方发布的驱动（例如某些玩机达人针对某一 Android 手机修改的 Fastboot 驱动等）时，Windows 会自动拦截安装请求。强制将文件复制到 drivers 文件夹并注册又会引起系统蓝屏。这个时候常见的操作是在开机时按 F8，选择“高级启动”菜单中的“禁用驱动程序签名强制”，然后系统便可以正常启动并加载未签名的驱动程序。 但是每次开机都需要按 F8 选择，不太方便。如果能默认“允许加载无数字签名的驱动程序“进行启动的话就好了。于是翻阅 BCD 文件，发现了下面这个参数： 上图中红色箭头标识的参数就是开启 Windows” 测试模式“的参数。当其值为 Yes 时，Windows 启动时自动进入测试模式，允许非官方的驱动程序的加载。而“无完整性检查”模式，允许无签名的驱动程序加载。 测试模式启用时，桌面上会出现这样的水印： 启用两种模式的命令很简单，管理员身份运行 cmd，输入如下命令即可： 12bcdedit /set testsigning onbcdedit /set nointegritychecks on 当然，关闭的话，以此类推： 12bcdedit /set testsigning offbcdedit /set nointegritychecks off 注：Windows ”测试模式“与 Windows ”安全模式“类似，是 Windows 自身为了某些特定目的而设计的内置模式，和 Windows 内测版、评估版的”机密模式”（就是右下角有 Microsoft Confidential 水印的内测模式）和“评估模式”（就是微软官方的 180 天测试版系统）并不相同。","summary":"图源：《三色绘恋》 游戏背景图 最近又学到了一些零零碎碎的 Linux、Windows 命令，和一些可能今后会用得着的小技巧，怕自己忘记，所以把它们写在博客里面提醒一下自己，免得到时候再花费大量时间去百度、Google 找文章。 Linux 下查看进程树？查看进程有好几种方式，top、htop 这种可视化的，还有 ps 这种纯文本输出的程序都可以做到。但是如果想要查看某一进程的父进程或者子进程PID该怎么办？可以借助另一个程序，pstree。参数很灵活，可以根据需要启用或关闭。程序截图如下： WinHex 的替代品？WinHex是很强大的一个二进制文件查看和编辑工具（尤其是做 CTF 杂项题的时候 :）。虽然说现在全网随便搜搜就有破解版（Cracked Version）可以用，但是多了解几个 WinHex 的替代品，有备无患。 EditPlus说起来很巧，这个神器还是我在学校图书馆电脑上发现的。本来以为这东西只能编辑编辑文本，做 Notepad++ 的小弟，没想到这还能打开二进制文件查看16进制数据（emmm，不能编辑），而且…还支持 Windows ARM。 打开文件之后，点击 Edit-&gt;Hex Viewer 即可查看十六进制数据。","date_published":"2019-06-28T15:00:00.000Z","tags":["自由探索","完成编写","笔记","小tricks"]},{"id":"https://www.zhouweitong.site/post/013-ripping-training-basics-0/","url":"https://www.zhouweitong.site/post/013-ripping-training-basics-0/","title":"压制技术 A：光盘的种类、资源发布标注与常见名词解释","content_html":"<link rel=\"stylesheet\" type=\"text&#x2F;css\" href=\"https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.5.1/katex.min.css\"><link rel=\"stylesheet\" type=\"text&#x2F;css\" href=\"https://cdn.jsdelivr.net/npm/hexo-tag-hint@0.3.1/dist/hexo-tag-hint.min.css\"><p>图源：《终将成为你》BD-1 声优特典 背景图</p>\n<h2 id=\"常见光盘种类\"><a href=\"# 常见光盘种类\" class=\"headerlink\" title=\"常见光盘种类\"></a>常见光盘种类</h2><h3 id=\"CD\"><a href=\"#CD\" class=\"headerlink\" title=\"CD\"></a>CD</h3><p>Compact Disc，又叫做“小型镭射盘”、“激光唱片”，通过激光来读写数据。单层容量大概 700MB。其中一般存储的是音乐，但也有存储视频、相片、软件（多数是游戏）的 CD。常见分类如下：  </p>\n<ol>\n<li>按存储内容分类：<ul>\n<li>CD-DA: 音乐 CD</li>\n<li>CD-I: 交互式 CD（游戏 CD）</li>\n<li>VCD: 视频 CD</li>\n<li>CD+G: 带有专辑图片和歌词的音乐 CD</li>\n<li>Photo CD: 图片 CD</li>\n</ul>\n</li>\n<li>按读写情况分类：<ul>\n<li>CD-ROM: 只读光盘。光盘背面的凹槽为厂家印制。</li>\n<li>CD-R: 一次性写入光盘。 光盘背面的凹槽为刻录机烧制。</li>\n<li>CD-RW: 可读写光盘。</li>\n</ul>\n</li>\n</ol>\n<span id=\"more\"></span>\n\n<h3 id=\"DVD\"><a href=\"#DVD\" class=\"headerlink\" title=\"DVD\"></a>DVD</h3><p>Digital Video Disc，（高密度）数字视频光盘。也称作“数字多功能光盘”。单层容量大概 4.7GB。使用红色激光（650nm）来读写数据。其中一般存放的是视频。也有用于存放音乐和数据的 DVD。常见分类如下：</p>\n<ol>\n<li>按读写情况分类：<ul>\n<li>DVD-R: 一次性写入 DVD。</li>\n<li>DVD-RW: 可重复读写 DVD。</li>\n<li>DVD+R: DVD-R 的变种。</li>\n<li>DVD+RW: DVD-RW 的变种。</li>\n</ul>\n</li>\n<li>按数据类型分类：<ul>\n<li>DVD-Video: 视频 DVD</li>\n<li>DVD-Audio: 音频 DVD</li>\n<li>DVD-Multi: 多功能 DVD</li>\n</ul>\n</li>\n</ol>\n<h3 id=\"BD\"><a href=\"#BD\" class=\"headerlink\" title=\"BD\"></a>BD</h3><p>Blue-ray Disc，蓝光光盘。单层容量大概 27GB。使用蓝紫色激光（405nm）来读写数据。其中一般存储的是视频。也有用于存放数据的 BD。常见分类如下：</p>\n<ol>\n<li>按容量大小分类：<ul>\n<li>BD-DL: 50GB 空间的 BD</li>\n<li>BD-XL TL: 三层 BD，存储空间 100GB</li>\n<li>BD-XL QL: 四层 BD，存储空间 128GB</li>\n</ul>\n</li>\n<li>按读写情况分类：<ul>\n<li>BD-R: 一次性写入 BD</li>\n<li>BD-RE: 可重复读写 BD</li>\n</ul>\n</li>\n</ol>\n<h2 id=\"资源发布标注\"><a href=\"# 资源发布标注\" class=\"headerlink\" title=\"资源发布标注\"></a>资源发布标注 </h2><p> 这里列举一些各资源小组发布资源时常用的标识，并附带简单的解释。  </p>\n<h3 id=\"例一\"><a href=\"# 例一\" class=\"headerlink\" title=\"例一\"></a>例一</h3><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[悠哈璃羽字幕社 &amp;LoliHouse] 五等分的新娘 / Go-toubun no Hanayome - 09 [WebRip 1080p HEVC-10bit AAC][简繁内封字幕]</span><br></pre></td></tr></table></figure>\n\n<p><code>[悠哈璃羽字幕社 &amp;LoliHouse]</code>: 字幕社与压制组的名称。如果是原盘发布，一般是购买人 / 自行购买小组 / 合并团购小组的名称。<br><code>五等分的新娘</code>: 番剧的中文名称。<br><code>Go-toubun no Hanayome</code>: 番剧的罗马音。<br><code>09</code>: 番剧的集数。<br><code>Web</code>: 压制素材的来源标识。  </p>\n<ul>\n<li>Web: 从在线播放网站（GYAO!/Netflix/Amazon 等）提取链接下载得到高清视频进行压制。</li>\n<li>BD: 从蓝光光碟提取的原 m2ts 视频进行压制。</li>\n<li>DVD: 从 DVD 光碟提取的 DAT 视频进行压制。</li>\n<li>TV：从 IPTV 流中截取的 ts 视频进行压制。</li>\n</ul>\n<p><code>Rip</code>: 指“将碟片中的数据转至硬盘上”这一过程，即压制。<br><code>1080</code>: 分辨率大小。<br><code>p</code>: 场扫描方式，这里是 progressive，即“逐行扫描”。<br><code>HEVC</code>: 指所用到的编码规范。AVC 与 H.264 等同，HEVC 与 H.265 等同。<br><code>10bit</code>: 指颜色位深。常见的位深有 8 位、10 位、12 位等。<br><code>AAC</code>: 指视频中音轨的音频编码。<br><code>内封字幕</code>: 指视频容器中带有字幕。相对之下的是“外挂字幕”，指字幕文件与视频文件分离的字幕类型。  </p>\n<h3 id=\"例二\"><a href=\"# 例二\" class=\"headerlink\" title=\"例二\"></a>例二</h3><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[Re：从零开始的异世界生活 Memory Snow][Re: Zero kara Hajimeru Isekai Seikatsu Memory Snow][Re: ゼロから始める異世界生活 Memory Snow][BDMV][1080p][OVA][JP][TQYSY]</span><br></pre></td></tr></table></figure>\n\n<p>与上面例一的区别部分列举如下：</p>\n<p><code>Re: ゼロから始める異世界生活 Memory Snow</code>：番剧的日语名称。</p>\n<p><code>BDMV</code>：指文件类型为蓝光光碟视频文件。</p>\n<p><code>OVA</code>：标识剧集类型。</p>\n<p><code>JP</code>：购买国家（光碟是 XX 国家版）。部分番剧会分美版和日版等。</p>\n<p>当然，标题的类型不止这些，这里只举出最常见的两种类型。其他文件类型（图片集、漫画杂志扫描件、轻小说扫描件、Live 现场、音乐专辑等）标题各有规范，这里就不举例了。</p>\n<h2 id=\"常见名词释义\"><a href=\"# 常见名词释义\" class=\"headerlink\" title=\"常见名词释义\"></a>常见名词释义</h2><p><code>Season</code>：季度</p>\n<p><code>Episode</code>：集</p>\n<p><code>Romaji</code>：罗马音</p>\n<p><code>Disc X</code>：光盘分盘销售编号</p>\n<p><code>SP</code>：特典</p>\n<p><code>OVA</code>：光盘发售动画</p>\n<p><code>RAW</code>：原生视频（不做画面修改和字幕添加）</p>\n<p><code>Track</code>：轨道（视频轨或音频轨）</p>\n<p><code>p/i</code>：场扫描方式（逐行扫描 / 隔行扫描）</p>\n<p><code>fps</code>：帧速率（25，30，24000/1001，30000/1001 较常见）</p>\n<p><code>5.1</code>：声道数（1，2，5.1，7.1 较常见）</p>\n<p><code>YUV420</code>：色彩空间（RGB-Rec.709，RGB-Rec.601，RGB-Rec.2020，YUV420，YUV422，YUV444，GRAY 较常见）</p>\n<p><code>副音轨</code>：指光盘附带的，和画面同步进行的声优 / 导演 / 编剧评论和访谈音轨</p>\n<p><code>NCOP/NCED</code>：没有制作人员名单、字幕等遮挡的 OP 和 ED 部分</p>\n<p><code>码率</code>：单位时间内画面包含的数据位数</p>\n<p><code>Chapter</code>：章节，某些 BD 中包含视频章节点，和迅速跳过 OP、ED，标识剧情转折等</p>\n<p><code>Scan</code>：扫描，特指扫描光盘喷绘、光盘盒包装、附带设定集等</p>\n<p><code>BDBOX</code>：盒装 BD，有时也指最终发售的、一次性包含所有分销光盘的典藏盒装 BD</p>\n","content_text":"图源：《终将成为你》BD-1 声优特典 背景图 常见光盘种类CDCompact Disc，又叫做“小型镭射盘”、“激光唱片”，通过激光来读写数据。单层容量大概 700MB。其中一般存储的是音乐，但也有存储视频、相片、软件（多数是游戏）的 CD。常见分类如下： 按存储内容分类： CD-DA: 音乐 CD CD-I: 交互式 CD（游戏 CD） VCD: 视频 CD CD+G: 带有专辑图片和歌词的音乐 CD Photo CD: 图片 CD 按读写情况分类： CD-ROM: 只读光盘。光盘背面的凹槽为厂家印制。 CD-R: 一次性写入光盘。 光盘背面的凹槽为刻录机烧制。 CD-RW: 可读写光盘。 DVDDigital Video Disc，（高密度）数字视频光盘。也称作“数字多功能光盘”。单层容量大概 4.7GB。使用红色激光（650nm）来读写数据。其中一般存放的是视频。也有用于存放音乐和数据的 DVD。常见分类如下： 按读写情况分类： DVD-R: 一次性写入 DVD。 DVD-RW: 可重复读写 DVD。 DVD+R: DVD-R 的变种。 DVD+RW: DVD-RW 的变种。 按数据类型分类： DVD-Video: 视频 DVD DVD-Audio: 音频 DVD DVD-Multi: 多功能 DVD BDBlue-ray Disc，蓝光光盘。单层容量大概 27GB。使用蓝紫色激光（405nm）来读写数据。其中一般存储的是视频。也有用于存放数据的 BD。常见分类如下： 按容量大小分类： BD-DL: 50GB 空间的 BD BD-XL TL: 三层 BD，存储空间 100GB BD-XL QL: 四层 BD，存储空间 128GB 按读写情况分类： BD-R: 一次性写入 BD BD-RE: 可重复读写 BD 资源发布标注 这里列举一些各资源小组发布资源时常用的标识，并附带简单的解释。 例一1[悠哈璃羽字幕社 &amp;LoliHouse] 五等分的新娘 / Go-toubun no Hanayome - 09 [WebRip 1080p HEVC-10bit AAC][简繁内封字幕] [悠哈璃羽字幕社 &amp;LoliHouse]: 字幕社与压制组的名称。如果是原盘发布，一般是购买人 / 自行购买小组 / 合并团购小组的名称。五等分的新娘: 番剧的中文名称。Go-toubun no Hanayome: 番剧的罗马音。09: 番剧的集数。Web: 压制素材的来源标识。 Web: 从在线播放网站（GYAO!/Netflix/Amazon 等）提取链接下载得到高清视频进行压制。 BD: 从蓝光光碟提取的原 m2ts 视频进行压制。 DVD: 从 DVD 光碟提取的 DAT 视频进行压制。 TV：从 IPTV 流中截取的 ts 视频进行压制。 Rip: 指“将碟片中的数据转至硬盘上”这一过程，即压制。1080: 分辨率大小。p: 场扫描方式，这里是 progressive，即“逐行扫描”。HEVC: 指所用到的编码规范。AVC 与 H.264 等同，HEVC 与 H.265 等同。10bit: 指颜色位深。常见的位深有 8 位、10 位、12 位等。AAC: 指视频中音轨的音频编码。内封字幕: 指视频容器中带有字幕。相对之下的是“外挂字幕”，指字幕文件与视频文件分离的字幕类型。 例二1[Re：从零开始的异世界生活 Memory Snow][Re: Zero kara Hajimeru Isekai Seikatsu Memory Snow][Re: ゼロから始める異世界生活 Memory Snow][BDMV][1080p][OVA][JP][TQYSY] 与上面例一的区别部分列举如下： Re: ゼロから始める異世界生活 Memory Snow：番剧的日语名称。 BDMV：指文件类型为蓝光光碟视频文件。 OVA：标识剧集类型。 JP：购买国家（光碟是 XX 国家版）。部分番剧会分美版和日版等。 当然，标题的类型不止这些，这里只举出最常见的两种类型。其他文件类型（图片集、漫画杂志扫描件、轻小说扫描件、Live 现场、音乐专辑等）标题各有规范，这里就不举例了。 常见名词释义Season：季度 Episode：集 Romaji：罗马音 Disc X：光盘分盘销售编号 SP：特典 OVA：光盘发售动画 RAW：原生视频（不做画面修改和字幕添加） Track：轨道（视频轨或音频轨） p/i：场扫描方式（逐行扫描 / 隔行扫描） fps：帧速率（25，30，24000/1001，30000/1001 较常见） 5.1：声道数（1，2，5.1，7.1 较常见） YUV420：色彩空间（RGB-Rec.709，RGB-Rec.601，RGB-Rec.2020，YUV420，YUV422，YUV444，GRAY 较常见） 副音轨：指光盘附带的，和画面同步进行的声优 / 导演 / 编剧评论和访谈音轨 NCOP/NCED：没有制作人员名单、字幕等遮挡的 OP 和 ED 部分 码率：单位时间内画面包含的数据位数 Chapter：章节，某些 BD 中包含视频章节点，和迅速跳过 OP、ED，标识剧情转折等 Scan：扫描，特指扫描光盘喷绘、光盘盒包装、附带设定集等 BDBOX：盒装 BD，有时也指最终发售的、一次性包含所有分销光盘的典藏盒装 BD","summary":"图源：《终将成为你》BD-1 声优特典 背景图 常见光盘种类CDCompact Disc，又叫做“小型镭射盘”、“激光唱片”，通过激光来读写数据。单层容量大概 700MB。其中一般存储的是音乐，但也有存储视频、相片、软件（多数是游戏）的 CD。常见分类如下： 按存储内容分类： CD-DA: 音乐 CD CD-I: 交互式 CD（游戏CD） VCD: 视频 CD CD+G: 带有专辑图片和歌词的音乐 CD Photo CD: 图片 CD 按读写情况分类： CD-ROM: 只读光盘。光盘背面的凹槽为厂家印制。 CD-R: 一次性写入光盘。 光盘背面的凹槽为刻录机烧制。 CD-RW: 可读写光盘。","date_published":"2019-06-18T04:00:00.000Z","tags":["媒体技术","完成编写","压制技术","笔记"]},{"id":"https://www.zhouweitong.site/post/017-rctf-2019-misc-disk-writup/","url":"https://www.zhouweitong.site/post/017-rctf-2019-misc-disk-writup/","title":"RCTF 2019 杂项 Disk WriteUp","content_html":"<link rel=\"stylesheet\" type=\"text&#x2F;css\" href=\"https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.5.1/katex.min.css\"><link rel=\"stylesheet\" type=\"text&#x2F;css\" href=\"https://cdn.jsdelivr.net/npm/hexo-tag-hint@0.3.1/dist/hexo-tag-hint.min.css\"><p> 图源：《明日方舟》游戏背景 龙门之夜 </p>\n<p> 我又来随便糊一篇文章了。</p>\n<p> 题目设定如下：</p>\n<blockquote>\n<p>An otaku used VeraCrypt to encrypt his favorites.</p>\n<p>Password: <code>rctf</code></p>\n<p>Flag format: <code>rctf&#123;a-zA-Z0-9_&#125;</code></p>\n</blockquote>\n<p> 题目给的提示十分简单。于是准备 VeraCrypt，开始解题。</p>\n<h3 id=\"找前半段 Flag\"><a href=\"# 找前半段 Flag\" class=\"headerlink\" title=\"找前半段 Flag\"></a> 找前半段 Flag</h3><p> 首先下载题目附件，得到 rctf-disk.zip，解压得到 encrypt.vmdk。因为无法确定 vmdk 是 VeraCrypt 加密完的虚拟硬盘文件随便改了个格式，还是存储了 VeraCrypt 加密后虚拟磁盘文件的虚拟磁盘（这话真的超级绕 hhh），因此先尝试使用 7zip 打开该文件。</p>\n<p><img src=\"/2019/06/05/017-rctf-2019-misc-disk-writup/image-20210411162623460.png\" alt=\"7zip 可以成功打开\"></p>\n<span id=\"more\"></span>\n\n<p> 说明外层的 vmdk 只是容器，并没有加密。将 0.fat 解压出来，再次尝试用 7zip 打开，报错，说明 vmdk 中包含的这个 FAT32 分区被加密了。使用 WinHex 载入这个文件可以看到：</p>\n<p><img src=\"/2019/06/05/017-rctf-2019-misc-disk-writup/image-20210411162703195.png\" alt=\"前半段 Flag\"></p>\n<p> 这样我们就得到了前半段 Flag，为：<code>rctf&#123;unseCure_quick_form4t_vo1ume</code></p>\n<h3 id=\"找后半段 Flag\"><a href=\"# 找后半段 Flag\" class=\"headerlink\" title=\"找后半段 Flag\"></a> 找后半段 Flag</h3><p> 使用题目中所给的 VeraCrypt 密码对 0.fat 文件进行解密并加载，发现加载成功，为常规卷，加密类型为 AES。</p>\n<p><img src=\"/2019/06/05/017-rctf-2019-misc-disk-writup/image-20210411162724851.png\" alt=\"成功加载加密盘\"></p>\n<p> 访问该磁盘，文件如下：</p>\n<p><img src=\"/2019/06/05/017-rctf-2019-misc-disk-writup/image-20210411162905636.png\" alt=\"加密盘内文件\"></p>\n<p> 注意左侧文件的文件名 <code>70056639_useless_file_for_ctf_just_ignore_it.jpg</code>，说明其不包含解题的有效信息。于是打开 <code>password.txt</code>，文件内容为：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Password 2: RCTF2019</span><br><span class=\"line\">You&#x27;re late... So sad</span><br></pre></td></tr></table></figure>\n\n<p> 将此加密盘卸载，使用得到的第二个密码再次加载，加载成功。加密方式是 AES，但是注意该分区是隐藏分区。</p>\n<p><img src=\"/2019/06/05/017-rctf-2019-misc-disk-writup/image-20210411162942168.png\" alt=\"第二次加载成功\"></p>\n<p> 由于是隐藏分区所以无法直接访问。因此使用 WinHex 载入磁盘，提示无法自动检测分区格式后选择“分区无格式”，并查看该分区扇区数据（DiskGenius 查看磁盘扇区数据也可以）。</p>\n<p><img src=\"/2019/06/05/017-rctf-2019-misc-disk-writup/image-20210411163028809.png\" alt=\"后半段 Flag\"></p>\n<p> 得到后半段 Flag：<code>_and_corrupted__1nner_v0lume&#125;</code></p>\n<p> 拼接后得到完整的 Flag：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">rctf&#123;unseCure_quick_form4t_vo1ume_and_corrupted_1nner_v0lume&#125;</span><br></pre></td></tr></table></figure>\n","content_text":"图源：《明日方舟》游戏背景 龙门之夜 我又来随便糊一篇文章了。 题目设定如下： An otaku used VeraCrypt to encrypt his favorites. Password: rctf Flag format: rctf&#123;a-zA-Z0-9_&#125; 题目给的提示十分简单。于是准备 VeraCrypt，开始解题。 找前半段 Flag 首先下载题目附件，得到 rctf-disk.zip，解压得到 encrypt.vmdk。因为无法确定 vmdk 是 VeraCrypt 加密完的虚拟硬盘文件随便改了个格式，还是存储了 VeraCrypt 加密后虚拟磁盘文件的虚拟磁盘（这话真的超级绕 hhh），因此先尝试使用 7zip 打开该文件。 说明外层的 vmdk 只是容器，并没有加密。将 0.fat 解压出来，再次尝试用 7zip 打开，报错，说明 vmdk 中包含的这个 FAT32 分区被加密了。使用 WinHex 载入这个文件可以看到： 这样我们就得到了前半段 Flag，为：rctf&#123;unseCure_quick_form4t_vo1ume 找后半段 Flag 使用题目中所给的 VeraCrypt 密码对 0.fat 文件进行解密并加载，发现加载成功，为常规卷，加密类型为 AES。 访问该磁盘，文件如下： 注意左侧文件的文件名 70056639_useless_file_for_ctf_just_ignore_it.jpg，说明其不包含解题的有效信息。于是打开 password.txt，文件内容为： 12Password 2: RCTF2019You&#x27;re late... So sad 将此加密盘卸载，使用得到的第二个密码再次加载，加载成功。加密方式是 AES，但是注意该分区是隐藏分区。 由于是隐藏分区所以无法直接访问。因此使用 WinHex 载入磁盘，提示无法自动检测分区格式后选择“分区无格式”，并查看该分区扇区数据（DiskGenius 查看磁盘扇区数据也可以）。 得到后半段 Flag：_and_corrupted__1nner_v0lume&#125; 拼接后得到完整的 Flag： 1rctf&#123;unseCure_quick_form4t_vo1ume_and_corrupted_1nner_v0lume&#125;","summary":"图源：《明日方舟》游戏背景 龙门之夜 我又来随便糊一篇文章了。 题目设定如下： An otaku used VeraCrypt to encrypt his favorites. Password: rctf Flag format: rctf&#123;a-zA-Z0-9_&#125; 题目给的提示十分简单。于是准备 VeraCrypt，开始解题。 找前半段Flag首先下载题目附件，得到 rctf-disk.zip，解压得到 encrypt.vmdk。因为无法确定 vmdk 是 VeraCrypt 加密完的虚拟硬盘文件随便改了个格式，还是存储了 VeraCrypt 加密后虚拟磁盘文件的虚拟磁盘（这话真的超级绕hhh），因此先尝试使用 7zip 打开该文件。","date_published":"2019-06-05T04:00:00.000Z","tags":["网络安全","完成编写","CTF","WriteUp"]},{"id":"https://www.zhouweitong.site/post/016-xihuctf-misc2-writeup/","url":"https://www.zhouweitong.site/post/016-xihuctf-misc2-writeup/","title":"西湖论剑预选赛 Misc 第二题 Write-UP","content_html":"<link rel=\"stylesheet\" type=\"text&#x2F;css\" href=\"https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.5.1/katex.min.css\"><link rel=\"stylesheet\" type=\"text&#x2F;css\" href=\"https://cdn.jsdelivr.net/npm/hexo-tag-hint@0.3.1/dist/hexo-tag-hint.min.css\"><p>图源：“西湖论剑”线上赛主页</p>\n<p>所以说，近期铺天盖地宣传的“西湖论剑”网络安全技能赛预选已经结束了。在这里随便糊一篇文章（也是我第一次写 Write-Up 文章），就聊聊杂项最先放出的那个第二题的解法。  </p>\n<p>首先拿到题，解压，发现里面有“题目描述”，先看描述，是这么写的：  </p>\n<p><strong>我们截获了一些 IP 数据报，发现报文头中的 TTL 值特别可疑，怀疑是通信方嵌入了数据到 TTL，我们将这些 TTL 值提取了出来，你能看出什么端倪吗？</strong></p>\n<p>然后看给出的另一个文件，<code>ttl.txt</code>，里面的内容是这样的：  </p>\n<p><img src=\"/2019/04/07/016-xihuctf-misc2-writeup/image-20210411163821143.png\" alt=\"image-20210411163821143\"></p>\n<p>不难发现 TTL 值只有 $63$，$127$，$191$，$255$ 四种，都是 $2$ 的某次幂 $-1$ 的值。于是将这四个数都转换成二进制，得到 $111111_2$、$1111111_2$、$10111111_2$、$11111111_2$ 四个二进制数。从后面两个数字可以观察到二进制数的开头两位似乎有关系。又因为 TTL 值为一个 8 位整数，进行合理猜想，不妨将不足 8 位的二进制数开头补 0，变为 8 位后再取开头两位。即：$00111111_2$、$01111111_2$、$10111111_2$、$11111111_2$ 提取开头两位为：$00_2$、$01_2$、$10_2$、$11_2$，恰好为全排列，可以用于数据的存储。  </p>\n<p>这样每组两个比特，四组就可以组成一个字节。博客园上也有文章提到了这种数据隐藏方式（<a href=\"https://www.cnblogs.com/k1two2/p/5170213.html\">点击这里</a>）。  </p>\n<span id=\"more\"></span>\n\n<p>随后编写脚本，将这些数据进行处理并将得到的二进制数据转为十六进制明文。Python 脚本代码如下：（假设输入文件为<code>ttl.txt</code>，输出文件为<code>ttl_res.txt</code>)  </p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">infile = <span class=\"built_in\">open</span>(<span class=\"string\">&quot;ttl.txt&quot;</span>, <span class=\"string\">&quot;r&quot;</span>)</span><br><span class=\"line\">outfile = <span class=\"built_in\">open</span>(<span class=\"string\">&quot;ttl_res.txt&quot;</span>, <span class=\"string\">&quot;w&quot;</span>)</span><br><span class=\"line\"></span><br><span class=\"line\">ascii_data = <span class=\"string\">&quot;&quot;</span></span><br><span class=\"line\">num = <span class=\"number\">0</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> <span class=\"built_in\">range</span>(<span class=\"number\">295376</span>):</span><br><span class=\"line\">    tmp = infile.readline();</span><br><span class=\"line\">    tmp = tmp[<span class=\"number\">4</span>:<span class=\"built_in\">len</span>(tmp)-<span class=\"number\">1</span>]</span><br><span class=\"line\">    bin_data = <span class=\"built_in\">bin</span>(<span class=\"built_in\">int</span>(tmp))[<span class=\"number\">2</span>:]</span><br><span class=\"line\">    bin_len = <span class=\"built_in\">len</span>(bin_data)</span><br><span class=\"line\">    <span class=\"keyword\">if</span> bin_len != <span class=\"number\">8</span>:</span><br><span class=\"line\">        <span class=\"keyword\">for</span> j <span class=\"keyword\">in</span> <span class=\"built_in\">range</span>(<span class=\"number\">8</span>-bin_len):</span><br><span class=\"line\">            bin_data = <span class=\"string\">&quot;0&quot;</span> + bin_data</span><br><span class=\"line\">    bin_val = bin_data[:<span class=\"number\">2</span>]</span><br><span class=\"line\">    ascii_data += bin_val</span><br><span class=\"line\">    num += <span class=\"number\">1</span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> num == <span class=\"number\">4</span>:</span><br><span class=\"line\">        num = <span class=\"number\">0</span></span><br><span class=\"line\">        msg_hex = <span class=\"built_in\">hex</span>(<span class=\"built_in\">int</span>(ascii_data, <span class=\"number\">2</span>))[<span class=\"number\">2</span>:]</span><br><span class=\"line\">        <span class=\"keyword\">if</span> <span class=\"built_in\">len</span>(msg_hex) &lt; <span class=\"number\">2</span>:</span><br><span class=\"line\">            msg_hex = <span class=\"string\">&quot;0&quot;</span> + msg_hex</span><br><span class=\"line\">        outfile.write(msg_hex)</span><br><span class=\"line\">        ascii_data = <span class=\"string\">&quot;&quot;</span></span><br><span class=\"line\"></span><br><span class=\"line\">infile.close()</span><br><span class=\"line\">outfile.close()</span><br></pre></td></tr></table></figure>\n\n<p>得到的文件是这个样子的：  </p>\n<p><img src=\"/2019/04/07/016-xihuctf-misc2-writeup/image-20210411163935534.png\" alt=\"image-20210411163935534\"></p>\n<p>随后打开 WinHex，新建文件，将记事本中的内容全选、复制，粘贴到 WinHex 中，粘贴方式选择“ASCII Hex”，得到如下结果：  </p>\n<p><img src=\"/2019/04/07/016-xihuctf-misc2-writeup/image-20210411164018969.png\" alt=\"image-20210411164018969\"></p>\n<p>另存为 txt 文件，怀疑其仍为 16 进制数据。在 WinHex 中再次新建文件，重复上述操作，得到：  </p>\n<p><img src=\"/2019/04/07/016-xihuctf-misc2-writeup/image-20210411164115718.png\" alt=\"image-20210411164115718\"></p>\n<p><code>FF D8 FF E1</code>是 JPEG 文件头部标志，因此保存为 jpg。能从缩略图发现这是一个二维码，但是不完整。  </p>\n<p><img src=\"/2019/04/07/016-xihuctf-misc2-writeup/image-20210411164141680.png\" alt=\"image-20210411164141680\"></p>\n<p>怀疑该文件中含有多张 JPEG 图片。搜索 JPEG 文件尾标志<code>FF D9</code>，结果如下：  </p>\n<p><img src=\"/2019/04/07/016-xihuctf-misc2-writeup/image-20210411164204548.png\" alt=\"image-20210411164204548\"></p>\n<p>将 6 个 JPEG 文件分别提取保存为新的文件，得：  </p>\n<p><img src=\"/2019/04/07/016-xihuctf-misc2-writeup/image-20210411164228812.png\" alt=\"image-20210411164228812\"></p>\n<p>分别是同一个二维码的不同部分。利用 Photoshop 拼接得到完整二维码：  </p>\n<p><img src=\"/2019/04/07/016-xihuctf-misc2-writeup/image-20210411164248559.png\" alt=\"image-20210411164248559\"></p>\n<p>二维码识别，扫描结果为：  </p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">key:AutomaticKey cipher:fftu&#123;2028mb39927wn1f96o6e12z03j58002p&#125;</span><br></pre></td></tr></table></figure>\n\n<p>这并非 flag 原文而是密文。前面的 key 字段有两个含义：加密方式为 <strong>AutoKey Chiper</strong> 且加密密钥为 <code>AutomaticKey</code>。找到<a href=\"http://www.practicalcryptography.com/ciphers/classical-era/autokey/\"> 在线解密网站 </a> 进行解密（注意：这个网站只会将字母解密，因为符号和数字在密码加密前后不变，因此网站自动忽略了对它们的处理），用解密后的字母替换解密之前的字母得到真正的 flag：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">flag&#123;2028ab39927df1d96e6a12b03e58002e&#125;</span><br></pre></td></tr></table></figure>\n","content_text":"图源：“西湖论剑”线上赛主页 所以说，近期铺天盖地宣传的“西湖论剑”网络安全技能赛预选已经结束了。在这里随便糊一篇文章（也是我第一次写 Write-Up 文章），就聊聊杂项最先放出的那个第二题的解法。 首先拿到题，解压，发现里面有“题目描述”，先看描述，是这么写的： 我们截获了一些 IP 数据报，发现报文头中的 TTL 值特别可疑，怀疑是通信方嵌入了数据到 TTL，我们将这些 TTL 值提取了出来，你能看出什么端倪吗？ 然后看给出的另一个文件，ttl.txt，里面的内容是这样的： 不难发现 TTL 值只有 $63$，$127$，$191$，$255$ 四种，都是 $2$ 的某次幂 $-1$ 的值。于是将这四个数都转换成二进制，得到 $111111_2$、$1111111_2$、$10111111_2$、$11111111_2$ 四个二进制数。从后面两个数字可以观察到二进制数的开头两位似乎有关系。又因为 TTL 值为一个 8 位整数，进行合理猜想，不妨将不足 8 位的二进制数开头补 0，变为 8 位后再取开头两位。即：$00111111_2$、$01111111_2$、$10111111_2$、$11111111_2$ 提取开头两位为：$00_2$、$01_2$、$10_2$、$11_2$，恰好为全排列，可以用于数据的存储。 这样每组两个比特，四组就可以组成一个字节。博客园上也有文章提到了这种数据隐藏方式（点击这里）。 随后编写脚本，将这些数据进行处理并将得到的二进制数据转为十六进制明文。Python 脚本代码如下：（假设输入文件为ttl.txt，输出文件为ttl_res.txt) 123456789101112131415161718192021222324252627infile = open(&quot;ttl.txt&quot;, &quot;r&quot;)outfile = open(&quot;ttl_res.txt&quot;, &quot;w&quot;)ascii_data = &quot;&quot;num = 0for i in range(295376): tmp = infile.readline(); tmp = tmp[4:len(tmp)-1] bin_data = bin(int(tmp))[2:] bin_len = len(bin_data) if bin_len != 8: for j in range(8-bin_len): bin_data = &quot;0&quot; + bin_data bin_val = bin_data[:2] ascii_data += bin_val num += 1 if num == 4: num = 0 msg_hex = hex(int(ascii_data, 2))[2:] if len(msg_hex) &lt; 2: msg_hex = &quot;0&quot; + msg_hex outfile.write(msg_hex) ascii_data = &quot;&quot;infile.close()outfile.close() 得到的文件是这个样子的： 随后打开 WinHex，新建文件，将记事本中的内容全选、复制，粘贴到 WinHex 中，粘贴方式选择“ASCII Hex”，得到如下结果： 另存为 txt 文件，怀疑其仍为 16 进制数据。在 WinHex 中再次新建文件，重复上述操作，得到： FF D8 FF E1是 JPEG 文件头部标志，因此保存为 jpg。能从缩略图发现这是一个二维码，但是不完整。 怀疑该文件中含有多张 JPEG 图片。搜索 JPEG 文件尾标志FF D9，结果如下： 将 6 个 JPEG 文件分别提取保存为新的文件，得： 分别是同一个二维码的不同部分。利用 Photoshop 拼接得到完整二维码： 二维码识别，扫描结果为： 1key:AutomaticKey cipher:fftu&#123;2028mb39927wn1f96o6e12z03j58002p&#125; 这并非 flag 原文而是密文。前面的 key 字段有两个含义：加密方式为 AutoKey Chiper 且加密密钥为 AutomaticKey。找到 在线解密网站 进行解密（注意：这个网站只会将字母解密，因为符号和数字在密码加密前后不变，因此网站自动忽略了对它们的处理），用解密后的字母替换解密之前的字母得到真正的 flag： 1flag&#123;2028ab39927df1d96e6a12b03e58002e&#125;","summary":"图源：“西湖论剑”线上赛主页 所以说，近期铺天盖地宣传的“西湖论剑”网络安全技能赛预选已经结束了。在这里随便糊一篇文章（也是我第一次写Write-Up文章），就聊聊杂项最先放出的那个第二题的解法。 首先拿到题，解压，发现里面有“题目描述”，先看描述，是这么写的： 我们截获了一些IP数据报，发现报文头中的TTL值特别可疑，怀疑是通信方嵌入了数据到TTL，我们将这些TTL值提取了出来，你能看出什么端倪吗？ 然后看给出的另一个文件，ttl.txt，里面的内容是这样的： 不难发现TTL值只有 $63$，$127$，$191$，$255$ 四种，都是$2$的某次幂$-1$的值。于是将这四个数都转换成二进制，得到 $111111_2$、$1111111_2$、$10111111_2$、$11111111_2$ 四个二进制数。从后面两个数字可以观察到二进制数的开头两位似乎有关系。又因为TTL值为一个8位整数，进行合理猜想，不妨将不足8位的二进制数开头补0，变为8位后再取开头两位。即：$00111111_2$、$01111111_2$、$10111111_2$、$11111111_2$提取开头两位为：$00_2$、$01_2$、$10_2$、$11_2$，恰好为全排列，可以用于数据的存储。 这样每组两个比特，四组就可以组成一个字节。博客园上也有文章提到了这种数据隐藏方式（点击这里）。","date_published":"2019-04-07T10:08:18.000Z","tags":["网络安全","完成编写","CTF","WriteUp"]},{"id":"https://www.zhouweitong.site/post/009-bilibili-playlink-findings/","url":"https://www.zhouweitong.site/post/009-bilibili-playlink-findings/","title":"拜年祭启发的小小探索","content_html":"<link rel=\"stylesheet\" type=\"text&#x2F;css\" href=\"https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.5.1/katex.min.css\"><link rel=\"stylesheet\" type=\"text&#x2F;css\" href=\"https://cdn.jsdelivr.net/npm/hexo-tag-hint@0.3.1/dist/hexo-tag-hint.min.css\"><p>图源：Bilibili 2019 拜年祭 视频截图</p>\n<p>2019 年 2 月 4 日，一年一度的哔哩哔哩拜年祭如约而至。不得不说，今年的拜年祭在节目质量和形式上相较于前三年都有较大的提升。出于在电视上离线播放（即非网络电视，而是读取存储设备上的媒体文件）的需求，及家中的缓慢网速达不到 Bilibili 大会员 1080P+ 无卡顿播放的程度，我利用少量的空余时间对 Bilibili 高清视频的下载方式进行了简单实践，并在本文中进行简单总结。  </p>\n<h2 id=\"ID\"><a href=\"#ID\" class=\"headerlink\" title=\"ID\"></a>ID</h2><p>熟悉 B 站的用户应该都会了解到，B 站上的视频、音频、专栏文章、用户都是以唯一的 ID 进行标识的。以“【星尘原创】尘降【PV 付 /COP】”这个视频为例：其视频地址为：<code>https://www.bilibili.com/video/av4402328</code>，该视频所对应的音频的地址为：<code>https://www.bilibili.com/audio/au18065</code>，上传该视频的 UP 主的个人主页地址为：<code>https://space.bilibili.com/396194</code>。由此我们可以获取到以下类型的唯一 ID：</p>\n<ul>\n<li>视频 ID [Anime (Video) ID, aid/avid]：<code>4402328</code></li>\n<li>音频 ID [Audio ID, auid]：<code>18065</code></li>\n<li>用户 ID [User ID, uid]：<code>396194</code></li>\n</ul>\n<p>中包含的“av”、“au”、“cv”等均是为了区分 ID 的类型所用。在 Ajax 请求过程中各 ID 的值均为数字，不包含字符。  </p>\n<span id=\"more\"></span>\n\n<p>在上述例子中没有包括的、实际应用的 ID 类型还有（不完全）<sup>[1]</sup>：</p>\n<ul>\n<li>文章 ID [Content Viewing ID, cvid]</li>\n<li>内容 ID [Content ID, cid]</li>\n<li>通知 ID [Notification ID, nfid]</li>\n<li>会员 ID [Member ID, mid]</li>\n<li>标签 ID [Tag ID, tid]</li>\n<li>顺序 ID [Order ID, oid]</li>\n<li>分类 ID [Type ID, typeid]</li>\n<li>直播间 ID [Room ID, roomid]</li>\n<li>剧集 ID [Episode ID, epid]</li>\n</ul>\n<p>在下载视频的时候，起到主要作用的是 aid 和 cid 这两个唯一 ID。aid 和 cid 的区别是：aid 既可以指单个视频，也可以指含有多个视频的播放列表，而 cid 是视频级唯一的。</p>\n<h2 id=\"活动专题页面找 -aid\"><a href=\"# 活动专题页面找 -aid\" class=\"headerlink\" title=\"活动专题页面找 aid\"></a>活动专题页面找 aid</h2><p>Bilibili 为拜年祭活动设计了专门的活动页面。链接为：</p>\n<figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">https://www.bilibili.com/blackboard/bnj2019.html</span><br></pre></td></tr></table></figure>\n\n<p>播放拜年祭视频的小电视播放器作为 HTML5 组件放置在活动页面内。使用开发者工具查看视频统计数据的 HTTP 请求，可以发现该播放器播放视频对应的 aid。比如默认情况下播放页面均会展示视频的总播放量、回复数、投币数等。如下图：</p>\n<p><img src=\"/2019/02/13/009-bilibili-playlink-findings/image-20210411165922139.png\" alt=\"普通播放页面的统计信息\"></p>\n<p><img src=\"/2019/02/13/009-bilibili-playlink-findings/image-20210411165947103.png\" alt=\"拜年祭播放页面的统计信息\"></p>\n<p>不难发现，获取这些统计信息所请求的链接地址（以拜年祭为例）是：</p>\n<figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">https://api.bilibili.com/x/web-interface/archive/stat?aid=36570401</span><br></pre></td></tr></table></figure>\n\n<p>返回的 JSON 数据（格式化后）如下：</p>\n<figure class=\"highlight json\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"attr\">&quot;code&quot;</span>: <span class=\"number\">0</span>,</span><br><span class=\"line\">    <span class=\"attr\">&quot;message&quot;</span>: <span class=\"string\">&quot;0&quot;</span>,</span><br><span class=\"line\">    <span class=\"attr\">&quot;ttl&quot;</span>: <span class=\"number\">1</span>,</span><br><span class=\"line\">    <span class=\"attr\">&quot;data&quot;</span>: &#123;</span><br><span class=\"line\">        <span class=\"attr\">&quot;aid&quot;</span>: <span class=\"number\">36570401</span>,</span><br><span class=\"line\">        <span class=\"attr\">&quot;view&quot;</span>: <span class=\"number\">34739455</span>,</span><br><span class=\"line\">        <span class=\"attr\">&quot;danmaku&quot;</span>: <span class=\"number\">1328696</span>,</span><br><span class=\"line\">        <span class=\"attr\">&quot;reply&quot;</span>: <span class=\"number\">195310</span>,</span><br><span class=\"line\">        <span class=\"attr\">&quot;favorite&quot;</span>: <span class=\"number\">1299858</span>,</span><br><span class=\"line\">        <span class=\"attr\">&quot;coin&quot;</span>: <span class=\"number\">1859584</span>,</span><br><span class=\"line\">        <span class=\"attr\">&quot;share&quot;</span>: <span class=\"number\">300501</span>,</span><br><span class=\"line\">        <span class=\"attr\">&quot;like&quot;</span>: <span class=\"number\">1465982</span>,</span><br><span class=\"line\">        <span class=\"attr\">&quot;now_rank&quot;</span>: <span class=\"number\">0</span>,</span><br><span class=\"line\">        <span class=\"attr\">&quot;his_rank&quot;</span>: <span class=\"number\">0</span>,</span><br><span class=\"line\">        <span class=\"attr\">&quot;no_reprint&quot;</span>: <span class=\"number\">0</span>,</span><br><span class=\"line\">        <span class=\"attr\">&quot;copyright&quot;</span>: <span class=\"number\">1</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>上面链接和 JSON 数据中“aid”均为视频对应的视频 ID。注：该链接实际上也是获取视频统计数据的 API 接口。在此处不对此链接进行进一步说明。</p>\n<p>由此我们得到了拜年祭视频的正常播放地址应为：</p>\n<figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">http://www.bilibili.com/video/av36570401/</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"下载 1080P 及以下清晰度视频的办法\"><a href=\"# 下载 1080P 及以下清晰度视频的办法\" class=\"headerlink\" title=\"下载 1080P 及以下清晰度视频的办法\"></a>下载 1080P 及以下清晰度视频的办法 </h2><p> 最为简便的方法是，我们可以利用已有的视频下载网站进行下载。这里我们举两个例子。</p>\n<h3 id=\"唧唧下载站，分段法\"><a href=\"# 唧唧下载站，分段法\" class=\"headerlink\" title=\"唧唧下载站，分段法\"></a>唧唧下载站，分段法 </h3><p><a href=\"https://www.jijidown.com/\"> 唧唧视频下载站 </a> 也是一种下载视频的办法。它通过视频的热度高低来判断视频是否应预先解析和缓存在云端。较热门的视频可以直接从唧唧网站的服务器获取。较冷门的视频则可以通过客户端下载。客户端会尝试直接解析视频直连、修改 Referer 等进行分段下载然后合并。同时，该网站同时也拥有 MP3 转换服务，将视频中的音轨提取、转码后供用户下载。</p>\n<h3 id=\"ParseVideo，直链法\"><a href=\"#ParseVideo，直链法\" class=\"headerlink\" title=\"ParseVideo，直链法\"></a>ParseVideo，直链法</h3><p><a href=\"https://www.parsevideo.com/\">ParseVideo</a> 则不提供客户端和云端缓存。这个网站的作用是直接解析出对应视频、对应清晰度的完整视频的直链，获得的直链可以用下载工具直接下载。例如：2019 拜年祭中，第一部分“珠”的 1080P 清晰度完整视频直链如下：</p>\n<figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">http://upos-hz-mirrorwcsu.acgvideo.com/upgcxcode/94/37/74633794/74633794-1-208.mp4?ua=tvproj&amp;deadline=1550125016&amp;gen=playurl&amp;nbs=1&amp;oi=2501663261&amp;os=wcsu&amp;trid=c01282c601bb4b0cb444a9b53342fc2e&amp;uipk=5&amp;upsig=556e65a3992c1531227fb43bcb6705a3</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"视频地址从哪来？\"><a href=\"# 视频地址从哪来？\" class=\"headerlink\" title=\"视频地址从哪来？\"></a>视频地址从哪来？</h2><p>视频地址（参数的作用其实绝大部分都是鉴权和防盗链）可以从 Bilibili 的视频播放页获得。在加载视频前，HTML5 播放器会首先加载一个包含当前清晰度的视频链接的文件，名为 <code>playurl</code>。获取播放地址的完整链接为（登录状态下的 1080P+ 链接，Session MD5 部分隐去）：</p>\n<figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">https://api.bilibili.com/x/player/playurl?avid=36570401&amp;cid=74633794&amp;qn=112&amp;type=&amp;otype=json&amp;fnver=0&amp;fnval=16&amp;session=4710f|sec|</span><br></pre></td></tr></table></figure>\n\n<p>得到的 JSON 数据（格式化并去除转义字符后）类似这样（部分参数含有隐私信息，因此隐去，隐去部分用 <code>|sec|</code> 标识）：</p>\n<figure class=\"highlight json\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"attr\">&quot;code&quot;</span>: <span class=\"number\">0</span>,</span><br><span class=\"line\">    <span class=\"attr\">&quot;message&quot;</span>: <span class=\"string\">&quot;0&quot;</span>,</span><br><span class=\"line\">    <span class=\"attr\">&quot;ttl&quot;</span>: <span class=\"number\">1</span>,</span><br><span class=\"line\">    <span class=\"attr\">&quot;data&quot;</span>: &#123;</span><br><span class=\"line\">        <span class=\"attr\">&quot;from&quot;</span>: <span class=\"string\">&quot;local&quot;</span>,</span><br><span class=\"line\">        <span class=\"attr\">&quot;result&quot;</span>: <span class=\"string\">&quot;suee&quot;</span>,</span><br><span class=\"line\">        <span class=\"attr\">&quot;message&quot;</span>: <span class=\"string\">&quot;&quot;</span>,</span><br><span class=\"line\">        <span class=\"attr\">&quot;quality&quot;</span>: <span class=\"number\">112</span>,</span><br><span class=\"line\">        <span class=\"attr\">&quot;format&quot;</span>: <span class=\"string\">&quot;hdflv2&quot;</span>,</span><br><span class=\"line\">        <span class=\"attr\">&quot;timelength&quot;</span>: <span class=\"number\">2961402</span>,</span><br><span class=\"line\">        <span class=\"attr\">&quot;accept_format&quot;</span>: <span class=\"string\">&quot;hdflv2,flv,flv720,flv480,flv360&quot;</span>,</span><br><span class=\"line\">        <span class=\"attr\">&quot;accept_description&quot;</span>: [<span class=\"string\">&quot; 高清 1080P+&quot;</span>, <span class=\"string\">&quot; 高清 1080P&quot;</span>, <span class=\"string\">&quot; 高清 720P&quot;</span>, <span class=\"string\">&quot; 清晰 480P&quot;</span>, <span class=\"string\">&quot; 流畅 360P&quot;</span>],</span><br><span class=\"line\">        <span class=\"attr\">&quot;accept_quality&quot;</span>: [<span class=\"number\">112</span>, <span class=\"number\">80</span>, <span class=\"number\">64</span>, <span class=\"number\">32</span>, <span class=\"number\">16</span>],</span><br><span class=\"line\">        <span class=\"attr\">&quot;video_codecid&quot;</span>: <span class=\"number\">7</span>,</span><br><span class=\"line\">        <span class=\"attr\">&quot;seek_param&quot;</span>: <span class=\"string\">&quot;start&quot;</span>,</span><br><span class=\"line\">        <span class=\"attr\">&quot;seek_type&quot;</span>: <span class=\"string\">&quot;offset&quot;</span>,</span><br><span class=\"line\">        <span class=\"attr\">&quot;dash&quot;</span>: &#123;</span><br><span class=\"line\">            <span class=\"attr\">&quot;duration&quot;</span>: <span class=\"number\">2961</span>,</span><br><span class=\"line\">            <span class=\"attr\">&quot;minBufferTime&quot;</span>: <span class=\"number\">1.5</span>,</span><br><span class=\"line\">            <span class=\"attr\">&quot;video&quot;</span>: [&#123;</span><br><span class=\"line\">                <span class=\"attr\">&quot;id&quot;</span>: <span class=\"number\">112</span>,</span><br><span class=\"line\">                <span class=\"attr\">&quot;baseUrl&quot;</span>: <span class=\"string\">&quot;http://upos-hz-mirrorks3u.acgvideo.com/upgcxcode/94/37/74633794/74633794-1-30112.m4s?e=ig8eux|sec|&amp;deadline=1550136700&amp;gen=playurl&amp;nbs=1&amp;oi=1885698042&amp;os=ks3u&amp;platform=pc&amp;trid=126ef7|sec|&amp;uipk=5&amp;upsig=c71526|sec|&quot;</span>,</span><br><span class=\"line\">                <span class=\"attr\">&quot;backupUrl&quot;</span>: <span class=\"literal\">null</span>,</span><br><span class=\"line\">                <span class=\"attr\">&quot;bandwidth&quot;</span>: <span class=\"number\">5826637</span>,</span><br><span class=\"line\">                <span class=\"attr\">&quot;mimeType&quot;</span>: <span class=\"string\">&quot;video/mp4&quot;</span>,</span><br><span class=\"line\">                <span class=\"attr\">&quot;codecs&quot;</span>: <span class=\"string\">&quot;avc1.640028&quot;</span>,</span><br><span class=\"line\">                <span class=\"attr\">&quot;width&quot;</span>: <span class=\"number\">1920</span>,</span><br><span class=\"line\">                <span class=\"attr\">&quot;height&quot;</span>: <span class=\"number\">1080</span>,</span><br><span class=\"line\">                <span class=\"attr\">&quot;frameRate&quot;</span>: <span class=\"string\">&quot;16000/672&quot;</span>,</span><br><span class=\"line\">                <span class=\"attr\">&quot;sar&quot;</span>: <span class=\"string\">&quot;1:1&quot;</span>,</span><br><span class=\"line\">                <span class=\"attr\">&quot;startWithSap&quot;</span>: <span class=\"number\">1</span>,</span><br><span class=\"line\">                <span class=\"attr\">&quot;SegmentBase&quot;</span>: &#123;</span><br><span class=\"line\">                    <span class=\"attr\">&quot;Initialization&quot;</span>: <span class=\"string\">&quot;0-992&quot;</span>,</span><br><span class=\"line\">                    <span class=\"attr\">&quot;indexRange&quot;</span>: <span class=\"string\">&quot;993-8128&quot;</span></span><br><span class=\"line\">                &#125;,</span><br><span class=\"line\">                <span class=\"attr\">&quot;codecid&quot;</span>: <span class=\"number\">7</span></span><br><span class=\"line\">            &#125;],</span><br><span class=\"line\">            <span class=\"attr\">&quot;audio&quot;</span>: [&#123;</span><br><span class=\"line\">                <span class=\"attr\">&quot;id&quot;</span>: <span class=\"number\">30280</span>,</span><br><span class=\"line\">                <span class=\"attr\">&quot;baseUrl&quot;</span>: <span class=\"string\">&quot;http://upos-hz-mirrorks3u.acgvideo.com/upgcxcode/94/37/74633794/74633794_nb1-1-30280.m4s?e=ig8eux|sec|&amp;deadline=1550136700&amp;gen=playurl&amp;nbs=1&amp;oi=1885698042&amp;os=ks3u&amp;platform=pc&amp;trid=126ef7|sec|&amp;uipk=5&amp;upsig=5f58ae|sec|&quot;</span>,</span><br><span class=\"line\">                <span class=\"attr\">&quot;backupUrl&quot;</span>: <span class=\"literal\">null</span>,</span><br><span class=\"line\">                <span class=\"attr\">&quot;bandwidth&quot;</span>: <span class=\"number\">321706</span>,</span><br><span class=\"line\">                <span class=\"attr\">&quot;mimeType&quot;</span>: <span class=\"string\">&quot;audio/mp4&quot;</span>,</span><br><span class=\"line\">                <span class=\"attr\">&quot;codecs&quot;</span>: <span class=\"string\">&quot;mp4a.40.2&quot;</span>,</span><br><span class=\"line\">                <span class=\"attr\">&quot;width&quot;</span>: <span class=\"number\">0</span>,</span><br><span class=\"line\">                <span class=\"attr\">&quot;height&quot;</span>: <span class=\"number\">0</span>,</span><br><span class=\"line\">                <span class=\"attr\">&quot;frameRate&quot;</span>: <span class=\"string\">&quot;&quot;</span>,</span><br><span class=\"line\">                <span class=\"attr\">&quot;sar&quot;</span>: <span class=\"string\">&quot;&quot;</span>,</span><br><span class=\"line\">                <span class=\"attr\">&quot;startWithSap&quot;</span>: <span class=\"number\">0</span>,</span><br><span class=\"line\">                <span class=\"attr\">&quot;SegmentBase&quot;</span>: &#123;</span><br><span class=\"line\">                    <span class=\"attr\">&quot;Initialization&quot;</span>: <span class=\"string\">&quot;0-907&quot;</span>,</span><br><span class=\"line\">                    <span class=\"attr\">&quot;indexRange&quot;</span>: <span class=\"string\">&quot;908-8055&quot;</span></span><br><span class=\"line\">                &#125;,</span><br><span class=\"line\">                <span class=\"attr\">&quot;codecid&quot;</span>: <span class=\"number\">0</span></span><br><span class=\"line\">            &#125;, &#123;</span><br><span class=\"line\">                <span class=\"attr\">&quot;id&quot;</span>: <span class=\"number\">30216</span>,</span><br><span class=\"line\">                <span class=\"attr\">&quot;baseUrl&quot;</span>: <span class=\"string\">&quot;http://upos-hz-mirrorcos.acgvideo.com/upgcxcode/94/37/74633794/74633794-1-30216.m4s?um_deadline=1550136700&amp;platform=pc&amp;rate=0&amp;oi=1885698042&amp;um_sign=df1a58|sec|&amp;gen=playurl&amp;os=cos&amp;trid=126ef7|sec|&quot;</span>,</span><br><span class=\"line\">                <span class=\"attr\">&quot;backupUrl&quot;</span>: <span class=\"literal\">null</span>,</span><br><span class=\"line\">                <span class=\"attr\">&quot;bandwidth&quot;</span>: <span class=\"number\">67238</span>,</span><br><span class=\"line\">                <span class=\"attr\">&quot;mimeType&quot;</span>: <span class=\"string\">&quot;audio/mp4&quot;</span>,</span><br><span class=\"line\">                <span class=\"attr\">&quot;codecs&quot;</span>: <span class=\"string\">&quot;mp4a.40.2&quot;</span>,</span><br><span class=\"line\">                <span class=\"attr\">&quot;width&quot;</span>: <span class=\"number\">0</span>,</span><br><span class=\"line\">                <span class=\"attr\">&quot;height&quot;</span>: <span class=\"number\">0</span>,</span><br><span class=\"line\">                <span class=\"attr\">&quot;frameRate&quot;</span>: <span class=\"string\">&quot;&quot;</span>,</span><br><span class=\"line\">                <span class=\"attr\">&quot;sar&quot;</span>: <span class=\"string\">&quot;&quot;</span>,</span><br><span class=\"line\">                <span class=\"attr\">&quot;startWithSap&quot;</span>: <span class=\"number\">0</span>,</span><br><span class=\"line\">                <span class=\"attr\">&quot;SegmentBase&quot;</span>: &#123;</span><br><span class=\"line\">                    <span class=\"attr\">&quot;Initialization&quot;</span>: <span class=\"string\">&quot;0-907&quot;</span>,</span><br><span class=\"line\">                    <span class=\"attr\">&quot;indexRange&quot;</span>: <span class=\"string\">&quot;908-8055&quot;</span></span><br><span class=\"line\">                &#125;,</span><br><span class=\"line\">                <span class=\"attr\">&quot;codecid&quot;</span>: <span class=\"number\">0</span></span><br><span class=\"line\">            &#125;]</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>playurl 获取时各个参数的含义：</p>\n<ul>\n<li>avid，即视频 ID。cid，即该视频所对应的内容 ID。</li>\n<li>qn，视频质量代码。对应的是 JSON 格式中“accept_quality”这个 list 中的值。</li>\n<li>otype：数据的呈现形式。可以是 JSON 或 XML。</li>\n<li>type：用途不明。可能跟平台类型有关。</li>\n<li>fnver：用途不明。</li>\n<li>fnval：控制视频的格式。fnval 为 0 时是 FLV 格式，为 1 时是 MP4 格式，为 16 时是 DASH 序列。</li>\n</ul>\n<p>因此获取视频 ID 为 36570401（对应的内容 ID 为 74633794）的 1080P FLV 格式的播放地址（注意：不是直链，也不能直接播放，仅为小电视播放器能够解析的地址）并展示为 XML 格式的链接：</p>\n<figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">https://api.bilibili.com/x/player/playurl?avid=36570401&amp;cid=74633794&amp;qn=80&amp;otype=xml&amp;fnval=0</span><br></pre></td></tr></table></figure>\n\n<p>以上结束了针对 playurl 的讨论。至于如何构造参数使得 playurl 包含的视频链接可供下载和播放，因为没有更深层的探究，所以此处不继续讨论。但是视频直链中包含“ua=tvproj”字样，又结合 Bilibili 具有 DLNA 投屏功能，可进行初步猜想：“直链”的参数构造应仿照了 App DLNA 投屏时，App 发送给 DLNA 终端的视频链接所附带的参数。</p>\n<h2 id=\"利用 -Android-App- 下载高清视频\"><a href=\"# 利用 -Android-App- 下载高清视频\" class=\"headerlink\" title=\"利用 Android App 下载高清视频\"></a>利用 Android App 下载高清视频</h2><p>Bilibili App 内部本身拥有缓存功能，虽然并非对所有视频开放（比如：受到版权保护只能够在线观看的番剧），但是已开放缓存的视频可以利用“缓存”本身实现下载。  </p>\n<p>Bilibili 安卓客户端默认的视频缓存位置为：</p>\n<figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">/storage/emulated/0/Android/data/tv.danmaku.bili/download</span><br></pre></td></tr></table></figure>\n\n<p>该文件夹下包含着 App 缓存的所有视频文件。视频文件的存放位置为 [该视频的视频 ID]/[该视频的分 P 数]/lua.[视频格式].bili2api.[视频质量]/0.blv。例如，2019 拜年祭“珠”部分 1080P+ 缓存完成后的视频文件完整路径为：</p>\n<figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">/storage/emulated/0/Android/data/tv.danmaku.bili/download/36570401/1/lua.hdflv2.bili2api.112/0.blv</span><br></pre></td></tr></table></figure>\n\n<p>已缓存完成视频的扩展名为 blv（Bilibili Video），未缓存完成的视频的扩展名为 bdl（Bilibili Download）。将已经缓存完毕的 blv 文件复制到其他位置，并改扩展名为 flv（根据“视频格式”进行判断）即可正常播放。</p>\n<p><img src=\"/2019/02/13/009-bilibili-playlink-findings/image-20210411170400912.png\" alt=\"成功提取后的视频文件\"></p>\n<h2 id=\"获取弹幕数据\"><a href=\"# 获取弹幕数据\" class=\"headerlink\" title=\"获取弹幕数据\"></a>获取弹幕数据 </h2><p> 网页前端获取弹幕数据的链接为：</p>\n<figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">https://api.bilibili.com/x/v1/dm/list.so?oid=74633794</span><br></pre></td></tr></table></figure>\n\n<p>此处 oid 的值即为对应视频 cid 的值。当然你也可以从 App 的缓存中提取弹幕数据。接上例，视频缓存对应的弹幕数据缓存文件完整路径为：</p>\n<figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">/storage/emulated/0/Android/data/tv.danmaku.bili/download/36570401/1/danmaku.xml</span><br></pre></td></tr></table></figure>\n\n<p>另外，缓存文件夹内包含的其他文件作用列举如下：</p>\n<ul>\n<li><code>entry.json</code> 保存缓存视频的基本信息和统计数据。</li>\n<li><code>index.json</code> 保存缓存视频的下载地址。</li>\n<li><code>0.blv.4m.sum</code> 保存缓存视频的字节大小。</li>\n</ul>\n<p>由于互联网上已有多篇对 xml 弹幕数据进行综合处理的文章，所以在此处不再进一步讨论弹幕数据的处理相关内容。</p>\n<h2 id=\"加密直播间的密码校验 -API\"><a href=\"# 加密直播间的密码校验 -API\" class=\"headerlink\" title=\"加密直播间的密码校验 API\"></a>加密直播间的密码校验 API</h2><p>这里直接给出 Bilibili 用于校验直播间密码的接口：</p>\n<figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">https://api.live.bilibili.com/room/v1/Room/verify_room_pwd?room_id=roomid&amp;pwd=pwd</span><br></pre></td></tr></table></figure>\n\n<p>其中，<code>room_id</code> 参数为直播间的房间 ID，<code>pwd</code> 参数为直播间的密码。</p>\n<h2 id=\"参考链接\"><a href=\"# 参考链接\" class=\"headerlink\" title=\"参考链接\"></a>参考链接 </h2><p>[1] fython.&emsp;<a href=\"https://github.com/fython/BilibiliAPIDocs\">BilibiliAPIDocs [DB/OL]</a>&emsp;<em> 获取于 2019.2.14</em></p>\n","content_text":"图源：Bilibili 2019 拜年祭 视频截图 2019 年 2 月 4 日，一年一度的哔哩哔哩拜年祭如约而至。不得不说，今年的拜年祭在节目质量和形式上相较于前三年都有较大的提升。出于在电视上离线播放（即非网络电视，而是读取存储设备上的媒体文件）的需求，及家中的缓慢网速达不到 Bilibili 大会员 1080P+ 无卡顿播放的程度，我利用少量的空余时间对 Bilibili 高清视频的下载方式进行了简单实践，并在本文中进行简单总结。 ID熟悉 B 站的用户应该都会了解到，B 站上的视频、音频、专栏文章、用户都是以唯一的 ID 进行标识的。以“【星尘原创】尘降【PV 付 /COP】”这个视频为例：其视频地址为：https://www.bilibili.com/video/av4402328，该视频所对应的音频的地址为：https://www.bilibili.com/audio/au18065，上传该视频的 UP 主的个人主页地址为：https://space.bilibili.com/396194。由此我们可以获取到以下类型的唯一 ID： 视频 ID [Anime (Video) ID, aid/avid]：4402328 音频 ID [Audio ID, auid]：18065 用户 ID [User ID, uid]：396194 中包含的“av”、“au”、“cv”等均是为了区分 ID 的类型所用。在 Ajax 请求过程中各 ID 的值均为数字，不包含字符。 在上述例子中没有包括的、实际应用的 ID 类型还有（不完全）[1]： 文章 ID [Content Viewing ID, cvid] 内容 ID [Content ID, cid] 通知 ID [Notification ID, nfid] 会员 ID [Member ID, mid] 标签 ID [Tag ID, tid] 顺序 ID [Order ID, oid] 分类 ID [Type ID, typeid] 直播间 ID [Room ID, roomid] 剧集 ID [Episode ID, epid] 在下载视频的时候，起到主要作用的是 aid 和 cid 这两个唯一 ID。aid 和 cid 的区别是：aid 既可以指单个视频，也可以指含有多个视频的播放列表，而 cid 是视频级唯一的。 活动专题页面找 aidBilibili 为拜年祭活动设计了专门的活动页面。链接为： 1https://www.bilibili.com/blackboard/bnj2019.html 播放拜年祭视频的小电视播放器作为 HTML5 组件放置在活动页面内。使用开发者工具查看视频统计数据的 HTTP 请求，可以发现该播放器播放视频对应的 aid。比如默认情况下播放页面均会展示视频的总播放量、回复数、投币数等。如下图： 不难发现，获取这些统计信息所请求的链接地址（以拜年祭为例）是： 1https://api.bilibili.com/x/web-interface/archive/stat?aid=36570401 返回的 JSON 数据（格式化后）如下： 12345678910111213141516171819&#123; &quot;code&quot;: 0, &quot;message&quot;: &quot;0&quot;, &quot;ttl&quot;: 1, &quot;data&quot;: &#123; &quot;aid&quot;: 36570401, &quot;view&quot;: 34739455, &quot;danmaku&quot;: 1328696, &quot;reply&quot;: 195310, &quot;favorite&quot;: 1299858, &quot;coin&quot;: 1859584, &quot;share&quot;: 300501, &quot;like&quot;: 1465982, &quot;now_rank&quot;: 0, &quot;his_rank&quot;: 0, &quot;no_reprint&quot;: 0, &quot;copyright&quot;: 1 &#125;&#125; 上面链接和 JSON 数据中“aid”均为视频对应的视频 ID。注：该链接实际上也是获取视频统计数据的 API 接口。在此处不对此链接进行进一步说明。 由此我们得到了拜年祭视频的正常播放地址应为： 1http://www.bilibili.com/video/av36570401/ 下载 1080P 及以下清晰度视频的办法 最为简便的方法是，我们可以利用已有的视频下载网站进行下载。这里我们举两个例子。 唧唧下载站，分段法 唧唧视频下载站 也是一种下载视频的办法。它通过视频的热度高低来判断视频是否应预先解析和缓存在云端。较热门的视频可以直接从唧唧网站的服务器获取。较冷门的视频则可以通过客户端下载。客户端会尝试直接解析视频直连、修改 Referer 等进行分段下载然后合并。同时，该网站同时也拥有 MP3 转换服务，将视频中的音轨提取、转码后供用户下载。 ParseVideo，直链法ParseVideo 则不提供客户端和云端缓存。这个网站的作用是直接解析出对应视频、对应清晰度的完整视频的直链，获得的直链可以用下载工具直接下载。例如：2019 拜年祭中，第一部分“珠”的 1080P 清晰度完整视频直链如下： 1http://upos-hz-mirrorwcsu.acgvideo.com/upgcxcode/94/37/74633794/74633794-1-208.mp4?ua=tvproj&amp;deadline=1550125016&amp;gen=playurl&amp;nbs=1&amp;oi=2501663261&amp;os=wcsu&amp;trid=c01282c601bb4b0cb444a9b53342fc2e&amp;uipk=5&amp;upsig=556e65a3992c1531227fb43bcb6705a3 视频地址从哪来？视频地址（参数的作用其实绝大部分都是鉴权和防盗链）可以从 Bilibili 的视频播放页获得。在加载视频前，HTML5 播放器会首先加载一个包含当前清晰度的视频链接的文件，名为 playurl。获取播放地址的完整链接为（登录状态下的 1080P+ 链接，Session MD5 部分隐去）： 1https://api.bilibili.com/x/player/playurl?avid=36570401&amp;cid=74633794&amp;qn=112&amp;type=&amp;otype=json&amp;fnver=0&amp;fnval=16&amp;session=4710f|sec| 得到的 JSON 数据（格式化并去除转义字符后）类似这样（部分参数含有隐私信息，因此隐去，隐去部分用 |sec| 标识）： 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576&#123; &quot;code&quot;: 0, &quot;message&quot;: &quot;0&quot;, &quot;ttl&quot;: 1, &quot;data&quot;: &#123; &quot;from&quot;: &quot;local&quot;, &quot;result&quot;: &quot;suee&quot;, &quot;message&quot;: &quot;&quot;, &quot;quality&quot;: 112, &quot;format&quot;: &quot;hdflv2&quot;, &quot;timelength&quot;: 2961402, &quot;accept_format&quot;: &quot;hdflv2,flv,flv720,flv480,flv360&quot;, &quot;accept_description&quot;: [&quot; 高清 1080P+&quot;, &quot; 高清 1080P&quot;, &quot; 高清 720P&quot;, &quot; 清晰 480P&quot;, &quot; 流畅 360P&quot;], &quot;accept_quality&quot;: [112, 80, 64, 32, 16], &quot;video_codecid&quot;: 7, &quot;seek_param&quot;: &quot;start&quot;, &quot;seek_type&quot;: &quot;offset&quot;, &quot;dash&quot;: &#123; &quot;duration&quot;: 2961, &quot;minBufferTime&quot;: 1.5, &quot;video&quot;: [&#123; &quot;id&quot;: 112, &quot;baseUrl&quot;: &quot;http://upos-hz-mirrorks3u.acgvideo.com/upgcxcode/94/37/74633794/74633794-1-30112.m4s?e=ig8eux|sec|&amp;deadline=1550136700&amp;gen=playurl&amp;nbs=1&amp;oi=1885698042&amp;os=ks3u&amp;platform=pc&amp;trid=126ef7|sec|&amp;uipk=5&amp;upsig=c71526|sec|&quot;, &quot;backupUrl&quot;: null, &quot;bandwidth&quot;: 5826637, &quot;mimeType&quot;: &quot;video/mp4&quot;, &quot;codecs&quot;: &quot;avc1.640028&quot;, &quot;width&quot;: 1920, &quot;height&quot;: 1080, &quot;frameRate&quot;: &quot;16000/672&quot;, &quot;sar&quot;: &quot;1:1&quot;, &quot;startWithSap&quot;: 1, &quot;SegmentBase&quot;: &#123; &quot;Initialization&quot;: &quot;0-992&quot;, &quot;indexRange&quot;: &quot;993-8128&quot; &#125;, &quot;codecid&quot;: 7 &#125;], &quot;audio&quot;: [&#123; &quot;id&quot;: 30280, &quot;baseUrl&quot;: &quot;http://upos-hz-mirrorks3u.acgvideo.com/upgcxcode/94/37/74633794/74633794_nb1-1-30280.m4s?e=ig8eux|sec|&amp;deadline=1550136700&amp;gen=playurl&amp;nbs=1&amp;oi=1885698042&amp;os=ks3u&amp;platform=pc&amp;trid=126ef7|sec|&amp;uipk=5&amp;upsig=5f58ae|sec|&quot;, &quot;backupUrl&quot;: null, &quot;bandwidth&quot;: 321706, &quot;mimeType&quot;: &quot;audio/mp4&quot;, &quot;codecs&quot;: &quot;mp4a.40.2&quot;, &quot;width&quot;: 0, &quot;height&quot;: 0, &quot;frameRate&quot;: &quot;&quot;, &quot;sar&quot;: &quot;&quot;, &quot;startWithSap&quot;: 0, &quot;SegmentBase&quot;: &#123; &quot;Initialization&quot;: &quot;0-907&quot;, &quot;indexRange&quot;: &quot;908-8055&quot; &#125;, &quot;codecid&quot;: 0 &#125;, &#123; &quot;id&quot;: 30216, &quot;baseUrl&quot;: &quot;http://upos-hz-mirrorcos.acgvideo.com/upgcxcode/94/37/74633794/74633794-1-30216.m4s?um_deadline=1550136700&amp;platform=pc&amp;rate=0&amp;oi=1885698042&amp;um_sign=df1a58|sec|&amp;gen=playurl&amp;os=cos&amp;trid=126ef7|sec|&quot;, &quot;backupUrl&quot;: null, &quot;bandwidth&quot;: 67238, &quot;mimeType&quot;: &quot;audio/mp4&quot;, &quot;codecs&quot;: &quot;mp4a.40.2&quot;, &quot;width&quot;: 0, &quot;height&quot;: 0, &quot;frameRate&quot;: &quot;&quot;, &quot;sar&quot;: &quot;&quot;, &quot;startWithSap&quot;: 0, &quot;SegmentBase&quot;: &#123; &quot;Initialization&quot;: &quot;0-907&quot;, &quot;indexRange&quot;: &quot;908-8055&quot; &#125;, &quot;codecid&quot;: 0 &#125;] &#125; &#125;&#125; playurl 获取时各个参数的含义： avid，即视频 ID。cid，即该视频所对应的内容 ID。 qn，视频质量代码。对应的是 JSON 格式中“accept_quality”这个 list 中的值。 otype：数据的呈现形式。可以是 JSON 或 XML。 type：用途不明。可能跟平台类型有关。 fnver：用途不明。 fnval：控制视频的格式。fnval 为 0 时是 FLV 格式，为 1 时是 MP4 格式，为 16 时是 DASH 序列。 因此获取视频 ID 为 36570401（对应的内容 ID 为 74633794）的 1080P FLV 格式的播放地址（注意：不是直链，也不能直接播放，仅为小电视播放器能够解析的地址）并展示为 XML 格式的链接： 1https://api.bilibili.com/x/player/playurl?avid=36570401&amp;cid=74633794&amp;qn=80&amp;otype=xml&amp;fnval=0 以上结束了针对 playurl 的讨论。至于如何构造参数使得 playurl 包含的视频链接可供下载和播放，因为没有更深层的探究，所以此处不继续讨论。但是视频直链中包含“ua=tvproj”字样，又结合 Bilibili 具有 DLNA 投屏功能，可进行初步猜想：“直链”的参数构造应仿照了 App DLNA 投屏时，App 发送给 DLNA 终端的视频链接所附带的参数。 利用 Android App 下载高清视频Bilibili App 内部本身拥有缓存功能，虽然并非对所有视频开放（比如：受到版权保护只能够在线观看的番剧），但是已开放缓存的视频可以利用“缓存”本身实现下载。 Bilibili 安卓客户端默认的视频缓存位置为： 1/storage/emulated/0/Android/data/tv.danmaku.bili/download 该文件夹下包含着 App 缓存的所有视频文件。视频文件的存放位置为 [该视频的视频 ID]/[该视频的分 P 数]/lua.[视频格式].bili2api.[视频质量]/0.blv。例如，2019 拜年祭“珠”部分 1080P+ 缓存完成后的视频文件完整路径为： 1/storage/emulated/0/Android/data/tv.danmaku.bili/download/36570401/1/lua.hdflv2.bili2api.112/0.blv 已缓存完成视频的扩展名为 blv（Bilibili Video），未缓存完成的视频的扩展名为 bdl（Bilibili Download）。将已经缓存完毕的 blv 文件复制到其他位置，并改扩展名为 flv（根据“视频格式”进行判断）即可正常播放。 获取弹幕数据 网页前端获取弹幕数据的链接为： 1https://api.bilibili.com/x/v1/dm/list.so?oid=74633794 此处 oid 的值即为对应视频 cid 的值。当然你也可以从 App 的缓存中提取弹幕数据。接上例，视频缓存对应的弹幕数据缓存文件完整路径为： 1/storage/emulated/0/Android/data/tv.danmaku.bili/download/36570401/1/danmaku.xml 另外，缓存文件夹内包含的其他文件作用列举如下： entry.json 保存缓存视频的基本信息和统计数据。 index.json 保存缓存视频的下载地址。 0.blv.4m.sum 保存缓存视频的字节大小。 由于互联网上已有多篇对 xml 弹幕数据进行综合处理的文章，所以在此处不再进一步讨论弹幕数据的处理相关内容。 加密直播间的密码校验 API这里直接给出 Bilibili 用于校验直播间密码的接口： 1https://api.live.bilibili.com/room/v1/Room/verify_room_pwd?room_id=roomid&amp;pwd=pwd 其中，room_id 参数为直播间的房间 ID，pwd 参数为直播间的密码。 参考链接 [1] fython.&emsp;BilibiliAPIDocs [DB/OL]&emsp; 获取于 2019.2.14","summary":"图源：Bilibili 2019 拜年祭 视频截图 2019年2月4日，一年一度的哔哩哔哩拜年祭如约而至。不得不说，今年的拜年祭在节目质量和形式上相较于前三年都有较大的提升。出于在电视上离线播放（即非网络电视，而是读取存储设备上的媒体文件）的需求，及家中的缓慢网速达不到 Bilibili 大会员 1080P+ 无卡顿播放的程度，我利用少量的空余时间对 Bilibili 高清视频的下载方式进行了简单实践，并在本文中进行简单总结。 ID熟悉B站的用户应该都会了解到，B 站上的视频、音频、专栏文章、用户都是以唯一的 ID 进行标识的。以“【星尘原创】尘降【PV付/COP】”这个视频为例：其视频地址为：https://www.bilibili.com/video/av4402328，该视频所对应的音频的地址为：https://www.bilibili.com/audio/au18065，上传该视频的UP主的个人主页地址为：https://space.bilibili.com/396194。由此我们可以获取到以下类型的唯一 ID： 视频 ID [Anime (Video) ID, aid/avid]：4402328 音频 ID [Audio ID, auid]：18065 用户 ID [User ID, uid]：396194 中包含的“av”、“au”、“cv”等均是为了区分 ID 的类型所用。在 Ajax 请求过程中各 ID 的值均为数字，不包含字符。","date_published":"2019-02-13T07:31:00.000Z","tags":["自由探索","完成编写","小tricks"]}]}